(function(){"use strict";function pa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function fa(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function i(){var n=!1;try{n=this instanceof i}catch{}return n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}var tt={};function Cn(t,e){if(t==null)return{};var r,i,n=function(a,l){if(a==null)return{};var d={};for(var h in a)if({}.hasOwnProperty.call(a,h)){if(l.indexOf(h)!==-1)continue;d[h]=a[h]}return d}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J(t){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(t)}function Tn(t){var e=function(r,i){if(J(r)!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var s=n.call(r,i);if(J(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}(t,"string");return J(e)=="symbol"?e:e+""}function An(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Tn(i.key),i)}}function ce(t,e,r){return e&&An(t.prototype,e),r&&An(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pt(t,e){if(e&&(J(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(t)}function ge(t){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ge(t)}function ht(t,e){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ht(t,e)}function It(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ht(t,e)}function _e(t,e,r){return(e=Tn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function On(t,e,r,i,n,s,a){try{var l=t[s](a),d=l.value}catch(h){return void r(h)}l.done?e(d):Promise.resolve(d).then(i,n)}function R(t){return function(){var e=this,r=arguments;return new Promise(function(i,n){var s=t.apply(e,r);function a(d){On(s,i,n,a,l,"next",d)}function l(d){On(s,i,n,a,l,"throw",d)}a(void 0)})}}function Mn(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function re(t,e){return function(r){if(Array.isArray(r))return r}(t)||function(r,i){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var s,a,l,d,h=[],f=!0,g=!1;try{if(l=(n=n.call(r)).next,i===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(s=l.call(n)).done)&&(h.push(s.value),h.length!==i);f=!0);}catch(w){g=!0,a=w}finally{try{if(!f&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(g)throw a}}return h}}(t,e)||function(r,i){if(r){if(typeof r=="string")return Mn(r,i);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mn(r,i):void 0}}(t,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ma(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pn,Lt={exports:{}},fr=function(){if(Pn)return Lt.exports;Pn=1;var t,e=typeof Reflect=="object"?Reflect:null,r=e&&typeof e.apply=="function"?e.apply:function(v,E,S){return Function.prototype.apply.call(v,E,S)};t=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:function(v){return Object.getOwnPropertyNames(v)};var i=Number.isNaN||function(v){return v!=v};function n(){n.init.call(this)}Lt.exports=n,Lt.exports.once=function(v,E){return new Promise(function(S,O){function I(b){v.removeListener(E,y),O(b)}function y(){typeof v.removeListener=="function"&&v.removeListener("error",I),S([].slice.call(arguments))}_(v,E,y,{once:!0}),E!=="error"&&function(b,A,L){typeof b.on=="function"&&_(b,"error",A,L)}(v,I,{once:!0})})},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var s=10;function a(v){if(typeof v!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof v)}function l(v){return v._maxListeners===void 0?n.defaultMaxListeners:v._maxListeners}function d(v,E,S,O){var I,y,b,A;if(a(S),(y=v._events)===void 0?(y=v._events=Object.create(null),v._eventsCount=0):(y.newListener!==void 0&&(v.emit("newListener",E,S.listener?S.listener:S),y=v._events),b=y[E]),b===void 0)b=y[E]=S,++v._eventsCount;else if(typeof b=="function"?b=y[E]=O?[S,b]:[b,S]:O?b.unshift(S):b.push(S),(I=l(v))>0&&b.length>I&&!b.warned){b.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=v,L.type=E,L.count=b.length,A=L,console&&console.warn&&console.warn(A)}return v}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(v,E,S){var O={fired:!1,wrapFn:void 0,target:v,type:E,listener:S},I=h.bind(O);return I.listener=S,O.wrapFn=I,I}function g(v,E,S){var O=v._events;if(O===void 0)return[];var I=O[E];return I===void 0?[]:typeof I=="function"?S?[I.listener||I]:[I]:S?function(y){for(var b=new Array(y.length),A=0;A<b.length;++A)b[A]=y[A].listener||y[A];return b}(I):C(I,I.length)}function w(v){var E=this._events;if(E!==void 0){var S=E[v];if(typeof S=="function")return 1;if(S!==void 0)return S.length}return 0}function C(v,E){for(var S=new Array(E),O=0;O<E;++O)S[O]=v[O];return S}function _(v,E,S,O){if(typeof v.on=="function")O.once?v.once(E,S):v.on(E,S);else{if(typeof v.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof v);v.addEventListener(E,function I(y){O.once&&v.removeEventListener(E,I),S(y)})}}return Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(v){if(typeof v!="number"||v<0||i(v))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+v+".");s=v}}),n.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||i(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this},n.prototype.getMaxListeners=function(){return l(this)},n.prototype.emit=function(v){for(var E=[],S=1;S<arguments.length;S++)E.push(arguments[S]);var O=v==="error",I=this._events;if(I!==void 0)O=O&&I.error===void 0;else if(!O)return!1;if(O){var y;if(E.length>0&&(y=E[0]),y instanceof Error)throw y;var b=new Error("Unhandled error."+(y?" ("+y.message+")":""));throw b.context=y,b}var A=I[v];if(A===void 0)return!1;if(typeof A=="function")r(A,this,E);else{var L=A.length,x=C(A,L);for(S=0;S<L;++S)r(x[S],this,E)}return!0},n.prototype.addListener=function(v,E){return d(this,v,E,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(v,E){return d(this,v,E,!0)},n.prototype.once=function(v,E){return a(E),this.on(v,f(this,v,E)),this},n.prototype.prependOnceListener=function(v,E){return a(E),this.prependListener(v,f(this,v,E)),this},n.prototype.removeListener=function(v,E){var S,O,I,y,b;if(a(E),(O=this._events)===void 0)return this;if((S=O[v])===void 0)return this;if(S===E||S.listener===E)--this._eventsCount==0?this._events=Object.create(null):(delete O[v],O.removeListener&&this.emit("removeListener",v,S.listener||E));else if(typeof S!="function"){for(I=-1,y=S.length-1;y>=0;y--)if(S[y]===E||S[y].listener===E){b=S[y].listener,I=y;break}if(I<0)return this;I===0?S.shift():function(A,L){for(;L+1<A.length;L++)A[L]=A[L+1];A.pop()}(S,I),S.length===1&&(O[v]=S[0]),O.removeListener!==void 0&&this.emit("removeListener",v,b||E)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(v){var E,S,O;if((S=this._events)===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[v]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete S[v]),this;if(arguments.length===0){var I,y=Object.keys(S);for(O=0;O<y.length;++O)(I=y[O])!=="removeListener"&&this.removeAllListeners(I);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(E=S[v])=="function")this.removeListener(v,E);else if(E!==void 0)for(O=E.length-1;O>=0;O--)this.removeListener(v,E[O]);return this},n.prototype.listeners=function(v){return g(this,v,!0)},n.prototype.rawListeners=function(v){return g(this,v,!1)},n.listenerCount=function(v,E){return typeof v.listenerCount=="function"?v.listenerCount(E):w.call(v,E)},n.prototype.listenerCount=w,n.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]},Lt.exports}(),jt=ma(fr),In=Object.prototype.hasOwnProperty;function Ln(t,e,r){for(r of t.keys())if(ie(r,e))return r}function ie(t,e){var r,i,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((i=t.length)===e.length)for(;i--&&ie(t[i],e[i]););return i===-1}if(r===Set){if(t.size!==e.size)return!1;for(i of t)if((n=i)&&typeof n=="object"&&!(n=Ln(e,n))||!e.has(n))return!1;return!0}if(r===Map){if(t.size!==e.size)return!1;for(i of t)if((n=i[0])&&typeof n=="object"&&!(n=Ln(e,n))||!ie(i[1],e.get(n)))return!1;return!0}if(r===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(r===DataView){if((i=t.byteLength)===e.byteLength)for(;i--&&t.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(t)){if((i=t.byteLength)===e.byteLength)for(;i--&&t[i]===e[i];);return i===-1}if(!r||typeof t=="object"){for(r in i=0,t)if(In.call(t,r)&&++i&&!In.call(e,r)||!(r in e)||!ie(t[r],e[r]))return!1;return Object.keys(e).length===i}}return t!=t&&e!=e}const ga={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},jn={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},Q={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},se={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Le={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class T{static getFirstMatch(e,r){const i=r.match(e);return i&&i.length>0&&i[1]||""}static getSecondMatch(e,r){const i=r.match(e);return i&&i.length>1&&i[2]||""}static matchAndReturnConst(e,r,i){if(e.test(r))return i}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const r=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const r=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5))return r[0]===1&&r[1]<6?"Cupcake":r[0]===1&&r[1]>=6?"Donut":r[0]===2&&r[1]<2?"Eclair":r[0]===2&&r[1]===2?"Froyo":r[0]===2&&r[1]>2?"Gingerbread":r[0]===3?"Honeycomb":r[0]===4&&r[1]<1?"Ice Cream Sandwich":r[0]===4&&r[1]<4?"Jelly Bean":r[0]===4&&r[1]>=4?"KitKat":r[0]===5?"Lollipop":r[0]===6?"Marshmallow":r[0]===7?"Nougat":r[0]===8?"Oreo":r[0]===9?"Pie":void 0}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,r,i=!1){const n=T.getVersionPrecision(e),s=T.getVersionPrecision(r);let a=Math.max(n,s),l=0;const d=T.map([e,r],h=>{const f=a-T.getVersionPrecision(h),g=h+new Array(f+1).join(".0");return T.map(g.split("."),w=>new Array(20-w.length).join("0")+w).reverse()});for(i&&(l=a-Math.min(n,s)),a-=1;a>=l;){if(d[0][a]>d[1][a])return 1;if(d[0][a]===d[1][a]){if(a===l)return 0;a-=1}else if(d[0][a]<d[1][a])return-1}}static map(e,r){const i=[];let n;if(Array.prototype.map)return Array.prototype.map.call(e,r);for(n=0;n<e.length;n+=1)i.push(r(e[n]));return i}static find(e,r){let i,n;if(Array.prototype.find)return Array.prototype.find.call(e,r);for(i=0,n=e.length;i<n;i+=1){const s=e[i];if(r(s,i))return s}}static assign(e,...r){const i=e;let n,s;if(Object.assign)return Object.assign(e,...r);for(n=0,s=r.length;n<s;n+=1){const a=r[n];typeof a=="object"&&a!==null&&Object.keys(a).forEach(l=>{i[l]=a[l]})}return e}static getBrowserAlias(e){return ga[e]}static getBrowserTypeByAlias(e){return jn[e]||""}}const W=/version\/(\d+(\.?_?\d+)+)/i,va=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},r=T.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},r=T.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},r=T.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},r=T.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},r=T.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},r=T.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},r=T.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},r=T.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=T.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},r=T.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},r=T.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},r=T.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},r=T.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},r=T.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},r=T.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},r=T.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},r=T.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},r=T.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},r=T.getFirstMatch(W,t)||T.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},r=T.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},r=T.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},r=T.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},r=T.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},r=T.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},r=T.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},r=T.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},r=T.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},r=T.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e={name:"Android Browser"},r=T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},r=T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},r=T.getFirstMatch(W,t);return r&&(e.version=r),e}},{test:[/.*/i],describe(t){const e=t.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:T.getFirstMatch(e,t),version:T.getSecondMatch(e,t)}}}];var ya=[{test:[/Roku\/DVP/],describe(t){const e=T.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:se.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=T.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:se.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=T.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=T.getWindowsVersionName(e);return{name:se.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:se.iOS},r=T.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe(t){const e=T.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=T.getMacOSVersionName(e),i={name:se.MacOS,version:e};return r&&(i.versionName=r),i}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=T.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:se.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e=T.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=T.getAndroidVersionName(e),i={name:se.Android,version:e};return r&&(i.versionName=r),i}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=T.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:se.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=T.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||T.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||T.getFirstMatch(/\bbb(\d+)/i,t);return{name:se.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=T.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:se.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=T.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:se.Tizen,version:e}}},{test:[/linux/i],describe:()=>({name:se.Linux})},{test:[/CrOS/],describe:()=>({name:se.ChromeOS})},{test:[/PlayStation 4/],describe(t){const e=T.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:se.PlayStation4,version:e}}}],ba=[{test:[/googlebot/i],describe:()=>({type:"bot",vendor:"Google"})},{test:[/huawei/i],describe(t){const e=T.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:Q.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:()=>({type:Q.tablet,vendor:"Nexus"})},{test:[/ipad/i],describe:()=>({type:Q.tablet,vendor:"Apple",model:"iPad"})},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:()=>({type:Q.tablet,vendor:"Apple",model:"iPad"})},{test:[/kftt build/i],describe:()=>({type:Q.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"})},{test:[/silk/i],describe:()=>({type:Q.tablet,vendor:"Amazon"})},{test:[/tablet(?! pc)/i],describe:()=>({type:Q.tablet})},{test(t){const e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe(t){const e=T.getFirstMatch(/(ipod|iphone)/i,t);return{type:Q.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:()=>({type:Q.mobile,vendor:"Nexus"})},{test:[/[^-]mobi/i],describe:()=>({type:Q.mobile})},{test:t=>t.getBrowserName(!0)==="blackberry",describe:()=>({type:Q.mobile,vendor:"BlackBerry"})},{test:t=>t.getBrowserName(!0)==="bada",describe:()=>({type:Q.mobile})},{test:t=>t.getBrowserName()==="windows phone",describe:()=>({type:Q.mobile,vendor:"Microsoft"})},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe:()=>({type:Q.tablet})},{test:t=>t.getOSName(!0)==="android",describe:()=>({type:Q.mobile})},{test:t=>t.getOSName(!0)==="macos",describe:()=>({type:Q.desktop,vendor:"Apple"})},{test:t=>t.getOSName(!0)==="windows",describe:()=>({type:Q.desktop})},{test:t=>t.getOSName(!0)==="linux",describe:()=>({type:Q.desktop})},{test:t=>t.getOSName(!0)==="playstation 4",describe:()=>({type:Q.tv})},{test:t=>t.getOSName(!0)==="roku",describe:()=>({type:Q.tv})}],_a=[{test:t=>t.getBrowserName(!0)==="microsoft edge",describe(t){if(/\sedg\//i.test(t))return{name:Le.Blink};const e=T.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Le.EdgeHTML,version:e}}},{test:[/trident/i],describe(t){const e={name:Le.Trident},r=T.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:t=>t.test(/presto/i),describe(t){const e={name:Le.Presto},r=T.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe(t){const e={name:Le.Gecko},r=T.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe:()=>({name:Le.Blink})},{test:[/(apple)?webkit/i],describe(t){const e={name:Le.WebKit},r=T.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];class Dn{constructor(e,r=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=T.find(va,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=T.find(ya,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:r}=this.getOS();return e?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:r}=this.getPlatform();return e?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const e=T.find(ba,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=T.find(_a,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return T.assign({},this.parsedResult)}satisfies(e){const r={};let i=0;const n={};let s=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(n[a]=l,s+=1):typeof l=="object"&&(r[a]=l,i+=1)}),i>0){const a=Object.keys(r),l=T.find(a,h=>this.isOS(h));if(l){const h=this.satisfies(r[l]);if(h!==void 0)return h}const d=T.find(a,h=>this.isPlatform(h));if(d){const h=this.satisfies(r[d]);if(h!==void 0)return h}}if(s>0){const a=Object.keys(n),l=T.find(a,d=>this.isBrowser(d,!0));if(l!==void 0)return this.compareVersion(n[l])}}isBrowser(e,r=!1){const i=this.getBrowserName().toLowerCase();let n=e.toLowerCase();const s=T.getBrowserTypeByAlias(n);return r&&s&&(n=s.toLowerCase()),n===i}compareVersion(e){let r=[0],i=e,n=!1;const s=this.getBrowserVersion();if(typeof s=="string")return e[0]===">"||e[0]==="<"?(i=e.substr(1),e[1]==="="?(n=!0,i=e.substr(2)):r=[],e[0]===">"?r.push(1):r.push(-1)):e[0]==="="?i=e.substr(1):e[0]==="~"&&(n=!0,i=e.substr(1)),r.indexOf(T.compareVersions(s,i,n))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,r=!1){return this.isBrowser(e,r)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(r=>this.is(r))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class wa{static getParser(e,r=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new Dn(e,r)}static parse(e){return new Dn(e).getResult()}static get BROWSER_MAP(){return jn}static get ENGINE_MAP(){return Le}static get OS_MAP(){return se}static get PLATFORMS_MAP(){return Q}}function Dt(){return Date.now()+Math.random().toString()}function pt(){throw new Error("Method must be implemented in subclass")}function xn(t,e){return e!=null&&e.proxyUrl?e.proxyUrl+(e.proxyUrl.slice(-1)==="/"?"":"/")+t.substring(8):t}function xt(t){return t!=null&&t.callObjectBundleUrlOverride?t.callObjectBundleUrlOverride:xn("https://c.daily.co/call-machine/versioned/".concat("0.80.0","/static/call-machine-object-bundle.js"),t)}function Nt(t){try{new URL(t)}catch{return!1}return!0}const H=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ve="8.55.0",G=globalThis;function Rt(t,e,r){const i=G,n=i.__SENTRY__=i.__SENTRY__||{},s=n[Ve]=n[Ve]||{};return s[t]||(s[t]=e())}const ze=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,mr=["debug","info","warn","error","log","assert","trace"],Ft={};function ft(t){if(!("console"in G))return t();const e=G.console,r={},i=Object.keys(Ft);i.forEach(n=>{const s=Ft[n];r[n]=e[n],e[n]=s});try{return t()}finally{i.forEach(n=>{e[n]=r[n]})}}const V=Rt("logger",function(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return ze?mr.forEach(r=>{e[r]=(...i)=>{t&&ft(()=>{G.console[r](`Sentry Logger [${r}]:`,...i)})}}):mr.forEach(r=>{e[r]=()=>{}}),e}),qe="?",Nn=/\(error: (.*)\)/,Rn=/captureMessage|captureException/;function Vt(t){return t[t.length-1]||{}}const Fn="<anonymous>";function je(t){try{return t&&typeof t=="function"&&t.name||Fn}catch{return Fn}}function Vn(t){const e=t.exception;if(e){const r=[];try{return e.values.forEach(i=>{i.stacktrace.frames&&r.push(...i.stacktrace.frames)}),r}catch{return}}}const zt={},zn={};function Ue(t,e){zt[t]=zt[t]||[],zt[t].push(e)}function Be(t,e){if(!zn[t]){zn[t]=!0;try{e()}catch(r){ze&&V.error(`Error while instrumenting ${t}`,r)}}}function ve(t,e){const r=t&&zt[t];if(r)for(const i of r)try{i(e)}catch(n){ze&&V.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${je(i)}
Error:`,n)}}let gr=null;function Sa(){gr=G.onerror,G.onerror=function(t,e,r,i,n){return ve("error",{column:i,error:n,line:r,msg:t,url:e}),!!gr&&gr.apply(this,arguments)},G.onerror.__SENTRY_INSTRUMENTED__=!0}let vr=null;function Ea(){vr=G.onunhandledrejection,G.onunhandledrejection=function(t){return ve("unhandledrejection",t),!vr||vr.apply(this,arguments)},G.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function qt(){return yr(G),G}function yr(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Ve,e[Ve]=e[Ve]||{}}const qn=Object.prototype.toString;function br(t){switch(qn.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return $e(t,Error)}}function rt(t,e){return qn.call(t)===`[object ${e}]`}function Un(t){return rt(t,"ErrorEvent")}function Bn(t){return rt(t,"DOMError")}function ke(t){return rt(t,"String")}function _r(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function wr(t){return t===null||_r(t)||typeof t!="object"&&typeof t!="function"}function nt(t){return rt(t,"Object")}function Ut(t){return typeof Event<"u"&&$e(t,Event)}function Bt(t){return!!(t&&t.then&&typeof t.then=="function")}function $e(t,e){try{return t instanceof e}catch{return!1}}function $n(t){return!(typeof t!="object"||t===null||!t.__isVue&&!t._isVue)}const Sr=G;function Jn(t,e={}){if(!t)return"<unknown>";try{let r=t;const i=5,n=[];let s=0,a=0;const l=" > ",d=l.length;let h;const f=Array.isArray(e)?e:e.keyAttrs,g=!Array.isArray(e)&&e.maxStringLength||80;for(;r&&s++<i&&(h=ka(r,f),!(h==="html"||s>1&&a+n.length*d+h.length>=g));)n.push(h),a+=h.length,r=r.parentNode;return n.reverse().join(l)}catch{return"<unknown>"}}function ka(t,e){const r=t,i=[];if(!r||!r.tagName)return"";if(Sr.HTMLElement&&r instanceof HTMLElement&&r.dataset){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}i.push(r.tagName.toLowerCase());const n=e&&e.length?e.filter(a=>r.getAttribute(a)).map(a=>[a,r.getAttribute(a)]):null;if(n&&n.length)n.forEach(a=>{i.push(`[${a[0]}="${a[1]}"]`)});else{r.id&&i.push(`#${r.id}`);const a=r.className;if(a&&ke(a)){const l=a.split(/\s+/);for(const d of l)i.push(`.${d}`)}}const s=["aria-label","type","name","title","alt"];for(const a of s){const l=r.getAttribute(a);l&&i.push(`[${a}="${l}"]`)}return i.join("")}function it(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Gn(t,e){if(!Array.isArray(t))return"";const r=[];for(let i=0;i<t.length;i++){const n=t[i];try{$n(n)?r.push("[VueViewModel]"):r.push(String(n))}catch{r.push("[value cannot be serialized]")}}return r.join(e)}function Ca(t,e,r=!1){return!!ke(t)&&(rt(e,"RegExp")?e.test(t):!!ke(e)&&(r?t===e:t.includes(e)))}function $t(t,e=[],r=!1){return e.some(i=>Ca(t,i,r))}function le(t,e,r){if(!(e in t))return;const i=t[e],n=r(i);typeof n=="function"&&Wn(n,i);try{t[e]=n}catch{ze&&V.log(`Failed to replace method "${e}" in object`,t)}}function Je(t,e,r){try{Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0})}catch{ze&&V.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function Wn(t,e){try{const r=e.prototype||{};t.prototype=e.prototype=r,Je(t,"__sentry_original__",e)}catch{}}function Er(t){return t.__sentry_original__}function Yn(t){if(br(t))return{message:t.message,name:t.name,stack:t.stack,...Qn(t)};if(Ut(t)){const e={type:t.type,target:Hn(t.target),currentTarget:Hn(t.currentTarget),...Qn(t)};return typeof CustomEvent<"u"&&$e(t,CustomEvent)&&(e.detail=t.detail),e}return t}function Hn(t){try{return e=t,typeof Element<"u"&&$e(e,Element)?Jn(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}var e}function Qn(t){if(typeof t=="object"&&t!==null){const e={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}return{}}function de(t){return kr(t,new Map)}function kr(t,e){if(function(r){if(!nt(r))return!1;try{const i=Object.getPrototypeOf(r).constructor.name;return!i||i==="Object"}catch{return!0}}(t)){const r=e.get(t);if(r!==void 0)return r;const i={};e.set(t,i);for(const n of Object.getOwnPropertyNames(t))t[n]!==void 0&&(i[n]=kr(t[n],e));return i}if(Array.isArray(t)){const r=e.get(t);if(r!==void 0)return r;const i=[];return e.set(t,i),t.forEach(n=>{i.push(kr(n,e))}),i}return t}function mt(){return Date.now()/1e3}const Ce=function(){const{performance:t}=G;if(!t||!t.now)return mt;const e=Date.now()-t.now(),r=t.timeOrigin==null?e:t.timeOrigin;return()=>(r+t.now())/1e3}();function he(){const t=G,e=t.crypto||t.msCrypto;let r=()=>16*Math.random();try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(r=()=>{const i=new Uint8Array(1);return e.getRandomValues(i),i[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,i=>(i^(15&r())>>i/4).toString(16))}function Kn(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function De(t){const{message:e,event_id:r}=t;if(e)return e;const i=Kn(t);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||r||"<unknown>":r||"<unknown>"}function Cr(t,e,r){const i=t.exception=t.exception||{},n=i.values=i.values||[],s=n[0]=n[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function st(t,e){const r=Kn(t);if(!r)return;const i=r.mechanism;if(r.mechanism={type:"generic",handled:!0,...i,...e},e&&"data"in e){const n={...i&&i.data,...e.data};r.mechanism.data=n}}function Xn(t){if(function(e){try{return e.__sentry_captured__}catch{}}(t))return!0;try{Je(t,"__sentry_captured__",!0)}catch{}return!1}var Te;function Ge(t){return new pe(e=>{e(t)})}function Jt(t){return new pe((e,r)=>{r(t)})}(()=>{const{performance:t}=G;!t||!t.now||(t.now(),t.timing&&t.timing.navigationStart)})(),function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(Te||(Te={}));class pe{constructor(e){pe.prototype.__init.call(this),pe.prototype.__init2.call(this),pe.prototype.__init3.call(this),pe.prototype.__init4.call(this),this._state=Te.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(r){this._reject(r)}}then(e,r){return new pe((i,n)=>{this._handlers.push([!1,s=>{if(e)try{i(e(s))}catch(a){n(a)}else i(s)},s=>{if(r)try{i(r(s))}catch(a){n(a)}else n(s)}]),this._executeHandlers()})}catch(e){return this.then(r=>r,e)}finally(e){return new pe((r,i)=>{let n,s;return this.then(a=>{s=!1,n=a,e&&e()},a=>{s=!0,n=a,e&&e()}).then(()=>{s?i(n):r(n)})})}__init(){this._resolve=e=>{this._setResult(Te.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Te.REJECTED,e)}}__init3(){this._setResult=(e,r)=>{this._state===Te.PENDING&&(Bt(r)?r.then(this._resolve,this._reject):(this._state=e,this._value=r,this._executeHandlers()))}}__init4(){this._executeHandlers=()=>{if(this._state===Te.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(r=>{r[0]||(this._state===Te.RESOLVED&&r[1](this._value),this._state===Te.REJECTED&&r[2](this._value),r[0]=!0)})}}}function Ta(t){const e=Ce(),r={sid:he(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(i){return de({sid:`${i.sid}`,init:i.init,started:new Date(1e3*i.started).toISOString(),timestamp:new Date(1e3*i.timestamp).toISOString(),status:i.status,errors:i.errors,did:typeof i.did=="number"||typeof i.did=="string"?`${i.did}`:void 0,duration:i.duration,abnormal_mechanism:i.abnormal_mechanism,attrs:{release:i.release,environment:i.environment,ip_address:i.ipAddress,user_agent:i.userAgent}})}(r)};return t&&ot(r,t),r}function ot(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),t.did||e.did||(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Ce(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:he()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const r=t.timestamp-t.started;t.duration=r>=0?r:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Zn(){return he()}function Tr(){return he().substring(16)}function Gt(t,e,r=2){if(!e||typeof e!="object"||r<=0)return e;if(t&&e&&Object.keys(e).length===0)return t;const i={...t};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=Gt(i[n],e[n],r-1));return i}const Ar="_sentrySpan";function ei(t,e){e?Je(t,Ar,e):delete t[Ar]}function ti(t){return t[Ar]}class Or{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Zn(),spanId:Tr()}}clone(){const e=new Or;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,ei(e,ti(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ot(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,r){return this._tags={...this._tags,[e]:r},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,r){return this._extra={...this._extra,[e]:r},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,r){return r===null?delete this._contexts[e]:this._contexts[e]=r,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const r=typeof e=="function"?e(this):e,[i,n]=r instanceof xe?[r.getScopeData(),r.getRequestSession()]:nt(r)?[e,e.requestSession]:[],{tags:s,extra:a,user:l,contexts:d,level:h,fingerprint:f=[],propagationContext:g}=i||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...a},this._contexts={...this._contexts,...d},l&&Object.keys(l).length&&(this._user=l),h&&(this._level=h),f.length&&(this._fingerprint=f),g&&(this._propagationContext=g),n&&(this._requestSession=n),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,ei(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Zn()}),this._notifyScopeListeners(),this}addBreadcrumb(e,r){const i=typeof r=="number"?r:100;if(i<=0)return this;const n={timestamp:mt(),...e};return this._breadcrumbs.push(n),this._breadcrumbs.length>i&&(this._breadcrumbs=this._breadcrumbs.slice(-i),this._client&&this._client.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:ti(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Gt(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:Tr(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,r){const i=r&&r.event_id?r.event_id:he();if(!this._client)return V.warn("No client configured on scope - will not capture exception!"),i;const n=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:n,...r,event_id:i},this),i}captureMessage(e,r,i){const n=i&&i.event_id?i.event_id:he();if(!this._client)return V.warn("No client configured on scope - will not capture message!"),n;const s=new Error(e);return this._client.captureMessage(e,r,{originalException:e,syntheticException:s,...i,event_id:n},this),n}captureEvent(e,r){const i=r&&r.event_id?r.event_id:he();return this._client?(this._client.captureEvent(e,{...r,event_id:i},this),i):(V.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const xe=Or;class Aa{constructor(e,r){let i,n;i=e||new xe,n=r||new xe,this._stack=[{scope:i}],this._isolationScope=n}withScope(e){const r=this._pushScope();let i;try{i=e(r)}catch(n){throw this._popScope(),n}return Bt(i)?i.then(n=>(this._popScope(),n),n=>{throw this._popScope(),n}):(this._popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function at(){const t=yr(qt());return t.stack=t.stack||new Aa(Rt("defaultCurrentScope",()=>new xe),Rt("defaultIsolationScope",()=>new xe))}function Oa(t){return at().withScope(t)}function Ma(t,e){const r=at();return r.withScope(()=>(r.getStackTop().scope=t,e(t)))}function ri(t){return at().withScope(()=>t(at().getIsolationScope()))}function Mr(t){const e=yr(t);return e.acs?e.acs:{withIsolationScope:ri,withScope:Oa,withSetScope:Ma,withSetIsolationScope:(r,i)=>ri(i),getCurrentScope:()=>at().getScope(),getIsolationScope:()=>at().getIsolationScope()}}function We(){return Mr(qt()).getCurrentScope()}function gt(){return Mr(qt()).getIsolationScope()}function ne(){return We().getClient()}function Pa(t){const e=t.getPropagationContext(),{traceId:r,spanId:i,parentSpanId:n}=e;return de({trace_id:r,span_id:i,parent_span_id:n})}function Ia(t){const e=t._sentryMetrics;if(!e)return;const r={};for(const[,[i,n]]of e)(r[i]||(r[i]=[])).push(de(n));return r}const La=/^sentry-/;function ja(t){const e=function(i){if(!(!i||!ke(i)&&!Array.isArray(i)))return Array.isArray(i)?i.reduce((n,s)=>{const a=ni(s);return Object.entries(a).forEach(([l,d])=>{n[l]=d}),n},{}):ni(i)}(t);if(!e)return;const r=Object.entries(e).reduce((i,[n,s])=>(n.match(La)&&(i[n.slice(7)]=s),i),{});return Object.keys(r).length>0?r:void 0}function ni(t){return t.split(",").map(e=>e.split("=").map(r=>decodeURIComponent(r.trim()))).reduce((e,[r,i])=>(r&&i&&(e[r]=i),e),{})}let ii=!1;function Da(t){const{spanId:e,traceId:r,isRemote:i}=t.spanContext();return de({parent_span_id:i?e:Pr(t).parent_span_id,span_id:i?Tr():e,trace_id:r})}function si(t){return typeof t=="number"?oi(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?oi(t.getTime()):Ce()}function oi(t){return t>9999999999?t/1e3:t}function Pr(t){if(function(e){return typeof e.getSpanJSON=="function"}(t))return t.getSpanJSON();try{const{spanId:e,traceId:r}=t.spanContext();if(function(i){const n=i;return!!(n.attributes&&n.startTime&&n.name&&n.endTime&&n.status)}(t)){const{attributes:i,startTime:n,name:s,endTime:a,parentSpanId:l,status:d}=t;return de({span_id:e,trace_id:r,data:i,description:s,parent_span_id:l,start_timestamp:si(n),timestamp:si(a)||void 0,status:xa(d),op:i["sentry.op"],origin:i["sentry.origin"],_metrics_summary:Ia(t)})}return{span_id:e,trace_id:r}}catch{return{}}}function xa(t){if(t&&t.code!==0)return t.code===1?"ok":t.message||"unknown_error"}function ai(t){return t._sentryRootSpan||t}function Na(){ii||(ft(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),ii=!0)}const Ir="production";function ci(t,e){const r=e.getOptions(),{publicKey:i}=e.getDsn()||{},n=de({environment:r.environment||Ir,release:r.release,public_key:i,trace_id:t});return e.emit("createDsc",n),n}function Ra(t){const e=ne();if(!e)return{};const r=ai(t),i=r._frozenDsc;if(i)return i;const n=r.spanContext().traceState,s=n&&n.get("sentry.dsc"),a=s&&ja(s);if(a)return a;const l=ci(t.spanContext().traceId,e),d=Pr(r),h=d.data||{},f=h["sentry.sample_rate"];f!=null&&(l.sample_rate=`${f}`);const g=h["sentry.source"],w=d.description;return g!=="url"&&w&&(l.transaction=w),function(C){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const _=ne(),v=_&&_.getOptions();return!!v&&(v.enableTracing||"tracesSampleRate"in v||"tracesSampler"in v)}()&&(l.sampled=String(function(C){const{traceFlags:_}=C.spanContext();return _===1}(r))),e.emit("createDsc",l,r),l}const Fa=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Wt(t,e=!1){const{host:r,path:i,pass:n,port:s,projectId:a,protocol:l,publicKey:d}=t;return`${l}://${d}${e&&n?`:${n}`:""}@${r}${s?`:${s}`:""}/${i&&`${i}/`}${a}`}function li(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function Va(t){const e=typeof t=="string"?function(r){const i=Fa.exec(r);if(!i)return void ft(()=>{console.error(`Invalid Sentry Dsn: ${r}`)});const[n,s,a="",l="",d="",h=""]=i.slice(1);let f="",g=h;const w=g.split("/");if(w.length>1&&(f=w.slice(0,-1).join("/"),g=w.pop()),g){const C=g.match(/^\d+/);C&&(g=C[0])}return li({host:l,pass:a,path:f,projectId:g,port:d,protocol:n,publicKey:s})}(t):li(t);if(e&&function(r){if(!ze)return!0;const{port:i,projectId:n,protocol:s}=r;return!(["protocol","publicKey","host","projectId"].find(a=>!r[a]&&(V.error(`Invalid Sentry Dsn: ${a} missing`),!0))||(n.match(/^\d+$/)?function(a){return a==="http"||a==="https"}(s)?i&&isNaN(parseInt(i,10))&&(V.error(`Invalid Sentry Dsn: Invalid port ${i}`),1):(V.error(`Invalid Sentry Dsn: Invalid protocol ${s}`),1):(V.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),1)))}(e))return e}function Ae(t,e=100,r=1/0){try{return Lr("",t,e,r)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function ui(t,e=3,r=102400){const i=Ae(t,e);return n=i,function(s){return~-encodeURI(s).split(/%..|./).length}(JSON.stringify(n))>r?ui(t,e-1,r):i;var n}function Lr(t,e,r=1/0,i=1/0,n=function(){const s=typeof WeakSet=="function",a=s?new WeakSet:[];return[function(l){if(s)return!!a.has(l)||(a.add(l),!1);for(let d=0;d<a.length;d++)if(a[d]===l)return!0;return a.push(l),!1},function(l){if(s)a.delete(l);else for(let d=0;d<a.length;d++)if(a[d]===l){a.splice(d,1);break}}]}()){const[s,a]=n;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const l=function(C,_){try{if(C==="domain"&&_&&typeof _=="object"&&_._events)return"[Domain]";if(C==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&_===global)return"[Global]";if(typeof window<"u"&&_===window)return"[Window]";if(typeof document<"u"&&_===document)return"[Document]";if($n(_))return"[VueViewModel]";if(nt(v=_)&&"nativeEvent"in v&&"preventDefault"in v&&"stopPropagation"in v)return"[SyntheticEvent]";if(typeof _=="number"&&!Number.isFinite(_))return`[${_}]`;if(typeof _=="function")return`[Function: ${je(_)}]`;if(typeof _=="symbol")return`[${String(_)}]`;if(typeof _=="bigint")return`[BigInt: ${String(_)}]`;const E=function(S){const O=Object.getPrototypeOf(S);return O?O.constructor.name:"null prototype"}(_);return/^HTML(\w*)Element$/.test(E)?`[HTMLElement: ${E}]`:`[object ${E}]`}catch(E){return`**non-serializable** (${E})`}var v}(t,e);if(!l.startsWith("[object "))return l;if(e.__sentry_skip_normalization__)return e;const d=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:r;if(d===0)return l.replace("object ","");if(s(e))return"[Circular ~]";const h=e;if(h&&typeof h.toJSON=="function")try{return Lr("",h.toJSON(),d-1,i,n)}catch{}const f=Array.isArray(e)?[]:{};let g=0;const w=Yn(e);for(const C in w){if(!Object.prototype.hasOwnProperty.call(w,C))continue;if(g>=i){f[C]="[MaxProperties ~]";break}const _=w[C];f[C]=Lr(C,_,d-1,i,n),g++}return a(e),f}function vt(t,e=[]){return[t,e]}function za(t,e){const[r,i]=t;return[r,[...i,e]]}function di(t,e){const r=t[1];for(const i of r)if(e(i,i[0].type))return!0;return!1}function jr(t){return G.__SENTRY__&&G.__SENTRY__.encodePolyfill?G.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function qa(t){const[e,r]=t;let i=JSON.stringify(e);function n(s){typeof i=="string"?i=typeof s=="string"?i+s:[jr(i),s]:i.push(typeof s=="string"?jr(s):s)}for(const s of r){const[a,l]=s;if(n(`
${JSON.stringify(a)}
`),typeof l=="string"||l instanceof Uint8Array)n(l);else{let d;try{d=JSON.stringify(l)}catch{d=JSON.stringify(Ae(l))}n(d)}}return typeof i=="string"?i:function(s){const a=s.reduce((h,f)=>h+f.length,0),l=new Uint8Array(a);let d=0;for(const h of s)l.set(h,d),d+=h.length;return l}(i)}function Ua(t){const e=typeof t.data=="string"?jr(t.data):t.data;return[de({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const Ba={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function hi(t){return Ba[t]}function pi(t){if(!t||!t.sdk)return;const{name:e,version:r}=t.sdk;return{name:e,version:r}}function $a(t,e,r,i){const n=pi(r),s=t.type&&t.type!=="replay_event"?t.type:"event";(function(l,d){d&&(l.sdk=l.sdk||{},l.sdk.name=l.sdk.name||d.name,l.sdk.version=l.sdk.version||d.version,l.sdk.integrations=[...l.sdk.integrations||[],...d.integrations||[]],l.sdk.packages=[...l.sdk.packages||[],...d.packages||[]])})(t,r&&r.sdk);const a=function(l,d,h,f){const g=l.sdkProcessingMetadata&&l.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:l.event_id,sent_at:new Date().toISOString(),...d&&{sdk:d},...!!h&&f&&{dsn:Wt(f)},...g&&{trace:de({...g})}}}(t,n,i,e);return delete t.sdkProcessingMetadata,vt(a,[[{type:s},t]])}function Dr(t,e,r,i=0){return new pe((n,s)=>{const a=t[i];if(e===null||typeof a!="function")n(e);else{const l=a({...e},r);H&&a.id&&l===null&&V.log(`Event processor "${a.id}" dropped event`),Bt(l)?l.then(d=>Dr(t,d,r,i+1).then(n)).then(null,s):Dr(t,l,r,i+1).then(n).then(null,s)}})}let Yt,fi,xr;function Ja(t,e){const{fingerprint:r,span:i,breadcrumbs:n,sdkProcessingMetadata:s}=e;(function(a,l){const{extra:d,tags:h,user:f,contexts:g,level:w,transactionName:C}=l,_=de(d);_&&Object.keys(_).length&&(a.extra={..._,...a.extra});const v=de(h);v&&Object.keys(v).length&&(a.tags={...v,...a.tags});const E=de(f);E&&Object.keys(E).length&&(a.user={...E,...a.user});const S=de(g);S&&Object.keys(S).length&&(a.contexts={...S,...a.contexts}),w&&(a.level=w),C&&a.type!=="transaction"&&(a.transaction=C)})(t,e),i&&function(a,l){a.contexts={trace:Da(l),...a.contexts},a.sdkProcessingMetadata={dynamicSamplingContext:Ra(l),...a.sdkProcessingMetadata};const d=ai(l),h=Pr(d).description;h&&!a.transaction&&a.type==="transaction"&&(a.transaction=h)}(t,i),function(a,l){a.fingerprint=a.fingerprint?Array.isArray(a.fingerprint)?a.fingerprint:[a.fingerprint]:[],l&&(a.fingerprint=a.fingerprint.concat(l)),a.fingerprint&&!a.fingerprint.length&&delete a.fingerprint}(t,r),function(a,l){const d=[...a.breadcrumbs||[],...l];a.breadcrumbs=d.length?d:void 0}(t,n),function(a,l){a.sdkProcessingMetadata={...a.sdkProcessingMetadata,...l}}(t,s)}function mi(t,e){const{extra:r,tags:i,user:n,contexts:s,level:a,sdkProcessingMetadata:l,breadcrumbs:d,fingerprint:h,eventProcessors:f,attachments:g,propagationContext:w,transactionName:C,span:_}=e;Ht(t,"extra",r),Ht(t,"tags",i),Ht(t,"user",n),Ht(t,"contexts",s),t.sdkProcessingMetadata=Gt(t.sdkProcessingMetadata,l,2),a&&(t.level=a),C&&(t.transactionName=C),_&&(t.span=_),d.length&&(t.breadcrumbs=[...t.breadcrumbs,...d]),h.length&&(t.fingerprint=[...t.fingerprint,...h]),f.length&&(t.eventProcessors=[...t.eventProcessors,...f]),g.length&&(t.attachments=[...t.attachments,...g]),t.propagationContext={...t.propagationContext,...w}}function Ht(t,e,r){t[e]=Gt(t[e],r,1)}function Ga(t,e,r,i,n,s){const{normalizeDepth:a=3,normalizeMaxBreadth:l=1e3}=t,d={...e,event_id:e.event_id||r.event_id||he(),timestamp:e.timestamp||mt()},h=r.integrations||t.integrations.map(_=>_.name);(function(_,v){const{environment:E,release:S,dist:O,maxValueLength:I=250}=v;_.environment=_.environment||E||Ir,!_.release&&S&&(_.release=S),!_.dist&&O&&(_.dist=O),_.message&&(_.message=it(_.message,I));const y=_.exception&&_.exception.values&&_.exception.values[0];y&&y.value&&(y.value=it(y.value,I));const b=_.request;b&&b.url&&(b.url=it(b.url,I))})(d,t),function(_,v){v.length>0&&(_.sdk=_.sdk||{},_.sdk.integrations=[..._.sdk.integrations||[],...v])}(d,h),n&&n.emit("applyFrameMetadata",e),e.type===void 0&&function(_,v){const E=function(S){const O=G._sentryDebugIds;if(!O)return{};const I=Object.keys(O);return xr&&I.length===fi||(fi=I.length,xr=I.reduce((y,b)=>{Yt||(Yt={});const A=Yt[b];if(A)y[A[0]]=A[1];else{const L=S(b);for(let x=L.length-1;x>=0;x--){const q=L[x],F=q&&q.filename,K=O[b];if(F&&K){y[F]=K,Yt[b]=[F,K];break}}}return y},{})),xr}(v);try{_.exception.values.forEach(S=>{S.stacktrace.frames.forEach(O=>{E&&O.filename&&(O.debug_id=E[O.filename])})})}catch{}}(d,t.stackParser);const f=function(_,v){if(!v)return _;const E=_?_.clone():new xe;return E.update(v),E}(i,r.captureContext);r.mechanism&&st(d,r.mechanism);const g=n?n.getEventProcessors():[],w=Rt("globalScope",()=>new xe).getScopeData();s&&mi(w,s.getScopeData()),f&&mi(w,f.getScopeData());const C=[...r.attachments||[],...w.attachments];return C.length&&(r.attachments=C),Ja(d,w),Dr([...g,...w.eventProcessors],d,r).then(_=>(_&&function(v){const E={};try{v.exception.values.forEach(O=>{O.stacktrace.frames.forEach(I=>{I.debug_id&&(I.abs_path?E[I.abs_path]=I.debug_id:I.filename&&(E[I.filename]=I.debug_id),delete I.debug_id)})})}catch{}if(Object.keys(E).length===0)return;v.debug_meta=v.debug_meta||{},v.debug_meta.images=v.debug_meta.images||[];const S=v.debug_meta.images;Object.entries(E).forEach(([O,I])=>{S.push({type:"sourcemap",code_file:O,debug_id:I})})}(_),typeof a=="number"&&a>0?function(v,E,S){if(!v)return null;const O={...v,...v.breadcrumbs&&{breadcrumbs:v.breadcrumbs.map(I=>({...I,...I.data&&{data:Ae(I.data,E,S)}}))},...v.user&&{user:Ae(v.user,E,S)},...v.contexts&&{contexts:Ae(v.contexts,E,S)},...v.extra&&{extra:Ae(v.extra,E,S)}};return v.contexts&&v.contexts.trace&&O.contexts&&(O.contexts.trace=v.contexts.trace,v.contexts.trace.data&&(O.contexts.trace.data=Ae(v.contexts.trace.data,E,S))),v.spans&&(O.spans=v.spans.map(I=>({...I,...I.data&&{data:Ae(I.data,E,S)}}))),v.contexts&&v.contexts.flags&&O.contexts&&(O.contexts.flags=Ae(v.contexts.flags,3,S)),O}(_,a,l):_))}function Yl(t){}function gi(t,e){return We().captureEvent(t,e)}function vi(t){const e=ne(),r=gt(),i=We(),{release:n,environment:s=Ir}=e&&e.getOptions()||{},{userAgent:a}=G.navigator||{},l=Ta({release:n,environment:s,user:i.getUser()||r.getUser(),...a&&{userAgent:a},...t}),d=r.getSession();return d&&d.status==="ok"&&ot(d,{status:"exited"}),yi(),r.setSession(l),i.setSession(l),l}function yi(){const t=gt(),e=We(),r=e.getSession()||t.getSession();r&&function(i,n){let s={};i.status==="ok"&&(s={status:"exited"}),ot(i,s)}(r),bi(),t.setSession(),e.setSession()}function bi(){const t=gt(),e=We(),r=ne(),i=e.getSession()||t.getSession();i&&r&&r.captureSession(i)}function _i(t=!1){t?yi():bi()}function Wa(t,e,r){return e||`${function(i){return`${function(n){const s=n.protocol?`${n.protocol}:`:"",a=n.port?`:${n.port}`:"";return`${s}//${n.host}${a}${n.path?`/${n.path}`:""}/api/`}(i)}${i.projectId}/envelope/`}(t)}?${function(i,n){const s={sentry_version:"7"};return i.publicKey&&(s.sentry_key=i.publicKey),n&&(s.sentry_client=`${n.name}/${n.version}`),new URLSearchParams(s).toString()}(t,r)}`}const wi=[];function Si(t,e){for(const r of e)r&&r.afterAllSetup&&r.afterAllSetup(t)}function Ei(t,e,r){if(r[e.name])H&&V.log(`Integration skipped because it was already installed: ${e.name}`);else{if(r[e.name]=e,wi.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),wi.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const i=e.preprocessEvent.bind(e);t.on("preprocessEvent",(n,s)=>i(n,s,t))}if(typeof e.processEvent=="function"){const i=e.processEvent.bind(e),n=Object.assign((s,a)=>i(s,a,t),{id:e.name});t.addEventProcessor(n)}H&&V.log(`Integration installed: ${e.name}`)}}class ye extends Error{constructor(e,r="warn"){super(e),this.message=e,this.logLevel=r}}const ki="Not capturing exception because it's already been captured.";class Ya{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Va(e.dsn):H&&V.warn("No DSN provided, client will not send events."),this._dsn){const i=Wa(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:i})}const r=["enableTracing","tracesSampleRate","tracesSampler"].find(i=>i in e&&e[i]==null);r&&ft(()=>{console.warn(`[Sentry] Deprecation warning: \`${r}\` is set to undefined, which leads to tracing being enabled. In v9, a value of \`undefined\` will result in tracing being disabled.`)})}captureException(e,r,i){const n=he();if(Xn(e))return H&&V.log(ki),n;const s={event_id:n,...r};return this._process(this.eventFromException(e,s).then(a=>this._captureEvent(a,s,i))),s.event_id}captureMessage(e,r,i,n){const s={event_id:he(),...i},a=_r(e)?e:String(e),l=wr(e)?this.eventFromMessage(a,r,s):this.eventFromException(e,s);return this._process(l.then(d=>this._captureEvent(d,s,n))),s.event_id}captureEvent(e,r,i){const n=he();if(r&&r.originalException&&Xn(r.originalException))return H&&V.log(ki),n;const s={event_id:n,...r},a=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,s,a||i)),s.event_id}captureSession(e){typeof e.release!="string"?H&&V.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),ot(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const r=this._transport;return r?(this.emit("flush"),this._isClientDoneProcessing(e).then(i=>r.flush(e).then(n=>i&&n))):Ge(!0)}close(e){return this.flush(e).then(r=>(this.getOptions().enabled=!1,this.emit("close"),r))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const r=this._integrations[e.name];Ei(this,e,this._integrations),r||Si(this,[e])}sendEvent(e,r={}){this.emit("beforeSendEvent",e,r);let i=$a(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of r.attachments||[])i=za(i,Ua(s));const n=this.sendEnvelope(i);n&&n.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const r=function(i,n,s,a){const l=pi(s);return vt({sent_at:new Date().toISOString(),...l&&{sdk:l},...!!a&&n&&{dsn:Wt(n)}},["aggregates"in i?[{type:"sessions"},i]:[{type:"session"},i.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,r,i){if(this._options.sendClientReports){const n=typeof i=="number"?i:1,s=`${e}:${r}`;H&&V.log(`Recording outcome: "${s}"${n>1?` (${n} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+n}}on(e,r){const i=this._hooks[e]=this._hooks[e]||[];return i.push(r),()=>{const n=i.indexOf(r);n>-1&&i.splice(n,1)}}emit(e,...r){const i=this._hooks[e];i&&i.forEach(n=>n(...r))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,r=>(H&&V.error("Error while sending envelope:",r),r)):(H&&V.error("Transport disabled"),Ge({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=function(r,i){const n={};return i.forEach(s=>{s&&Ei(r,s,n)}),n}(this,e),Si(this,e)}_updateSessionFromEvent(e,r){let i=r.level==="fatal",n=!1;const s=r.exception&&r.exception.values;if(s){n=!0;for(const l of s){const d=l.mechanism;if(d&&d.handled===!1){i=!0;break}}}const a=e.status==="ok";(a&&e.errors===0||a&&i)&&(ot(e,{...i&&{status:"crashed"},errors:e.errors||Number(n||i)}),this.captureSession(e))}_isClientDoneProcessing(e){return new pe(r=>{let i=0;const n=setInterval(()=>{this._numProcessing==0?(clearInterval(n),r(!0)):(i+=1,e&&i>=e&&(clearInterval(n),r(!1)))},1)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,r,i=We(),n=gt()){const s=this.getOptions(),a=Object.keys(this._integrations);return!r.integrations&&a.length>0&&(r.integrations=a),this.emit("preprocessEvent",e,r),e.type||n.setLastEventId(e.event_id||r.event_id),Ga(s,e,r,i,this,n).then(l=>{if(l===null)return l;l.contexts={trace:Pa(i),...l.contexts};const d=function(h,f){const g=f.getPropagationContext();return g.dsc||ci(g.traceId,h)}(this,i);return l.sdkProcessingMetadata={dynamicSamplingContext:d,...l.sdkProcessingMetadata},l})}_captureEvent(e,r={},i){return this._processEvent(e,r,i).then(n=>n.event_id,n=>{H&&(n instanceof ye&&n.logLevel==="log"?V.log(n.message):V.warn(n))})}_processEvent(e,r,i){const n=this.getOptions(),{sampleRate:s}=n,a=Ti(e),l=Ci(e),d=e.type||"error",h=`before send for type \`${d}\``,f=s===void 0?void 0:function(C){if(typeof C=="boolean")return Number(C);const _=typeof C=="string"?parseFloat(C):C;if(!(typeof _!="number"||isNaN(_)||_<0||_>1))return _;H&&V.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(C)} of type ${JSON.stringify(typeof C)}.`)}(s);if(l&&typeof f=="number"&&Math.random()>f)return this.recordDroppedEvent("sample_rate","error",e),Jt(new ye(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const g=d==="replay_event"?"replay":d,w=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,r,i,w).then(C=>{if(C===null)throw this.recordDroppedEvent("event_processor",g,e),new ye("An event processor returned `null`, will not send event.","log");if(r.data&&r.data.__sentry__===!0)return C;const _=function(v,E,S,O){const{beforeSend:I,beforeSendTransaction:y,beforeSendSpan:b}=E;if(Ci(S)&&I)return I(S,O);if(Ti(S)){if(S.spans&&b){const A=[];for(const L of S.spans){const x=b(L);x?A.push(x):(Na(),v.recordDroppedEvent("before_send","span"))}S.spans=A}if(y){if(S.spans){const A=S.spans.length;S.sdkProcessingMetadata={...S.sdkProcessingMetadata,spanCountBeforeProcessing:A}}return y(S,O)}}return S}(this,n,C,r);return function(v,E){const S=`${E} must return \`null\` or a valid event.`;if(Bt(v))return v.then(O=>{if(!nt(O)&&O!==null)throw new ye(S);return O},O=>{throw new ye(`${E} rejected with ${O}`)});if(!nt(v)&&v!==null)throw new ye(S);return v}(_,h)}).then(C=>{if(C===null){if(this.recordDroppedEvent("before_send",g,e),a){const E=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",E)}throw new ye(`${h} returned \`null\`, will not send event.`,"log")}const _=i&&i.getSession();if(!a&&_&&this._updateSessionFromEvent(_,C),a){const E=(C.sdkProcessingMetadata&&C.sdkProcessingMetadata.spanCountBeforeProcessing||0)-(C.spans?C.spans.length:0);E>0&&this.recordDroppedEvent("before_send","span",E)}const v=C.transaction_info;if(a&&v&&C.transaction!==e.transaction){const E="custom";C.transaction_info={...v,source:E}}return this.sendEvent(C,r),C}).then(null,C=>{throw C instanceof ye?C:(this.captureException(C,{data:{__sentry__:!0},originalException:C}),new ye(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${C}`))})}_process(e){this._numProcessing++,e.then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([r,i])=>{const[n,s]=r.split(":");return{reason:n,category:s,quantity:i}})}_flushOutcomes(){H&&V.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0)return void(H&&V.log("No outcomes to send"));if(!this._dsn)return void(H&&V.log("No dsn provided, will not send outcomes"));H&&V.log("Sending outcomes:",e);const r=(i=e,vt((n=this._options.tunnel&&Wt(this._dsn))?{dsn:n}:{},[[{type:"client_report"},{timestamp:s||mt(),discarded_events:i}]]));var i,n,s;this.sendEnvelope(r)}}function Ci(t){return t.type===void 0}function Ti(t){return t.type==="transaction"}function Ha(t){const e=[];function r(i){return e.splice(e.indexOf(i),1)[0]||Promise.resolve(void 0)}return{$:e,add:function(i){if(!(t===void 0||e.length<t))return Jt(new ye("Not adding Promise because buffer limit was reached."));const n=i();return e.indexOf(n)===-1&&e.push(n),n.then(()=>r(n)).then(null,()=>r(n).then(null,()=>{})),n},drain:function(i){return new pe((n,s)=>{let a=e.length;if(!a)return n(!0);const l=setTimeout(()=>{i&&i>0&&n(!1)},i);e.forEach(d=>{Ge(d).then(()=>{--a||(clearTimeout(l),n(!0))},s)})})}}}function Qa(t,{statusCode:e,headers:r},i=Date.now()){const n={...t},s=r&&r["x-sentry-rate-limits"],a=r&&r["retry-after"];if(s)for(const l of s.trim().split(",")){const[d,h,,,f]=l.split(":",5),g=parseInt(d,10),w=1e3*(isNaN(g)?60:g);if(h)for(const C of h.split(";"))C==="metric_bucket"&&f&&!f.split(";").includes("custom")||(n[C]=i+w);else n.all=i+w}else a?n.all=i+function(l,d=Date.now()){const h=parseInt(`${l}`,10);if(!isNaN(h))return 1e3*h;const f=Date.parse(`${l}`);return isNaN(f)?6e4:f-d}(a,i):e===429&&(n.all=i+6e4);return n}function Ka(t,e,r=Ha(t.bufferSize||64)){let i={};return{send:function(n){const s=[];if(di(n,(d,h)=>{const f=hi(h);if(function(g,w,C=Date.now()){return function(_,v){return _[v]||_.all||0}(g,w)>C}(i,f)){const g=Ai(d,h);t.recordDroppedEvent("ratelimit_backoff",f,g)}else s.push(d)}),s.length===0)return Ge({});const a=vt(n[0],s),l=d=>{di(a,(h,f)=>{const g=Ai(h,f);t.recordDroppedEvent(d,hi(f),g)})};return r.add(()=>e({body:qa(a)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&H&&V.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),i=Qa(i,d),d),d=>{throw l("network_error"),d})).then(d=>d,d=>{if(d instanceof ye)return H&&V.error("Skipped sending event because buffer is full."),l("queue_overflow"),Ge({});throw d})},flush:n=>r.drain(n)}}function Ai(t,e){if(e==="event"||e==="transaction")return Array.isArray(t)?t[1]:void 0}const Xa=100;function Ye(t,e){const r=ne(),i=gt();if(!r)return;const{beforeBreadcrumb:n=null,maxBreadcrumbs:s=Xa}=r.getOptions();if(s<=0)return;const a={timestamp:mt(),...t},l=n?ft(()=>n(a,e)):a;l!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",l,e),i.addBreadcrumb(l,s))}let Oi;const Mi=new WeakMap,Za=()=>({name:"FunctionToString",setupOnce(){Oi=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=Er(this),r=Mi.has(ne())&&e!==void 0?e:this;return Oi.apply(r,t)}}catch{}},setup(t){Mi.set(t,!0)}}),ec=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],tc=(t={})=>({name:"InboundFilters",processEvent(e,r,i){const n=i.getOptions(),s=function(a={},l={}){return{allowUrls:[...a.allowUrls||[],...l.allowUrls||[]],denyUrls:[...a.denyUrls||[],...l.denyUrls||[]],ignoreErrors:[...a.ignoreErrors||[],...l.ignoreErrors||[],...a.disableErrorDefaults?[]:ec],ignoreTransactions:[...a.ignoreTransactions||[],...l.ignoreTransactions||[]],ignoreInternal:a.ignoreInternal===void 0||a.ignoreInternal}}(t,n);return function(a,l){return l.ignoreInternal&&function(d){try{return d.exception.values[0].type==="SentryError"}catch{}return!1}(a)?(H&&V.warn(`Event dropped due to being internal Sentry Error.
Event: ${De(a)}`),!0):function(d,h){return d.type||!h||!h.length?!1:function(f){const g=[];f.message&&g.push(f.message);let w;try{w=f.exception.values[f.exception.values.length-1]}catch{}return w&&w.value&&(g.push(w.value),w.type&&g.push(`${w.type}: ${w.value}`)),g}(d).some(f=>$t(f,h))}(a,l.ignoreErrors)?(H&&V.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${De(a)}`),!0):function(d){return d.type||!d.exception||!d.exception.values||d.exception.values.length===0?!1:!d.message&&!d.exception.values.some(h=>h.stacktrace||h.type&&h.type!=="Error"||h.value)}(a)?(H&&V.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${De(a)}`),!0):function(d,h){if(d.type!=="transaction"||!h||!h.length)return!1;const f=d.transaction;return!!f&&$t(f,h)}(a,l.ignoreTransactions)?(H&&V.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${De(a)}`),!0):function(d,h){if(!h||!h.length)return!1;const f=Qt(d);return!!f&&$t(f,h)}(a,l.denyUrls)?(H&&V.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${De(a)}.
Url: ${Qt(a)}`),!0):function(d,h){if(!h||!h.length)return!0;const f=Qt(d);return!f||$t(f,h)}(a,l.allowUrls)?!1:(H&&V.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${De(a)}.
Url: ${Qt(a)}`),!0)}(e,s)?null:e}});function Qt(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?function(r=[]){for(let i=r.length-1;i>=0;i--){const n=r[i];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}(e):null}catch{return H&&V.error(`Cannot extract url for event ${De(t)}`),null}}function rc(t,e,r=250,i,n,s,a){if(!(s.exception&&s.exception.values&&a&&$e(a.originalException,Error)))return;const l=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;var d,h;l&&(s.exception.values=(d=Nr(t,e,n,a.originalException,i,s.exception.values,l,0),h=r,d.map(f=>(f.value&&(f.value=it(f.value,h)),f))))}function Nr(t,e,r,i,n,s,a,l){if(s.length>=r+1)return s;let d=[...s];if($e(i[n],Error)){Pi(a,l);const h=t(e,i[n]),f=d.length;Ii(h,n,f,l),d=Nr(t,e,r,i[n],n,[h,...d],h,f)}return Array.isArray(i.errors)&&i.errors.forEach((h,f)=>{if($e(h,Error)){Pi(a,l);const g=t(e,h),w=d.length;Ii(g,`errors[${f}]`,w,l),d=Nr(t,e,r,h,n,[g,...d],g,w)}}),d}function Pi(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Ii(t,e,r,i){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:r,parent_id:i}}function Rr(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const r=e[6]||"",i=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:r,hash:i,relative:e[5]+r+i}}function nc(){"console"in G&&mr.forEach(function(t){t in G.console&&le(G.console,t,function(e){return Ft[t]=e,function(...r){ve("console",{args:r,level:t});const i=Ft[t];i&&i.apply(G.console,r)}})})}function ic(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const sc=()=>{let t;return{name:"Dedupe",processEvent(e){if(e.type)return e;try{if(function(r,i){return i?!!(function(n,s){const a=n.message,l=s.message;return!(!a&&!l||a&&!l||!a&&l||a!==l||!ji(n,s)||!Li(n,s))}(r,i)||function(n,s){const a=Di(s),l=Di(n);return!(!a||!l||a.type!==l.type||a.value!==l.value||!ji(n,s)||!Li(n,s))}(r,i)):!1}(e,t))return H&&V.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}};function Li(t,e){let r=Vn(t),i=Vn(e);if(!r&&!i)return!0;if(r&&!i||!r&&i||i.length!==r.length)return!1;for(let n=0;n<i.length;n++){const s=i[n],a=r[n];if(s.filename!==a.filename||s.lineno!==a.lineno||s.colno!==a.colno||s.function!==a.function)return!1}return!0}function ji(t,e){let r=t.fingerprint,i=e.fingerprint;if(!r&&!i)return!0;if(r&&!i||!r&&i)return!1;try{return r.join("")===i.join("")}catch{return!1}}function Di(t){return t.exception&&t.exception.values&&t.exception.values[0]}function xi(t){return t===void 0?void 0:t>=400&&t<500?"warning":t>=500?"error":void 0}const Fr=G;function Vr(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function oc(){if(typeof EdgeRuntime=="string")return!0;if(!function(){if(!("fetch"in Fr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}())return!1;if(Vr(Fr.fetch))return!0;let t=!1;const e=Fr.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(t=Vr(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){ze&&V.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function ac(t,e){const r="fetch";Ue(r,t),Be(r,()=>function(i,n=!1){n&&!oc()||le(G,"fetch",function(s){return function(...a){const l=new Error,{method:d,url:h}=function(g){if(g.length===0)return{method:"GET",url:""};if(g.length===2){const[C,_]=g;return{url:Ni(C),method:zr(_,"method")?String(_.method).toUpperCase():"GET"}}const w=g[0];return{url:Ni(w),method:zr(w,"method")?String(w.method).toUpperCase():"GET"}}(a),f={args:a,fetchData:{method:d,url:h},startTimestamp:1e3*Ce(),virtualError:l};return i||ve("fetch",{...f}),s.apply(G,a).then(async g=>(i?i(g):ve("fetch",{...f,endTimestamp:1e3*Ce(),response:g}),g),g=>{throw ve("fetch",{...f,endTimestamp:1e3*Ce(),error:g}),br(g)&&g.stack===void 0&&(g.stack=l.stack,Je(g,"framesToPop",1)),g})}})}(void 0,e))}function zr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Ni(t){return typeof t=="string"?t:t?zr(t,"url")?t.url:t.toString?t.toString():"":""}const Kt=G,Z=G;let qr=0;function Ri(){return qr>0}function ct(t,e={}){if(!function(i){return typeof i=="function"}(t))return t;try{const i=t.__sentry_wrapped__;if(i)return typeof i=="function"?i:t;if(Er(t))return t}catch{return t}const r=function(...i){try{const n=i.map(s=>ct(s,e));return t.apply(this,n)}catch(n){throw qr++,setTimeout(()=>{qr--}),function(...s){const a=Mr(qt());if(s.length===2){const[l,d]=s;return l?a.withSetScope(l,d):a.withScope(d)}a.withScope(s[0])}(s=>{var a;s.addEventProcessor(l=>(e.mechanism&&(Cr(l,void 0),st(l,e.mechanism)),l.extra={...l.extra,arguments:i},l)),a=n,We().captureException(a,void 0)}),n}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}catch{}Wn(r,t),Je(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get:()=>t.name})}catch{}return r}const Xt=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Ur(t,e){const r=$r(t,e),i={type:uc(e),value:dc(e)};return r.length&&(i.stacktrace={frames:r}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function cc(t,e,r,i){const n=ne(),s=n&&n.getOptions().normalizeDepth,a=function(h){for(const f in h)if(Object.prototype.hasOwnProperty.call(h,f)){const g=h[f];if(g instanceof Error)return g}}(e),l={__serialized__:ui(e,s)};if(a)return{exception:{values:[Ur(t,a)]},extra:l};const d={exception:{values:[{type:Ut(e)?e.constructor.name:i?"UnhandledRejection":"Error",value:hc(e,{isUnhandledRejection:i})}]},extra:l};if(r){const h=$r(t,r);h.length&&(d.exception.values[0].stacktrace={frames:h})}return d}function Br(t,e){return{exception:{values:[Ur(t,e)]}}}function $r(t,e){const r=e.stacktrace||e.stack||"",i=function(s){return s&&lc.test(s.message)?1:0}(e),n=function(s){return typeof s.framesToPop=="number"?s.framesToPop:0}(e);try{return t(r,i,n)}catch{}return[]}const lc=/Minified React error #\d+;/i;function Fi(t){return typeof WebAssembly<"u"&&WebAssembly.Exception!==void 0&&t instanceof WebAssembly.Exception}function uc(t){const e=t&&t.name;return!e&&Fi(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function dc(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:Fi(t)&&Array.isArray(t.message)&&t.message.length==2?t.message[1]:e:"No error message"}function Jr(t,e,r,i,n){let s;if(Un(e)&&e.error)return Br(t,e.error);if(Bn(e)||rt(e,"DOMException")){const a=e;if("stack"in e)s=Br(t,e);else{const l=a.name||(Bn(a)?"DOMError":"DOMException"),d=a.message?`${l}: ${a.message}`:l;s=Gr(t,d,r,i),Cr(s,d)}return"code"in a&&(s.tags={...s.tags,"DOMException.code":`${a.code}`}),s}return br(e)?Br(t,e):nt(e)||Ut(e)?(s=cc(t,e,r,n),st(s,{synthetic:!0}),s):(s=Gr(t,e,r,i),Cr(s,`${e}`),st(s,{synthetic:!0}),s)}function Gr(t,e,r,i){const n={};if(i&&r){const s=$r(t,r);s.length&&(n.exception={values:[{value:e,stacktrace:{frames:s}}]}),st(n,{synthetic:!0})}if(_r(e)){const{__sentry_template_string__:s,__sentry_template_values__:a}=e;return n.logentry={message:s,params:a},n}return n.message=e,n}function hc(t,{isUnhandledRejection:e}){const r=function(n,s=40){const a=Object.keys(Yn(n));a.sort();const l=a[0];if(!l)return"[object has no keys]";if(l.length>=s)return it(l,s);for(let d=a.length;d>0;d--){const h=a.slice(0,d).join(", ");if(!(h.length>s))return d===a.length?h:it(h,s)}return""}(t),i=e?"promise rejection":"exception";return Un(t)?`Event \`ErrorEvent\` captured as ${i} with message \`${t.message}\``:Ut(t)?`Event \`${function(n){try{const s=Object.getPrototypeOf(n);return s?s.constructor.name:void 0}catch{}}(t)}\` (type=${t.type}) captured as ${i}`:`Object captured as ${i} with keys: ${r}`}class pc extends Ya{constructor(e){const r={parentSpanIsAlwaysRootSpan:!0,...e};(function(i,n,s=[n],a="npm"){const l=i._metadata||{};l.sdk||(l.sdk={name:`sentry.javascript.${n}`,packages:s.map(d=>({name:`${a}:@sentry/${d}`,version:Ve})),version:Ve}),i._metadata=l})(r,"browser",["browser"],Z.SENTRY_SDK_SOURCE||"npm"),super(r),r.sendClientReports&&Z.document&&Z.document.addEventListener("visibilitychange",()=>{Z.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,r){return function(i,n,s,a){const l=Jr(i,n,s&&s.syntheticException||void 0,a);return st(l),l.level="error",s&&s.event_id&&(l.event_id=s.event_id),Ge(l)}(this._options.stackParser,e,r,this._options.attachStacktrace)}eventFromMessage(e,r="info",i){return function(n,s,a="info",l,d){const h=Gr(n,s,l&&l.syntheticException||void 0,d);return h.level=a,l&&l.event_id&&(h.event_id=l.event_id),Ge(h)}(this._options.stackParser,e,r,i,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled())return void(Xt&&V.warn("SDK not enabled, will not capture user feedback."));const r=function(i,{metadata:n,tunnel:s,dsn:a}){const l={event_id:i.event_id,sent_at:new Date().toISOString(),...n&&n.sdk&&{sdk:{name:n.sdk.name,version:n.sdk.version}},...!!s&&!!a&&{dsn:Wt(a)}};return vt(l,[function(h){return[{type:"user_report"},h]}(i)])}(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(r)}_prepareEvent(e,r,i){return e.platform=e.platform||"javascript",super._prepareEvent(e,r,i)}}const fc=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,oe=G;let Vi,Wr,Yr,Zt;function mc(){if(!oe.document)return;const t=ve.bind(null,"dom"),e=zi(t,!0);oe.document.addEventListener("click",e,!1),oe.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(r=>{const i=oe[r],n=i&&i.prototype;n&&n.hasOwnProperty&&n.hasOwnProperty("addEventListener")&&(le(n,"addEventListener",function(s){return function(a,l,d){if(a==="click"||a=="keypress")try{const h=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},f=h[a]=h[a]||{refCount:0};if(!f.handler){const g=zi(t);f.handler=g,s.call(this,a,g,d)}f.refCount++}catch{}return s.call(this,a,l,d)}}),le(n,"removeEventListener",function(s){return function(a,l,d){if(a==="click"||a=="keypress")try{const h=this.__sentry_instrumentation_handlers__||{},f=h[a];f&&(f.refCount--,f.refCount<=0&&(s.call(this,a,f.handler,d),f.handler=void 0,delete h[a]),Object.keys(h).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return s.call(this,a,l,d)}}))})}function zi(t,e=!1){return r=>{if(!r||r._sentryCaptured)return;const i=function(s){try{return s.target}catch{return null}}(r);if(function(s,a){return s==="keypress"&&(!a||!a.tagName||a.tagName!=="INPUT"&&a.tagName!=="TEXTAREA"&&!a.isContentEditable)}(r.type,i))return;Je(r,"_sentryCaptured",!0),i&&!i._sentryId&&Je(i,"_sentryId",he());const n=r.type==="keypress"?"input":r.type;(function(s){if(s.type!==Wr)return!1;try{if(!s.target||s.target._sentryId!==Yr)return!1}catch{}return!0})(r)||(t({event:r,name:n,global:e}),Wr=r.type,Yr=i?i._sentryId:void 0),clearTimeout(Vi),Vi=oe.setTimeout(()=>{Yr=void 0,Wr=void 0},1e3)}}function qi(t){const e="history";Ue(e,t),Be(e,gc)}function gc(){if(!function(){const r=Kt.chrome,i=r&&r.app&&r.app.runtime,n="history"in Kt&&!!Kt.history.pushState&&!!Kt.history.replaceState;return!i&&n}())return;const t=oe.onpopstate;function e(r){return function(...i){const n=i.length>2?i[2]:void 0;if(n){const s=Zt,a=String(n);Zt=a,ve("history",{from:s,to:a})}return r.apply(this,i)}}oe.onpopstate=function(...r){const i=oe.location.href,n=Zt;if(Zt=i,ve("history",{from:n,to:i}),t)try{return t.apply(this,r)}catch{}},le(oe.history,"pushState",e),le(oe.history,"replaceState",e)}const er={};function Ui(t){er[t]=void 0}const yt="__sentry_xhr_v3__";function vc(){if(!oe.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,r,i){const n=new Error,s=1e3*Ce(),a=ke(i[0])?i[0].toUpperCase():void 0,l=function(h){if(ke(h))return h;try{return h.toString()}catch{}}(i[1]);if(!a||!l)return e.apply(r,i);r[yt]={method:a,url:l,request_headers:{}},a==="POST"&&l.match(/sentry_key/)&&(r.__sentry_own_request__=!0);const d=()=>{const h=r[yt];if(h&&r.readyState===4){try{h.status_code=r.status}catch{}ve("xhr",{endTimestamp:1e3*Ce(),startTimestamp:s,xhr:r,virtualError:n})}};return"onreadystatechange"in r&&typeof r.onreadystatechange=="function"?r.onreadystatechange=new Proxy(r.onreadystatechange,{apply:(h,f,g)=>(d(),h.apply(f,g))}):r.addEventListener("readystatechange",d),r.setRequestHeader=new Proxy(r.setRequestHeader,{apply(h,f,g){const[w,C]=g,_=f[yt];return _&&ke(w)&&ke(C)&&(_.request_headers[w.toLowerCase()]=C),h.apply(f,g)}}),e.apply(r,i)}}),t.send=new Proxy(t.send,{apply(e,r,i){const n=r[yt];return n?(i[0]!==void 0&&(n.body=i[0]),ve("xhr",{startTimestamp:1e3*Ce(),xhr:r}),e.apply(r,i)):e.apply(r,i)}})}function yc(t,e=function(r){const i=er[r];if(i)return i;let n=oe[r];if(Vr(n))return er[r]=n.bind(oe);const s=oe.document;if(s&&typeof s.createElement=="function")try{const a=s.createElement("iframe");a.hidden=!0,s.head.appendChild(a);const l=a.contentWindow;l&&l[r]&&(n=l[r]),s.head.removeChild(a)}catch(a){fc&&V.warn(`Could not create sandbox iframe for ${r} check, bailing to window.${r}: `,a)}return n&&(er[r]=n.bind(oe))}("fetch")){let r=0,i=0;return Ka(t,function(n){const s=n.body.length;r+=s,i++;const a={body:n.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:r<=6e4&&i<15,...t.fetchOptions};if(!e)return Ui("fetch"),Jt("No fetch implementation available");try{return e(t.url,a).then(l=>(r-=s,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return Ui("fetch"),r-=s,i--,Jt(l)}})}function Hr(t,e,r,i){const n={filename:t,function:e==="<anonymous>"?qe:e,in_app:!0};return r!==void 0&&(n.lineno=r),i!==void 0&&(n.colno=i),n}const bc=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,_c=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,wc=/\((\S*)(?::(\d+))(?::(\d+))\)/,Sc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Ec=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,kc=function(...t){const e=t.sort((r,i)=>r[0]-i[0]).map(r=>r[1]);return(r,i=0,n=0)=>{const s=[],a=r.split(`
`);for(let l=i;l<a.length;l++){const d=a[l];if(d.length>1024)continue;const h=Nn.test(d)?d.replace(Nn,"$1"):d;if(!h.match(/\S*Error: /)){for(const f of e){const g=f(h);if(g){s.push(g);break}}if(s.length>=50+n)break}}return function(l){if(!l.length)return[];const d=Array.from(l);return/sentryWrapped/.test(Vt(d).function||"")&&d.pop(),d.reverse(),Rn.test(Vt(d).function||"")&&(d.pop(),Rn.test(Vt(d).function||"")&&d.pop()),d.slice(0,50).map(h=>({...h,filename:h.filename||Vt(d).filename,function:h.function||qe}))}(s.slice(n))}}([30,t=>{const e=bc.exec(t);if(e){const[,i,n,s]=e;return Hr(i,qe,+n,+s)}const r=_c.exec(t);if(r){if(r[2]&&r[2].indexOf("eval")===0){const s=wc.exec(r[2]);s&&(r[2]=s[1],r[3]=s[2],r[4]=s[3])}const[i,n]=Bi(r[1]||qe,r[2]);return Hr(n,i,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}}],[50,t=>{const e=Sc.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const n=Ec.exec(e[3]);n&&(e[1]=e[1]||"eval",e[3]=n[1],e[4]=n[2],e[5]="")}let r=e[3],i=e[1]||qe;return[i,r]=Bi(i,r),Hr(r,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}}]),Bi=(t,e)=>{const r=t.indexOf("safari-extension")!==-1,i=t.indexOf("safari-web-extension")!==-1;return r||i?[t.indexOf("@")!==-1?t.split("@")[0]:qe,r?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},$i=1024,Cc=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:"Breadcrumbs",setup(r){var i;e.console&&function(n){const s="console";Ue(s,n),Be(s,nc)}(function(n){return function(s){if(ne()!==n)return;const a={category:"console",data:{arguments:s.args,logger:"console"},level:ic(s.level),message:Gn(s.args," ")};if(s.level==="assert"){if(s.args[0]!==!1)return;a.message=`Assertion failed: ${Gn(s.args.slice(1)," ")||"console.assert"}`,a.data.arguments=s.args.slice(1)}Ye(a,{input:s.args,level:s.level})}}(r)),e.dom&&(i=function(n,s){return function(a){if(ne()!==n)return;let l,d,h=typeof s=="object"?s.serializeAttribute:void 0,f=typeof s=="object"&&typeof s.maxStringLength=="number"?s.maxStringLength:void 0;f&&f>$i&&(Xt&&V.warn(`\`dom.maxStringLength\` cannot exceed 1024, but a value of ${f} was configured. Sentry will use 1024 instead.`),f=$i),typeof h=="string"&&(h=[h]);try{const w=a.event,C=function(_){return!!_&&!!_.target}(w)?w.target:w;l=Jn(C,{keyAttrs:h,maxStringLength:f}),d=function(_){if(!Sr.HTMLElement)return null;let v=_;for(let E=0;E<5;E++){if(!v)return null;if(v instanceof HTMLElement){if(v.dataset.sentryComponent)return v.dataset.sentryComponent;if(v.dataset.sentryElement)return v.dataset.sentryElement}v=v.parentNode}return null}(C)}catch{l="<unknown>"}if(l.length===0)return;const g={category:`ui.${a.name}`,message:l};d&&(g.data={"ui.component_name":d}),Ye(g,{event:a.event,name:a.name,global:a.global})}}(r,e.dom),Ue("dom",i),Be("dom",mc)),e.xhr&&function(n){Ue("xhr",n),Be("xhr",vc)}(function(n){return function(s){if(ne()!==n)return;const{startTimestamp:a,endTimestamp:l}=s,d=s.xhr[yt];if(!a||!l||!d)return;const{method:h,url:f,status_code:g,body:w}=d,C={method:h,url:f,status_code:g},_={xhr:s.xhr,input:w,startTimestamp:a,endTimestamp:l};Ye({category:"xhr",data:C,type:"http",level:xi(g)},_)}}(r)),e.fetch&&ac(function(n){return function(s){if(ne()!==n)return;const{startTimestamp:a,endTimestamp:l}=s;if(l&&(!s.fetchData.url.match(/sentry_key/)||s.fetchData.method!=="POST"))if(s.error)Ye({category:"fetch",data:s.fetchData,level:"error",type:"http"},{data:s.error,input:s.args,startTimestamp:a,endTimestamp:l});else{const d=s.response,h={...s.fetchData,status_code:d&&d.status},f={input:s.args,response:d,startTimestamp:a,endTimestamp:l};Ye({category:"fetch",data:h,type:"http",level:xi(h.status_code)},f)}}}(r)),e.history&&qi(function(n){return function(s){if(ne()!==n)return;let a=s.from,l=s.to;const d=Rr(Z.location.href);let h=a?Rr(a):void 0;const f=Rr(l);h&&h.path||(h=d),d.protocol===f.protocol&&d.host===f.host&&(l=f.relative),d.protocol===h.protocol&&d.host===h.host&&(a=h.relative),Ye({category:"navigation",data:{from:a,to:l}})}}(r)),e.sentry&&r.on("beforeSendEvent",function(n){return function(s){ne()===n&&Ye({category:"sentry."+(s.type==="transaction"?"transaction":"event"),event_id:s.event_id,level:s.level,message:De(s)},{event:s})}}(r))}}},Tc=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Ac=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&le(Z,"setTimeout",Ji),e.setInterval&&le(Z,"setInterval",Ji),e.requestAnimationFrame&&le(Z,"requestAnimationFrame",Oc),e.XMLHttpRequest&&"XMLHttpRequest"in Z&&le(XMLHttpRequest.prototype,"send",Mc);const r=e.eventTarget;r&&(Array.isArray(r)?r:Tc).forEach(Pc)}}};function Ji(t){return function(...e){const r=e[0];return e[0]=ct(r,{mechanism:{data:{function:je(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function Oc(t){return function(e){return t.apply(this,[ct(e,{mechanism:{data:{function:"requestAnimationFrame",handler:je(t)},handled:!1,type:"instrument"}})])}}function Mc(t){return function(...e){const r=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in r&&typeof r[i]=="function"&&le(r,i,function(n){const s={mechanism:{data:{function:i,handler:je(n)},handled:!1,type:"instrument"}},a=Er(n);return a&&(s.mechanism.data.handler=je(a)),ct(n,s)})}),t.apply(this,e)}}function Pc(t){const e=Z[t],r=e&&e.prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(le(r,"addEventListener",function(i){return function(n,s,a){try{typeof s.handleEvent=="function"&&(s.handleEvent=ct(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:je(s),target:t},handled:!1,type:"instrument"}}))}catch{}return i.apply(this,[n,ct(s,{mechanism:{data:{function:"addEventListener",handler:je(s),target:t},handled:!1,type:"instrument"}}),a])}}),le(r,"removeEventListener",function(i){return function(n,s,a){try{const l=s.__sentry_wrapped__;l&&i.call(this,n,l,a)}catch{}return i.call(this,n,s,a)}}))}const Ic=()=>({name:"BrowserSession",setupOnce(){Z.document!==void 0?(vi({ignoreDuration:!0}),_i(),qi(({from:t,to:e})=>{t!==void 0&&t!==e&&(vi({ignoreDuration:!0}),_i())})):Xt&&V.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Lc=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(r){e.onerror&&(function(i){(function(n){const s="error";Ue(s,n),Be(s,Sa)})(n=>{const{stackParser:s,attachStacktrace:a}=Wi();if(ne()!==i||Ri())return;const{msg:l,url:d,line:h,column:f,error:g}=n,w=function(C,_,v,E){const S=C.exception=C.exception||{},O=S.values=S.values||[],I=O[0]=O[0]||{},y=I.stacktrace=I.stacktrace||{},b=y.frames=y.frames||[],A=E,L=v,x=ke(_)&&_.length>0?_:function(){try{return Sr.document.location.href}catch{return""}}();return b.length===0&&b.push({colno:A,filename:x,function:qe,in_app:!0,lineno:L}),C}(Jr(s,g||l,void 0,a,!1),d,h,f);w.level="error",gi(w,{originalException:g,mechanism:{handled:!1,type:"onerror"}})})}(r),Gi("onerror")),e.onunhandledrejection&&(function(i){(function(n){const s="unhandledrejection";Ue(s,n),Be(s,Ea)})(n=>{const{stackParser:s,attachStacktrace:a}=Wi();if(ne()!==i||Ri())return;const l=function(h){if(wr(h))return h;try{if("reason"in h)return h.reason;if("detail"in h&&"reason"in h.detail)return h.detail.reason}catch{}return h}(n),d=wr(l)?{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(l)}`}]}}:Jr(s,l,void 0,a,!0);d.level="error",gi(d,{originalException:l,mechanism:{handled:!1,type:"onunhandledrejection"}})})}(r),Gi("onunhandledrejection"))}}};function Gi(t){Xt&&V.log(`Global Handler attached: ${t}`)}function Wi(){const t=ne();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const jc=()=>({name:"HttpContext",preprocessEvent(t){if(!Z.navigator&&!Z.location&&!Z.document)return;const e=t.request&&t.request.url||Z.location&&Z.location.href,{referrer:r}=Z.document||{},{userAgent:i}=Z.navigator||{},n={...t.request&&t.request.headers,...r&&{Referer:r},...i&&{"User-Agent":i}},s={...t.request,...e&&{url:e},headers:n};t.request=s}}),Dc=(t={})=>{const e=t.limit||5,r=t.key||"cause";return{name:"LinkedErrors",preprocessEvent(i,n,s){const a=s.getOptions();rc(Ur,a.stackParser,a.maxValueLength,r,e,i,n)}}};var Qr="new",Yi="loading",Hi="loaded",tr="joining-meeting",Ne="joined-meeting",Re="left-meeting",Oe="error",xc="blocked",Nc="off",Rc="sendable",Fc="loading",Vc="interrupted",Qi="playable",rr="unknown",Ki="full",zc="lobby",qc="none",Xi="base",Uc="*",Bc="ejected",$c="nbf-room",Jc="nbf-token",Gc="exp-room",Wc="exp-token",Kr="no-room",Yc="meeting-full",Zi="end-of-life",Hc="not-allowed",es="connection-error",Qc="cam-in-use",Kc="mic-in-use",Xc="cam-mic-in-use",Zc="permissions",el="undefined-mediadevices",tl="not-found",rl="constraints",nl="unknown",ts="iframe-ready-for-launch-config",rs="iframe-launch-config",ns="theme-updated",is="loading",ss="load-attempt-failed",Xr="loaded",os="started-camera",as="camera-error",cs="joining-meeting",ls="joined-meeting",us="left-meeting",ds="participant-joined",hs="participant-updated",ps="participant-left",fs="participant-counts-updated",ms="access-state-updated",gs="meeting-session-summary-updated",vs="meeting-session-state-updated",il="meeting-session-data-error",ys="waiting-participant-added",bs="waiting-participant-updated",_s="waiting-participant-removed",ws="track-started",Ss="track-stopped",Es="transcription-started",ks="transcription-stopped",Cs="transcription-error",Zr="recording-started",en="recording-stopped",Ts="recording-stats",As="recording-error",Os="recording-upload-completed",Ms="recording-data",Ps="app-message",Is="transcription-message",Ls="remote-media-player-started",js="remote-media-player-updated",Ds="remote-media-player-stopped",xs="local-screen-share-started",Ns="local-screen-share-stopped",Rs="local-screen-share-canceled",Fs="active-speaker-change",Vs="active-speaker-mode-change",zs="network-quality-change",qs="network-connection",Us="cpu-load-change",Bs="face-counts-updated",bt="fullscreen",_t="exited-fullscreen",$s="live-streaming-started",Js="live-streaming-updated",Gs="live-streaming-stopped",Ws="live-streaming-error",Ys="lang-updated",Hs="receive-settings-updated",tn="input-settings-updated",rn="nonfatal-error",nn="error",sn=4096,Qs=102400,on="iframe-call-message",Ks="local-screen-start",Xs="daily-method-update-live-streaming-endpoints",nr="transmit-log",Me="daily-custom-track",ir={NONE:"none",BGBLUR:"background-blur",BGIMAGE:"background-image",FACE_DETECTION:"face-detection"},Zs={NONE:"none",NOISE_CANCELLATION:"noise-cancellation"},an={PLAY:"play",PAUSE:"pause"},cn=["jpg","png","jpeg"],sl="add-endpoints",ol="remove-endpoints",eo="sip-call-transfer";function fe(){return!B()&&typeof window<"u"&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function B(){return typeof navigator<"u"&&navigator.product&&navigator.product==="ReactNative"}function to(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function al(){return!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)&&(function(t,e){if(!t||!e)return!0;switch(t){case"Chrome":return e.major>=75;case"Safari":return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")&&!(e.major===13&&e.minor===0&&e.point===0);case"Firefox":return e.major>=67}return!0}(He(),sr())||B())}function ro(){if(B()||!document)return!1;var t=document.createElement("iframe");return!!t.requestFullscreen||!!t.webkitRequestFullscreen}var ln="none",cl="software",ll="hardware",ul=function(){try{var t,e=document.createElement("canvas"),r=!1;(t=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0}))||(r=!0,t=e.getContext("webgl2"));var i=t!=null;return e.remove(),i?r?cl:ll:ln}catch{return ln}}();function no(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return!B()&&ul!==ln&&(t?function(){return ao()?!1:["Chrome","Firefox"].includes(He())}():function(){if(ao())return!1;var e=He();if(e==="Safari"){var r=dn();if(r.major<15||r.major===15&&r.minor<4)return!1}return e==="Chrome"?un().major>=77:e==="Firefox"?hn().major>=97:["Chrome","Firefox","Safari"].includes(e)}())}function io(){if(B()||oo()||typeof AudioWorkletNode>"u")return!1;switch(He()){case"Chrome":case"Firefox":return!0;case"Safari":var t=sr();return t.major>17||t.major===17&&t.minor>=4}return!1}function so(){return to()&&!function(){var t,e=He();if(!fe())return!0;switch(e){case"Chrome":return(t=un()).major&&t.major>0&&t.major<75;case"Firefox":return(t=hn()).major<91;case"Safari":return(t=dn()).major<13||t.major===13&&t.minor<1;default:return!0}}()}function oo(){return fe().match(/Linux; Android/)}function ao(){var t,e=fe(),r=e.match(/Mac/)&&(!B()&&typeof window<"u"&&(t=window)!==null&&t!==void 0&&(t=t.navigator)!==null&&t!==void 0&&t.maxTouchPoints?window.navigator.maxTouchPoints:0)>=5;return!!(e.match(/Mobi/)||e.match(/Android/)||r)||!!fe().match(/DailyAnd\//)||void 0}function He(){if(typeof window<"u"){var t=fe();return co()?"Safari":t.indexOf("Edge")>-1?"Edge":t.match(/Chrome\//)?"Chrome":t.indexOf("Safari")>-1||lo()?"Safari":t.indexOf("Firefox")>-1?"Firefox":t.indexOf("MSIE")>-1||t.indexOf(".NET")>-1?"IE":"Unknown Browser"}}function sr(){switch(He()){case"Chrome":return un();case"Safari":return dn();case"Firefox":return hn();case"Edge":return function(){var t=0,e=0;if(typeof window<"u"){var r=fe().match(/Edge\/(\d+).(\d+)/);if(r)try{t=parseInt(r[1]),e=parseInt(r[2])}catch{}}return{major:t,minor:e}}()}}function un(){var t=0,e=0,r=0,i=0,n=!1;if(typeof window<"u"){var s=fe(),a=s.match(/Chrome\/(\d+).(\d+).(\d+).(\d+)/);if(a)try{t=parseInt(a[1]),e=parseInt(a[2]),r=parseInt(a[3]),i=parseInt(a[4]),n=s.indexOf("OPR/")>-1}catch{}}return{major:t,minor:e,build:r,patch:i,opera:n}}function co(){return!!fe().match(/iPad|iPhone|iPod/i)&&to()}function lo(){return fe().indexOf("AppleWebKit/605.1.15")>-1}function dn(){var t=0,e=0,r=0;if(typeof window<"u"){var i=fe().match(/Version\/(\d+).(\d+)(.(\d+))?/);if(i)try{t=parseInt(i[1]),e=parseInt(i[2]),r=parseInt(i[4])}catch{}else(co()||lo())&&(t=14,e=0,r=3)}return{major:t,minor:e,point:r}}function hn(){var t=0,e=0;if(typeof window<"u"){var r=fe().match(/Firefox\/(\d+).(\d+)/);if(r)try{t=parseInt(r[1]),e=parseInt(r[2])}catch{}}return{major:t,minor:e}}var uo=function(){return ce(function t(){ae(this,t)},[{key:"addListenerForMessagesFromCallMachine",value:function(t,e,r){pt()}},{key:"addListenerForMessagesFromDailyJs",value:function(t,e,r){pt()}},{key:"sendMessageToCallMachine",value:function(t,e,r,i){pt()}},{key:"sendMessageToDailyJs",value:function(t,e){pt()}},{key:"removeListener",value:function(t){pt()}}])}();function ho(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function pn(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ho(Object(r),!0).forEach(function(i){_e(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ho(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function po(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(po=function(){return!!t})()}var dl=function(){function t(){var e,r,i,n;return ae(this,t),r=this,i=ge(i=t),(e=Pt(r,po()?Reflect.construct(i,[],ge(r).constructor):i.apply(r,n)))._wrappedListeners={},e._messageCallbacks={},e}return It(t,uo),ce(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,r,i){var n=this,s=function(a){if(a.data&&a.data.what==="iframe-call-message"&&(!a.data.callClientId||a.data.callClientId===r)&&(!a.data.from||a.data.from!=="module")){var l=pn({},a.data);if(delete l.from,l.callbackStamp&&n._messageCallbacks[l.callbackStamp]){var d=l.callbackStamp;n._messageCallbacks[d].call(i,l),delete n._messageCallbacks[d]}delete l.what,delete l.callbackStamp,e.call(i,l)}};this._wrappedListeners[e]=s,window.addEventListener("message",s)}},{key:"addListenerForMessagesFromDailyJs",value:function(e,r,i){var n=function(s){var a;if(!(!s.data||s.data.what!==on||!s.data.action||s.data.from&&s.data.from!=="module"||s.data.callClientId&&r&&s.data.callClientId!==r||s!=null&&(a=s.data)!==null&&a!==void 0&&a.callFrameId)){var l=s.data;e.call(i,l)}};this._wrappedListeners[e]=n,window.addEventListener("message",n)}},{key:"sendMessageToCallMachine",value:function(e,r,i,n){if(!i)throw new Error("undefined callClientId. Are you trying to use a DailyCall instance previously destroyed?");var s=pn({},e);if(s.what=on,s.from="module",s.callClientId=i,r){var a=Dt();this._messageCallbacks[a]=r,s.callbackStamp=a}var l=n?n.contentWindow:window,d=this._callMachineTargetOrigin(n);d&&l.postMessage(s,d)}},{key:"sendMessageToDailyJs",value:function(e,r){e.what=on,e.callClientId=r,e.from="embedded",window.postMessage(e,this._targetOriginFromWindowLocation())}},{key:"removeListener",value:function(e){var r=this._wrappedListeners[e];r&&(window.removeEventListener("message",r),delete this._wrappedListeners[e])}},{key:"forwardPackagedMessageToCallMachine",value:function(e,r,i){var n=pn({},e);n.callClientId=i;var s=r?r.contentWindow:window,a=this._callMachineTargetOrigin(r);a&&s.postMessage(n,a)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(e,r){var i=function(n){if(n.data&&n.data.what==="iframe-call-message"&&(!n.data.callClientId||n.data.callClientId===r)&&(!n.data.from||n.data.from!=="module")){var s=n.data;e(s)}};return this._wrappedListeners[e]=i,window.addEventListener("message",i),e}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(e){var r=this._wrappedListeners[e];r&&(window.removeEventListener("message",r),delete this._wrappedListeners[e])}},{key:"_callMachineTargetOrigin",value:function(e){return e?e.src?new URL(e.src).origin:void 0:this._targetOriginFromWindowLocation()}},{key:"_targetOriginFromWindowLocation",value:function(){return window.location.protocol==="file:"?"*":window.location.origin}}])}();function fo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function mo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mo=function(){return!!t})()}var hl=function(){function t(){var e,r,i,n;return ae(this,t),r=this,i=ge(i=t),e=Pt(r,mo()?Reflect.construct(i,[],ge(r).constructor):i.apply(r,n)),global.callMachineToDailyJsEmitter=global.callMachineToDailyJsEmitter||new fr.EventEmitter,global.dailyJsToCallMachineEmitter=global.dailyJsToCallMachineEmitter||new fr.EventEmitter,e._wrappedListeners={},e._messageCallbacks={},e}return It(t,uo),ce(t,[{key:"addListenerForMessagesFromCallMachine",value:function(e,r,i){this._addListener(e,global.callMachineToDailyJsEmitter,r,i,"received call machine message")}},{key:"addListenerForMessagesFromDailyJs",value:function(e,r,i){this._addListener(e,global.dailyJsToCallMachineEmitter,r,i,"received daily-js message")}},{key:"sendMessageToCallMachine",value:function(e,r,i){this._sendMessage(e,global.dailyJsToCallMachineEmitter,i,r,"sending message to call machine")}},{key:"sendMessageToDailyJs",value:function(e,r){this._sendMessage(e,global.callMachineToDailyJsEmitter,r,null,"sending message to daily-js")}},{key:"removeListener",value:function(e){var r=this._wrappedListeners[e];r&&(global.callMachineToDailyJsEmitter.removeListener("message",r),global.dailyJsToCallMachineEmitter.removeListener("message",r),delete this._wrappedListeners[e])}},{key:"_addListener",value:function(e,r,i,n,s){var a=this,l=function(d){if(d.callClientId===i){if(d.callbackStamp&&a._messageCallbacks[d.callbackStamp]){var h=d.callbackStamp;a._messageCallbacks[h].call(n,d),delete a._messageCallbacks[h]}e.call(n,d)}};this._wrappedListeners[e]=l,r.addListener("message",l)}},{key:"_sendMessage",value:function(e,r,i,n,s){var a=function(d){for(var h=1;h<arguments.length;h++){var f=arguments[h]!=null?arguments[h]:{};h%2?fo(Object(f),!0).forEach(function(g){_e(d,g,f[g])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(f)):fo(Object(f)).forEach(function(g){Object.defineProperty(d,g,Object.getOwnPropertyDescriptor(f,g))})}return d}({},e);if(a.callClientId=i,n){var l=Dt();this._messageCallbacks[l]=n,a.callbackStamp=l}r.emit("message",a)}}])}(),fn="replace",mn="shallow-merge",go=[fn,mn],pl=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.data,i=e.mergeStrategy,n=i===void 0?fn:i;ae(this,t),t._validateMergeStrategy(n),t._validateData(r,n),this.mergeStrategy=n,this.data=r}return ce(t,[{key:"isNoOp",value:function(){return t.isNoOpUpdate(this.data,this.mergeStrategy)}}],[{key:"isNoOpUpdate",value:function(e,r){return Object.keys(e).length===0&&r===mn}},{key:"_validateMergeStrategy",value:function(e){if(!go.includes(e))throw Error("Unrecognized mergeStrategy provided. Options are: [".concat(go,"]"))}},{key:"_validateData",value:function(e,r){if(!function(l){if(l==null||J(l)!=="object")return!1;var d=Object.getPrototypeOf(l);return d==null||d===Object.prototype}(e))throw Error("Meeting session data must be a plain (map-like) object");var i;try{if(i=JSON.stringify(e),r===fn){var n=JSON.parse(i);ie(n,e)||console.warn("The meeting session data provided will be modified when serialized.",n,e)}else if(r===mn){for(var s in e)if(Object.hasOwnProperty.call(e,s)&&e[s]!==void 0){var a=JSON.parse(JSON.stringify(e[s]));ie(e[s],a)||console.warn("At least one key in the meeting session data provided will be modified when serialized.",a,e[s])}}}catch(l){throw Error("Meeting session data must be serializable to JSON: ".concat(l))}if(i.length>Qs)throw Error("Meeting session data is too large (".concat(i.length," characters). Maximum size suppported is ").concat(Qs,"."))}}])}();function vo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vo=function(){return!!t})()}function gn(t){var e=typeof Map=="function"?new Map:void 0;return gn=function(r){if(r===null||!function(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(r))return e.get(r);e.set(r,i)}function i(){return function(n,s,a){if(vo())return Reflect.construct.apply(null,arguments);var l=[null];l.push.apply(l,s);var d=new(n.bind.apply(n,l));return a&&ht(d,a.prototype),d}(r,arguments,ge(this).constructor)}return i.prototype=Object.create(r.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),ht(i,r)},gn(t)}function yo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yo=function(){return!!t})()}function bo(t){var e,r=(e=window._daily)===null||e===void 0?void 0:e.pendings;if(r){var i=r.indexOf(t);i!==-1&&r.splice(i,1)}}var fl=function(){return ce(function t(e){ae(this,t),this._currentLoad=null,this._callClientId=e},[{key:"load",value:function(){var t,e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.loaded)return window._daily.instances[this._callClientId].callMachine.reset(),void i(!0);t=this._callClientId,window._daily.pendings.push(t),this._currentLoad&&this._currentLoad.cancel(),this._currentLoad=new ml(r,function(){i(!1)},function(s,a){a||bo(e._callClientId),n(s,a)}),this._currentLoad.start()}},{key:"cancel",value:function(){this._currentLoad&&this._currentLoad.cancel(),bo(this._callClientId)}},{key:"loaded",get:function(){return this._currentLoad&&this._currentLoad.succeeded}}])}(),ml=function(){return ce(function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;ae(this,t),this._attemptsRemaining=3,this._currentAttempt=null,this._dailyConfig=e,this._successCallback=r,this._failureCallback=i},[{key:"start",value:function(){var t=this;if(!this._currentAttempt){var e=function(r){t._currentAttempt.cancelled||(t._attemptsRemaining--,t._failureCallback(r,t._attemptsRemaining>0),t._attemptsRemaining<=0||setTimeout(function(){t._currentAttempt.cancelled||(t._currentAttempt=new _o(t._dailyConfig,t._successCallback,e),t._currentAttempt.start())},3e3))};this._currentAttempt=new _o(this._dailyConfig,this._successCallback,e),this._currentAttempt.start()}}},{key:"cancel",value:function(){this._currentAttempt&&this._currentAttempt.cancel()}},{key:"cancelled",get:function(){return this._currentAttempt&&this._currentAttempt.cancelled}},{key:"succeeded",get:function(){return this._currentAttempt&&this._currentAttempt.succeeded}}])}(),vn=function(){function t(){return ae(this,t),e=this,i=arguments,r=ge(r=t),Pt(e,yo()?Reflect.construct(r,i||[],ge(e).constructor):r.apply(e,i));var e,r,i}return It(t,gn(Error)),ce(t)}(),or=2e4,_o=function(){return ce(function e(r,i,n){ae(this,e),this._loadAttemptImpl=B()||!r.avoidEval?new gl(r,i,n):new vl(r,i,n)},[{key:"start",value:(t=R(function*(){return this._loadAttemptImpl.start()}),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(){this._loadAttemptImpl.cancel()}},{key:"cancelled",get:function(){return this._loadAttemptImpl.cancelled}},{key:"succeeded",get:function(){return this._loadAttemptImpl.succeeded}}]);var t}(),gl=function(){return ce(function n(s,a,l){ae(this,n),this.cancelled=!1,this.succeeded=!1,this._networkTimedOut=!1,this._networkTimeout=null,this._iosCache=typeof iOSCallObjectBundleCache<"u"&&iOSCallObjectBundleCache,this._refetchHeaders=null,this._dailyConfig=s,this._successCallback=a,this._failureCallback=l},[{key:"start",value:(i=R(function*(){var n=xt(this._dailyConfig);!(yield this._tryLoadFromIOSCache(n))&&this._loadFromNetwork(n)}),function(){return i.apply(this,arguments)})},{key:"cancel",value:function(){clearTimeout(this._networkTimeout),this.cancelled=!0}},{key:"_tryLoadFromIOSCache",value:(r=R(function*(n){if(!this._iosCache)return!1;try{var s=yield this._iosCache.get(n);return!!this.cancelled||!!s&&(s.code?(Function('"use strict";'+s.code)(),this.succeeded=!0,this._successCallback(),!0):(this._refetchHeaders=s.refetchHeaders,!1))}catch{return!1}}),function(n){return r.apply(this,arguments)})},{key:"_loadFromNetwork",value:(e=R(function*(n){var s=this;this._networkTimeout=setTimeout(function(){s._networkTimedOut=!0,s._failureCallback({msg:"Timed out (>".concat(or," ms) when loading call object bundle ").concat(n),type:"timeout"})},or);try{var a=this._refetchHeaders?{headers:this._refetchHeaders}:{},l=yield fetch(n,a);if(clearTimeout(this._networkTimeout),this.cancelled||this._networkTimedOut)throw new vn;var d=yield this._getBundleCodeFromResponse(n,l);if(this.cancelled)throw new vn;Function('"use strict";'+d)(),this._iosCache&&this._iosCache.set(n,d,l.headers),this.succeeded=!0,this._successCallback()}catch(h){if(clearTimeout(this._networkTimeout),h instanceof vn||this.cancelled||this._networkTimedOut)return;this._failureCallback({msg:"Failed to load call object bundle ".concat(n,": ").concat(h),type:h.message})}}),function(n){return e.apply(this,arguments)})},{key:"_getBundleCodeFromResponse",value:(t=R(function*(n,s){if(s.ok)return yield s.text();if(this._iosCache&&s.status===304)return(yield this._iosCache.renew(n,s.headers)).code;throw new Error("Received ".concat(s.status," response"))}),function(n,s){return t.apply(this,arguments)})}]);var t,e,r,i}(),vl=function(){return ce(function t(e,r,i){ae(this,t),this.cancelled=!1,this.succeeded=!1,this._dailyConfig=e,this._successCallback=r,this._failureCallback=i,this._attemptId=Dt(),this._networkTimeout=null,this._scriptElement=null},[{key:"start",value:function(){window._dailyCallMachineLoadWaitlist||(window._dailyCallMachineLoadWaitlist=new Set);var t=xt(this._dailyConfig);(typeof document>"u"?"undefined":J(document))==="object"?this._startLoading(t):this._failureCallback({msg:"Call object bundle must be loaded in a DOM/web context",type:"missing context"})}},{key:"cancel",value:function(){this._stopLoading(),this.cancelled=!0}},{key:"_startLoading",value:function(t){var e=this;this._signUpForCallMachineLoadWaitlist(),this._networkTimeout=setTimeout(function(){e._stopLoading(),e._failureCallback({msg:"Timed out (>".concat(or," ms) when loading call object bundle ").concat(t),type:"timeout"})},or);var r=document.getElementsByTagName("head")[0],i=document.createElement("script");this._scriptElement=i,i.onload=function(){e._stopLoading(),e.succeeded=!0,e._successCallback()},i.onerror=function(n){e._stopLoading(),e._failureCallback({msg:"Failed to load call object bundle ".concat(n.target.src),type:n.message})},i.src=t,r.appendChild(i)}},{key:"_stopLoading",value:function(){this._withdrawFromCallMachineLoadWaitlist(),clearTimeout(this._networkTimeout),this._scriptElement&&(this._scriptElement.onload=null,this._scriptElement.onerror=null)}},{key:"_signUpForCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.add(this._attemptId)}},{key:"_withdrawFromCallMachineLoadWaitlist",value:function(){window._dailyCallMachineLoadWaitlist.delete(this._attemptId)}}])}(),ar=function(t,e,r){return bl(t.local,e,r)===!0},yl=function(t,e,r){return t.local.streams&&t.local.streams[e]&&t.local.streams[e].stream&&t.local.streams[e].stream["get".concat(r==="video"?"Video":"Audio","Tracks")]()[0]},lt=function(t,e,r,i){var n=_l(t,e,r,i);return n&&n.pendingTrack},bl=function(t,e,r){if(!t)return!1;var i=function(s){switch(s){case"avatar":return!0;case"staged":return s;default:return!!s}},n=t.public.subscribedTracks;return n&&n[e]?["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo"].indexOf(r)===-1&&n[e].custom?[!0,"staged"].includes(n[e].custom)?i(n[e].custom):i(n[e].custom[r]):i(n[e][r]):!n||i(n.ALL)},_l=function(t,e,r,i){var n=Object.values(t.streams||{}).filter(function(s){return s.participantId===e&&s.type===r&&s.pendingTrack&&s.pendingTrack.kind===i}).sort(function(s,a){return new Date(a.starttime)-new Date(s.starttime)});return n&&n[0]},wl=function(t,e){var r=t.local.public.customTracks;if(r&&r[e])return r[e].track};function wo(t,e){for(var r=e.getState(),i=0,n=["cam","screen"];i<n.length;i++)for(var s=n[i],a=0,l=["video","audio"];a<l.length;a++){var d=l[a],h=s==="cam"?d:"screen".concat(d.charAt(0).toUpperCase()+d.slice(1)),f=t.tracks[h];if(f){var g=t.local?yl(r,s,d):lt(r,t.session_id,s,d);f.state==="playable"&&(f.track=g),f.persistentTrack=g}}}function So(t,e){try{var r=e.getState();for(var i in t.tracks)if(!Sl(i)){var n=t.tracks[i].kind;if(n){var s=t.tracks[i];if(s){var a=t.local?wl(r,i):lt(r,t.session_id,i,n);s.state==="playable"&&(t.tracks[i].track=a),s.persistentTrack=a}}else console.error("unknown type for custom track")}}catch(l){console.error(l)}}function Sl(t){return["video","audio","screenVideo","screenAudio"].includes(t)}function Eo(t,e,r){var i=r.getState();if(t.local){if(t.audio)try{t.audioTrack=i.local.streams.cam.stream.getAudioTracks()[0],t.audioTrack||(t.audio=!1)}catch{}if(t.video)try{t.videoTrack=i.local.streams.cam.stream.getVideoTracks()[0],t.videoTrack||(t.video=!1)}catch{}if(t.screen)try{t.screenVideoTrack=i.local.streams.screen.stream.getVideoTracks()[0],t.screenAudioTrack=i.local.streams.screen.stream.getAudioTracks()[0],t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch{}}else{var n=!0;try{var s=i.participants[t.session_id];s&&s.public&&s.public.rtcType&&s.public.rtcType.impl==="peer-to-peer"&&s.private&&!["connected","completed"].includes(s.private.peeringState)&&(n=!1)}catch(f){console.error(f)}if(!n)return t.audio=!1,t.audioTrack=!1,t.video=!1,t.videoTrack=!1,t.screen=!1,void(t.screenTrack=!1);try{if(i.streams,t.audio&&ar(i,t.session_id,"cam-audio")){var a=lt(i,t.session_id,"cam","audio");a&&(e&&e.audioTrack&&e.audioTrack.id===a.id?t.audioTrack=a:a.muted||(t.audioTrack=a)),t.audioTrack||(t.audio=!1)}if(t.video&&ar(i,t.session_id,"cam-video")){var l=lt(i,t.session_id,"cam","video");l&&(e&&e.videoTrack&&e.videoTrack.id===l.id?t.videoTrack=l:l.muted||(t.videoTrack=l)),t.videoTrack||(t.video=!1)}if(t.screen&&ar(i,t.session_id,"screen-audio")){var d=lt(i,t.session_id,"screen","audio");d&&(e&&e.screenAudioTrack&&e.screenAudioTrack.id===d.id?t.screenAudioTrack=d:d.muted||(t.screenAudioTrack=d))}if(t.screen&&ar(i,t.session_id,"screen-video")){var h=lt(i,t.session_id,"screen","video");h&&(e&&e.screenVideoTrack&&e.screenVideoTrack.id===h.id?t.screenVideoTrack=h:h.muted||(t.screenVideoTrack=h))}t.screenVideoTrack||t.screenAudioTrack||(t.screen=!1)}catch(f){console.error("unexpected error matching up tracks",f)}}}function El(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(d,h){if(d){if(typeof d=="string")return ko(d,h);var f={}.toString.call(d).slice(8,-1);return f==="Object"&&d.constructor&&(f=d.constructor.name),f==="Map"||f==="Set"?Array.from(d):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?ko(d,h):void 0}}(t))||e){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var d=r.next();return a=d.done,d},e:function(d){l=!0,s=d},f:function(){try{a||r.return==null||r.return()}finally{if(l)throw s}}}}function ko(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}var we=new Map,ut=null;function kl(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(d,h){if(d){if(typeof d=="string")return Co(d,h);var f={}.toString.call(d).slice(8,-1);return f==="Object"&&d.constructor&&(f=d.constructor.name),f==="Map"||f==="Set"?Array.from(d):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?Co(d,h):void 0}}(t))||e){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var d=r.next();return a=d.done,d},e:function(d){l=!0,s=d},f:function(){try{a||r.return==null||r.return()}finally{if(l)throw s}}}}function Co(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}var Se=new Map,wt=null;function Cl(t){To()?function(e){we.has(e)||(we.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(r){we.has(e)&&(we.get(e).lastDevicesString=JSON.stringify(r),ut||(ut=function(){var i=R(function*(){var n,s=yield navigator.mediaDevices.enumerateDevices(),a=El(we.keys());try{for(a.s();!(n=a.n()).done;){var l=n.value,d=JSON.stringify(s);d!==we.get(l).lastDevicesString&&(we.get(l).lastDevicesString=d,l(s))}}catch(h){a.e(h)}finally{a.f()}});return function(){return i.apply(this,arguments)}}(),navigator.mediaDevices.addEventListener("devicechange",ut)))}).catch(function(){}))}(t):function(e){Se.has(e)||(Se.set(e,{}),navigator.mediaDevices.enumerateDevices().then(function(r){Se.has(e)&&(Se.get(e).lastDevicesString=JSON.stringify(r),wt||(wt=setInterval(R(function*(){var i,n=yield navigator.mediaDevices.enumerateDevices(),s=kl(Se.keys());try{for(s.s();!(i=s.n()).done;){var a=i.value,l=JSON.stringify(n);l!==Se.get(a).lastDevicesString&&(Se.get(a).lastDevicesString=l,a(n))}}catch(d){s.e(d)}finally{s.f()}}),3e3)))}))}(t)}function Tl(t){To()?function(e){we.has(e)&&(we.delete(e),we.size===0&&ut&&(navigator.mediaDevices.removeEventListener("devicechange",ut),ut=null))}(t):function(e){Se.has(e)&&(Se.delete(e),Se.size===0&&wt&&(clearInterval(wt),wt=null))}(t)}function To(){var t;return B()||((t=navigator.mediaDevices)===null||t===void 0?void 0:t.ondevicechange)!==void 0}var Al=new Set;function Ol(t,e){return t&&t.readyState==="live"&&!function(r,i){return r.muted&&!Al.has(r.id)}(t)}function Ao(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function Fe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ao(Object(r),!0).forEach(function(i){_e(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ao(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var St=Object.freeze({VIDEO:"video",AUDIO:"audio",SCREEN_VIDEO:"screenVideo",SCREEN_AUDIO:"screenAudio",CUSTOM_VIDEO:"customVideo",CUSTOM_AUDIO:"customAudio"}),Ml=Object.freeze({PARTICIPANTS:"participants",STREAMING:"streaming",TRANSCRIPTION:"transcription"}),Et=Object.values(St),Oo=["v","a","sv","sa","cv","ca"];Object.freeze(Et.reduce(function(t,e,r){return t[e]=Oo[r],t},{})),Object.freeze(Oo.reduce(function(t,e,r){return t[e]=Et[r],t},{}));var Pl=[St.VIDEO,St.AUDIO,St.SCREEN_VIDEO,St.SCREEN_AUDIO],Mo=Object.values(Ml),Po=["p","s","t"];Object.freeze(Mo.reduce(function(t,e,r){return t[e]=Po[r],t},{})),Object.freeze(Po.reduce(function(t,e,r){return t[e]=Mo[r],t},{}));var Io=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.base,i=e.byUserId,n=e.byParticipantId;ae(this,t),this.base=r,this.byUserId=i,this.byParticipantId=n}return ce(t,[{key:"clone",value:function(){var e=new t;if(this.base instanceof te?e.base=this.base.clone():e.base=this.base,this.byUserId!==void 0)for(var r in e.byUserId={},this.byUserId){var i=this.byUserId[r];e.byUserId[r]=i instanceof te?i.clone():i}if(this.byParticipantId!==void 0)for(var n in e.byParticipantId={},this.byParticipantId){var s=this.byParticipantId[n];e.byParticipantId[n]=s instanceof te?s.clone():s}return e}},{key:"toJSONObject",value:function(){var e={};if(typeof this.base=="boolean"?e.base=this.base:this.base instanceof te&&(e.base=this.base.toJSONObject()),this.byUserId!==void 0)for(var r in e.byUserId={},this.byUserId){var i=this.byUserId[r];e.byUserId[r]=i instanceof te?i.toJSONObject():i}if(this.byParticipantId!==void 0)for(var n in e.byParticipantId={},this.byParticipantId){var s=this.byParticipantId[n];e.byParticipantId[n]=s instanceof te?s.toJSONObject():s}return e}},{key:"toMinifiedJSONObject",value:function(){var e={};if(this.base!==void 0&&(typeof this.base=="boolean"?e.b=this.base:e.b=this.base.toMinifiedJSONObject()),this.byUserId!==void 0)for(var r in e.u={},this.byUserId){var i=this.byUserId[r];e.u[r]=typeof i=="boolean"?i:i.toMinifiedJSONObject()}if(this.byParticipantId!==void 0)for(var n in e.p={},this.byParticipantId){var s=this.byParticipantId[n];e.p[n]=typeof s=="boolean"?s:s.toMinifiedJSONObject()}return e}},{key:"normalize",value:function(){return this.base instanceof te&&(this.base=this.base.normalize()),this.byUserId&&(this.byUserId=Object.fromEntries(Object.entries(this.byUserId).map(function(e){var r=re(e,2),i=r[0],n=r[1];return[i,n instanceof te?n.normalize():n]}))),this.byParticipantId&&(this.byParticipantId=Object.fromEntries(Object.entries(this.byParticipantId).map(function(e){var r=re(e,2),i=r[0],n=r[1];return[i,n instanceof te?n.normalize():n]}))),this}}],[{key:"fromJSONObject",value:function(e){var r,i,n;if(e.base!==void 0&&(r=typeof e.base=="boolean"?e.base:te.fromJSONObject(e.base)),e.byUserId!==void 0)for(var s in i={},e.byUserId){var a=e.byUserId[s];i[s]=typeof a=="boolean"?a:te.fromJSONObject(a)}if(e.byParticipantId!==void 0)for(var l in n={},e.byParticipantId){var d=e.byParticipantId[l];n[l]=typeof d=="boolean"?d:te.fromJSONObject(d)}return new t({base:r,byUserId:i,byParticipantId:n})}},{key:"fromMinifiedJSONObject",value:function(e){var r,i,n;if(e.b!==void 0&&(r=typeof e.b=="boolean"?e.b:te.fromMinifiedJSONObject(e.b)),e.u!==void 0)for(var s in i={},e.u){var a=e.u[s];i[s]=typeof a=="boolean"?a:te.fromMinifiedJSONObject(a)}if(e.p!==void 0)for(var l in n={},e.p){var d=e.p[l];n[l]=typeof d=="boolean"?d:te.fromMinifiedJSONObject(d)}return new t({base:r,byUserId:i,byParticipantId:n})}},{key:"validateJSONObject",value:function(e){if(J(e)!=="object")return[!1,"canReceive must be an object"];for(var r=["base","byUserId","byParticipantId"],i=0,n=Object.keys(e);i<n.length;i++){var s=n[i];if(!r.includes(s))return[!1,"canReceive can only contain keys (".concat(r.join(", "),")")];if(s==="base"){var a=re(te.validateJSONObject(e.base,!0),2),l=a[0],d=a[1];if(!l)return[!1,d]}else{if(J(e[s])!=="object")return[!1,"invalid (non-object) value for field '".concat(s,"' in canReceive")];for(var h=0,f=Object.values(e[s]);h<f.length;h++){var g=f[h],w=re(te.validateJSONObject(g),2),C=w[0],_=w[1];if(!C)return[!1,_]}}}return[!0]}}])}(),te=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.video,i=e.audio,n=e.screenVideo,s=e.screenAudio,a=e.customVideo,l=e.customAudio;ae(this,t),this.video=r,this.audio=i,this.screenVideo=n,this.screenAudio=s,this.customVideo=a,this.customAudio=l}return ce(t,[{key:"clone",value:function(){var e=new t;return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Fe({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Fe({},this.customAudio)),e}},{key:"toJSONObject",value:function(){var e={};return this.video!==void 0&&(e.video=this.video),this.audio!==void 0&&(e.audio=this.audio),this.screenVideo!==void 0&&(e.screenVideo=this.screenVideo),this.screenAudio!==void 0&&(e.screenAudio=this.screenAudio),this.customVideo!==void 0&&(e.customVideo=Fe({},this.customVideo)),this.customAudio!==void 0&&(e.customAudio=Fe({},this.customAudio)),e}},{key:"toMinifiedJSONObject",value:function(){var e={};return this.video!==void 0&&(e.v=this.video),this.audio!==void 0&&(e.a=this.audio),this.screenVideo!==void 0&&(e.sv=this.screenVideo),this.screenAudio!==void 0&&(e.sa=this.screenAudio),this.customVideo!==void 0&&(e.cv=Fe({},this.customVideo)),this.customAudio!==void 0&&(e.ca=Fe({},this.customAudio)),e}},{key:"normalize",value:function(){function e(r,i){return r&&Object.keys(r).length===1&&r["*"]===i}return!(this.video!==!0||this.audio!==!0||this.screenVideo!==!0||this.screenAudio!==!0||!e(this.customVideo,!0)||!e(this.customAudio,!0))||(this.video!==!1||this.audio!==!1||this.screenVideo!==!1||this.screenAudio!==!1||!e(this.customVideo,!1)||!e(this.customAudio,!1))&&this}}],[{key:"fromBoolean",value:function(e){return new t({video:e,audio:e,screenVideo:e,screenAudio:e,customVideo:{"*":e},customAudio:{"*":e}})}},{key:"fromJSONObject",value:function(e){return new t({video:e.video,audio:e.audio,screenVideo:e.screenVideo,screenAudio:e.screenAudio,customVideo:e.customVideo!==void 0?Fe({},e.customVideo):void 0,customAudio:e.customAudio!==void 0?Fe({},e.customAudio):void 0})}},{key:"fromMinifiedJSONObject",value:function(e){return new t({video:e.v,audio:e.a,screenVideo:e.sv,screenAudio:e.sa,customVideo:e.cv,customAudio:e.ca})}},{key:"validateJSONObject",value:function(e,r){if(typeof e=="boolean")return[!0];if(J(e)!=="object")return[!1,"invalid (non-object, non-boolean) value in canReceive"];for(var i=Object.keys(e),n=0,s=i;n<s.length;n++){var a=s[n];if(!Et.includes(a))return[!1,"invalid media type '".concat(a,"' in canReceive")];if(Pl.includes(a)){if(typeof e[a]!="boolean")return[!1,"invalid (non-boolean) value for media type '".concat(a,"' in canReceive")]}else{if(J(e[a])!=="object")return[!1,"invalid (non-object) value for media type '".concat(a,"' in canReceive")];for(var l=0,d=Object.values(e[a]);l<d.length;l++)if(typeof d[l]!="boolean")return[!1,"invalid (non-boolean) value for entry within '".concat(a,"' in canReceive")];if(r&&e[a]["*"]===void 0)return[!1,`canReceive "base" permission must specify "*" as an entry within '`.concat(a,"'")]}}return r&&i.length!==Et.length?[!1,'canReceive "base" permission must specify all media types: '.concat(Et.join(", ")," (or be set to a boolean shorthand)")]:[!0]}}])}(),Il=["result"],Ll=["preserveIframe"];function Lo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,i)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Lo(Object(r),!0).forEach(function(i){_e(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function jo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jo=function(){return!!t})()}function Do(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(d,h){if(d){if(typeof d=="string")return xo(d,h);var f={}.toString.call(d).slice(8,-1);return f==="Object"&&d.constructor&&(f=d.constructor.name),f==="Map"||f==="Set"?Array.from(d):f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f)?xo(d,h):void 0}}(t))||e){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(d){throw d},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,l=!1;return{s:function(){r=r.call(t)},n:function(){var d=r.next();return a=d.done,d},e:function(d){l=!0,s=d},f:function(){try{a||r.return==null||r.return()}finally{if(l)throw s}}}}function xo(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}var Qe={},No="video",jl="voice",Ro=B()?{data:{}}:{data:{},topology:"none"},Fo={present:0,hidden:0},Vo={maxBitrate:{min:1e5,max:25e5},maxFramerate:{min:1,max:30},scaleResolutionDownBy:{min:1,max:8}},yn=Object.keys(Vo),zo=["state","volume","simulcastEncodings"],qo={androidInCallNotification:{title:"string",subtitle:"string",iconName:"string",disableForCustomOverride:"boolean"},disableAutoDeviceManagement:{audio:"boolean",video:"boolean"}},cr={id:{iconPath:"string",iconPathDarkMode:"string",label:"string",tooltip:"string",visualState:"'default' | 'sidebar-open' | 'active'"}},bn={id:{allow:"string",controlledBy:"'*' | 'owners' | string[]",csp:"string",iconURL:"string",label:"string",loading:"'eager' | 'lazy'",location:"'main' | 'sidebar'",name:"string",referrerPolicy:"string",sandbox:"string",src:"string",srcdoc:"string",shared:"string[] | 'owners' | boolean"}},Ke={customIntegrations:{validate:Qo,help:Yo()},customTrayButtons:{validate:Ho,help:"customTrayButtons should be a dictionary of the type ".concat(JSON.stringify(cr))},url:{validate:function(t){return typeof t=="string"},help:"url should be a string"},baseUrl:{validate:function(t){return typeof t=="string"},help:"baseUrl should be a string"},token:{validate:function(t){return typeof t=="string"},help:"token should be a string",queryString:"t"},dailyConfig:{validate:function(t,e){try{return e.validateDailyConfig(t),!0}catch(r){console.error("Failed to validate dailyConfig",r)}return!1},help:"Unsupported dailyConfig. Check error logs for detailed info."},reactNativeConfig:{validate:function(t){return Ko(t,qo)},help:"reactNativeConfig should look like ".concat(JSON.stringify(qo),", all fields optional")},lang:{validate:function(t){return["da","de","en-us","en","es","fi","fr","it","jp","ka","nl","no","pl","pt","pt-BR","ru","sv","tr","user"].includes(t)},help:"language not supported. Options are: da, de, en-us, en, es, fi, fr, it, jp, ka, nl, no, pl, pt, pt-BR, ru, sv, tr, user"},userName:!0,userData:{validate:function(t){try{return Uo(t),!0}catch(e){return console.error(e),!1}},help:"invalid userData type provided"},startVideoOff:!0,startAudioOff:!0,allowLocalVideo:!0,allowLocalAudio:!0,activeSpeakerMode:!0,showLeaveButton:!0,showLocalVideo:!0,showParticipantsBar:!0,showFullscreenButton:!0,showUserNameChangeUI:!0,iframeStyle:!0,customLayout:!0,cssFile:!0,cssText:!0,bodyClass:!0,videoSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalVideo=t,!0;var r;if(t instanceof MediaStreamTrack)e._sharedTracks.videoTrack=t,r={customTrack:Me};else{if(delete e._sharedTracks.videoTrack,typeof t!="string")return console.error("videoSource must be a MediaStreamTrack, boolean, or a string"),!1;r={deviceId:t}}return e._updatePreloadCacheInputSettings({video:{settings:r}},!1),!0}},audioSource:{validate:function(t,e){if(typeof t=="boolean")return e._preloadCache.allowLocalAudio=t,!0;var r;if(t instanceof MediaStreamTrack)e._sharedTracks.audioTrack=t,r={customTrack:Me};else{if(delete e._sharedTracks.audioTrack,typeof t!="string")return console.error("audioSource must be a MediaStreamTrack, boolean, or a string"),!1;r={deviceId:t}}return e._updatePreloadCacheInputSettings({audio:{settings:r}},!1),!0}},subscribeToTracksAutomatically:{validate:function(t,e){return e._preloadCache.subscribeToTracksAutomatically=t,!0}},theme:{validate:function(t){var e=["accent","accentText","background","backgroundAccent","baseText","border","mainAreaBg","mainAreaBgAccent","mainAreaText","supportiveText"],r=function(i){for(var n=0,s=Object.keys(i);n<s.length;n++){var a=s[n];if(!e.includes(a))return console.error('unsupported color "'.concat(a,'". Valid colors: ').concat(e.join(", "))),!1;if(!i[a].match(/^#[0-9a-f]{6}|#[0-9a-f]{3}$/i))return console.error("".concat(a,' theme color should be provided in valid hex color format. Received: "').concat(i[a],'"')),!1}return!0};return J(t)==="object"&&("light"in t&&"dark"in t||"colors"in t)?"light"in t&&"dark"in t?"colors"in t.light?"colors"in t.dark?r(t.light.colors)&&r(t.dark.colors):(console.error('Dark theme is missing "colors" property.',t),!1):(console.error('Light theme is missing "colors" property.',t),!1):r(t.colors):(console.error('Theme must contain either both "light" and "dark" properties, or "colors".',t),!1)},help:"unsupported theme configuration. Check error logs for detailed info."},layoutConfig:{validate:function(t){if("grid"in t){var e=t.grid;if("maxTilesPerPage"in e){if(!Number.isInteger(e.maxTilesPerPage))return console.error("grid.maxTilesPerPage should be an integer. You passed ".concat(e.maxTilesPerPage,".")),!1;if(e.maxTilesPerPage>49)return console.error("grid.maxTilesPerPage can't be larger than 49 without sacrificing browser performance. Please contact us at https://www.daily.co/contact to talk about your use case."),!1}if("minTilesPerPage"in e){if(!Number.isInteger(e.minTilesPerPage))return console.error("grid.minTilesPerPage should be an integer. You passed ".concat(e.minTilesPerPage,".")),!1;if(e.minTilesPerPage<1)return console.error("grid.minTilesPerPage can't be lower than 1."),!1;if("maxTilesPerPage"in e&&e.minTilesPerPage>e.maxTilesPerPage)return console.error("grid.minTilesPerPage can't be higher than grid.maxTilesPerPage."),!1}}return!0},help:"unsupported layoutConfig. Check error logs for detailed info."},receiveSettings:{validate:function(t){return Bo(t,{allowAllParticipantsKey:!1})},help:Wo({allowAllParticipantsKey:!1})},sendSettings:{validate:function(t,e){return!!function(r,i){try{return i.validateUpdateSendSettings(r),!0}catch(n){return console.error("Failed to validate send settings",n),!1}}(t,e)&&(e._preloadCache.sendSettings=t,!0)},help:"Invalid sendSettings provided. Check error logs for detailed info."},inputSettings:{validate:function(t,e){var r;return!!$o(t)&&(e._inputSettings||(e._inputSettings={}),Jo(t,(r=e.properties)===null||r===void 0?void 0:r.dailyConfig,e._sharedTracks),e._updatePreloadCacheInputSettings(t,!0),!0)},help:Sn()},layout:{validate:function(t){return t==="custom-v1"||t==="browser"||t==="none"},help:'layout may only be set to "custom-v1"',queryString:"layout"},emb:{queryString:"emb"},embHref:{queryString:"embHref"},dailyJsVersion:{queryString:"dailyJsVersion"},proxy:{queryString:"proxy"},strictMode:!0,allowMultipleCallInstances:!0},lr={styles:{validate:function(t){for(var e in t)if(e!=="cam"&&e!=="screen")return!1;if(t.cam){for(var r in t.cam)if(r!=="div"&&r!=="video")return!1}if(t.screen){for(var i in t.screen)if(i!=="div"&&i!=="video")return!1}return!0},help:"styles format should be a subset of: { cam: {div: {}, video: {}}, screen: {div: {}, video: {}} }"},setSubscribedTracks:{validate:function(t,e){if(e._preloadCache.subscribeToTracksAutomatically)return!1;var r=[!0,!1,"staged"];if(r.includes(t)||!B()&&t==="avatar")return!0;var i=["audio","video","screenAudio","screenVideo","rmpAudio","rmpVideo"],n=function(s){var a=arguments.length>1&&arguments[1]!==void 0&&arguments[1];for(var l in s)if(l==="custom"){if(!r.includes(s[l])&&!n(s[l],!0))return!1}else{var d=!a&&!i.includes(l),h=!r.includes(s[l]);if(d||h)return!1}return!0};return n(t)},help:"setSubscribedTracks cannot be used when setSubscribeToTracksAutomatically is enabled, and should be of the form: "+"true".concat(B()?"":" | 'avatar'"," | false | 'staged' | { [audio: true|false|'staged'], [video: true|false|'staged'], [screenAudio: true|false|'staged'], [screenVideo: true|false|'staged'] }")},setAudio:!0,setVideo:!0,setScreenShare:{validate:function(t){return t===!1},help:"setScreenShare must be false, as it's only meant for stopping remote participants' screen shares"},eject:!0,updatePermissions:{validate:function(t){for(var e=0,r=Object.entries(t);e<r.length;e++){var i=re(r[e],2),n=i[0],s=i[1];switch(n){case"hasPresence":if(typeof s!="boolean")return!1;break;case"canSend":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var a,l=["video","audio","screenVideo","screenAudio","customVideo","customAudio"],d=Do(s);try{for(d.s();!(a=d.n()).done;){var h=a.value;if(!l.includes(h))return!1}}catch(S){d.e(S)}finally{d.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canSend=new Set(s));break;case"canReceive":var f=re(Io.validateJSONObject(s),2),g=f[0],w=f[1];if(!g)return console.error(w),!1;break;case"canAdmin":if(s instanceof Set||s instanceof Array||Array.isArray(s)){var C,_=["participants","streaming","transcription"],v=Do(s);try{for(v.s();!(C=v.n()).done;){var E=C.value;if(!_.includes(E))return!1}}catch(S){v.e(S)}finally{v.f()}}else if(typeof s!="boolean")return!1;(s instanceof Array||Array.isArray(s))&&(t.canAdmin=new Set(s));break;default:return!1}}return!0},help:"updatePermissions can take hasPresence, canSend, canReceive, and canAdmin permissions. hasPresence must be a boolean. canSend can be a boolean or an Array or Set of media types (video, audio, screenVideo, screenAudio, customVideo, customAudio). canReceive must be an object specifying base, byUserId, and/or byParticipantId fields (see documentation for more details). canAdmin can be a boolean or an Array or Set of admin types (participants, streaming, transcription)."}};Promise.any||(Promise.any=function(){var t=R(function*(e){return new Promise(function(r,i){var n=[];e.forEach(function(s){return Promise.resolve(s).then(function(a){r(a)}).catch(function(a){n.push(a),n.length===e.length&&i(n)})})})});return function(e){return t.apply(this,arguments)}}());var Dl=function(){function t(o){var u,c,p,m,k,M,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ae(this,t),p=this,m=ge(m=t),_e(c=Pt(p,jo()?Reflect.construct(m,[],ge(p).constructor):m.apply(p,k)),"startListeningForDeviceChanges",function(){Cl(c.handleDeviceChange)}),_e(c,"stopListeningForDeviceChanges",function(){Tl(c.handleDeviceChange)}),_e(c,"handleDeviceChange",function(z){z=z.map(function($){return JSON.parse(JSON.stringify($))}),c.emitDailyJSEvent({action:"available-devices-updated",availableDevices:z})}),_e(c,"handleNativeAppStateChange",function(){var z=R(function*($){if($==="destroyed")return console.warn("App has been destroyed before leaving the meeting. Cleaning up all the resources!"),void(yield c.destroy());var Ee=$==="active";c.disableReactNativeAutoDeviceManagement("video")||(Ee?c.camUnmutedBeforeLosingNativeActiveState&&c.setLocalVideo(!0):(c.camUnmutedBeforeLosingNativeActiveState=c.localVideo(),c.camUnmutedBeforeLosingNativeActiveState&&c.setLocalVideo(!1)))});return function($){return z.apply(this,arguments)}}()),_e(c,"handleNativeAudioFocusChange",function(z){c.disableReactNativeAutoDeviceManagement("audio")||(c._hasNativeAudioFocus=z,c.toggleParticipantAudioBasedOnNativeAudioFocus(),c._hasNativeAudioFocus?c.micUnmutedBeforeLosingNativeAudioFocus&&c.setLocalAudio(!0):(c.micUnmutedBeforeLosingNativeAudioFocus=c.localAudio(),c.setLocalAudio(!1)))}),_e(c,"handleNativeSystemScreenCaptureStop",function(){c.stopScreenShare()}),c.strictMode=P.strictMode===void 0||P.strictMode,c.allowMultipleCallInstances=(u=P.allowMultipleCallInstances)!==null&&u!==void 0&&u,Object.keys(Qe).length&&(c._logDuplicateInstanceAttempt(),!c.allowMultipleCallInstances)){if(c.strictMode)throw new Error("Duplicate DailyIframe instances are not allowed");console.warn("Using strictMode: false to allow multiple call instances is now deprecated. Set `allowMultipleCallInstances: true`")}if(window._daily||(window._daily={pendings:[],instances:{}}),c.callClientId=Dt(),Qe[(M=c).callClientId]=M,window._daily.instances[c.callClientId]={},c._sharedTracks={},window._daily.instances[c.callClientId].tracks=c._sharedTracks,P.dailyJsVersion=t.version(),c._iframe=o,c._callObjectMode=P.layout==="none"&&!c._iframe,c._preloadCache={subscribeToTracksAutomatically:!0,outputDeviceId:null,inputSettings:null,sendSettings:null,videoTrackForNetworkConnectivityTest:null,videoTrackForConnectionQualityTest:null},P.showLocalVideo!==void 0?c._callObjectMode?console.error("showLocalVideo is not available in call object mode"):c._showLocalVideo=!!P.showLocalVideo:c._showLocalVideo=!0,P.showParticipantsBar!==void 0?c._callObjectMode?console.error("showParticipantsBar is not available in call object mode"):c._showParticipantsBar=!!P.showParticipantsBar:c._showParticipantsBar=!0,P.customIntegrations!==void 0?c._callObjectMode?console.error("customIntegrations is not available in call object mode"):c._customIntegrations=P.customIntegrations:c._customIntegrations={},P.customTrayButtons!==void 0?c._callObjectMode?console.error("customTrayButtons is not available in call object mode"):c._customTrayButtons=P.customTrayButtons:c._customTrayButtons={},P.activeSpeakerMode!==void 0?c._callObjectMode?console.error("activeSpeakerMode is not available in call object mode"):c._activeSpeakerMode=!!P.activeSpeakerMode:c._activeSpeakerMode=!1,P.receiveSettings?c._callObjectMode?c._receiveSettings=P.receiveSettings:console.error("receiveSettings is only available in call object mode"):c._receiveSettings={},c.validateProperties(P),c.properties=N({},P),c._inputSettings||(c._inputSettings={}),c._callObjectLoader=c._callObjectMode?new fl(c.callClientId):null,c._callState=Qr,c._isPreparingToJoin=!1,c._accessState={access:rr},c._meetingSessionSummary={},c._finalSummaryOfPrevSession={},c._meetingSessionState=En(Ro,c._callObjectMode),c._nativeInCallAudioMode=No,c._participants={},c._isScreenSharing=!1,c._participantCounts=Fo,c._rmpPlayerState={},c._waitingParticipants={},c._network={threshold:"good",quality:100,networkState:"unknown",stats:{}},c._activeSpeaker={},c._localAudioLevel=0,c._isLocalAudioLevelObserverRunning=!1,c._remoteParticipantsAudioLevel={},c._isRemoteParticipantsAudioLevelObserverRunning=!1,c._maxAppMessageSize=sn,c._messageChannel=B()?new hl:new dl,c._iframe&&(c._iframe.requestFullscreen?c._iframe.addEventListener("fullscreenchange",function(){document.fullscreenElement===c._iframe?(c.emitDailyJSEvent({action:bt}),c.sendMessageToCallMachine({action:bt})):(c.emitDailyJSEvent({action:_t}),c.sendMessageToCallMachine({action:_t}))}):c._iframe.webkitRequestFullscreen&&c._iframe.addEventListener("webkitfullscreenchange",function(){document.webkitFullscreenElement===c._iframe?(c.emitDailyJSEvent({action:bt}),c.sendMessageToCallMachine({action:bt})):(c.emitDailyJSEvent({action:_t}),c.sendMessageToCallMachine({action:_t}))})),B()){var D=c.nativeUtils();D.addAudioFocusChangeListener&&D.removeAudioFocusChangeListener&&D.addAppStateChangeListener&&D.removeAppStateChangeListener&&D.addSystemScreenCaptureStopListener&&D.removeSystemScreenCaptureStopListener||console.warn("expected (add|remove)(AudioFocusChange|AppActiveStateChange|SystemScreenCaptureStop)Listener to be available in React Native"),c._hasNativeAudioFocus=!0,D.addAudioFocusChangeListener(c.handleNativeAudioFocusChange),D.addAppStateChangeListener(c.handleNativeAppStateChange),D.addSystemScreenCaptureStopListener(c.handleNativeSystemScreenCaptureStop)}return c._callObjectMode&&c.startListeningForDeviceChanges(),c._messageChannel.addListenerForMessagesFromCallMachine(c.handleMessageFromCallMachine,c.callClientId,c),c}return It(t,jt),ce(t,[{key:"destroy",value:(da=R(function*(){var o;try{yield this.leave()}catch{}var u=this._iframe;if(u){var c=u.parentElement;c&&c.removeChild(u)}if(this._messageChannel.removeListener(this.handleMessageFromCallMachine),B()){var p=this.nativeUtils();p.removeAudioFocusChangeListener(this.handleNativeAudioFocusChange),p.removeAppStateChangeListener(this.handleNativeAppStateChange),p.removeSystemScreenCaptureStopListener(this.handleNativeSystemScreenCaptureStop)}this._callObjectMode&&this.stopListeningForDeviceChanges(),this.resetMeetingDependentVars(),this._destroyed=!0,this.emitDailyJSEvent({action:"call-instance-destroyed"}),delete Qe[this.callClientId],!((o=window)===null||o===void 0||(o=o._daily)===null||o===void 0)&&o.instances&&delete window._daily.instances[this.callClientId],this.strictMode&&(this.callClientId=void 0)}),function(){return da.apply(this,arguments)})},{key:"isDestroyed",value:function(){return!!this._destroyed}},{key:"loadCss",value:function(o){var u=o.bodyClass,c=o.cssFile,p=o.cssText;return U(),this.sendMessageToCallMachine({action:"load-css",cssFile:this.absoluteUrl(c),bodyClass:u,cssText:p}),this}},{key:"iframe",value:function(){return U(),this._iframe}},{key:"meetingState",value:function(){return this._callState}},{key:"accessState",value:function(){return be(this._callObjectMode,"accessState()"),this._accessState}},{key:"participants",value:function(){return this._participants}},{key:"participantCounts",value:function(){return this._participantCounts}},{key:"waitingParticipants",value:function(){return be(this._callObjectMode,"waitingParticipants()"),this._waitingParticipants}},{key:"validateParticipantProperties",value:function(o,u){for(var c in u){if(!lr[c])throw new Error("unrecognized updateParticipant property ".concat(c));if(lr[c].validate&&!lr[c].validate(u[c],this,this._participants[o]))throw new Error(lr[c].help)}}},{key:"updateParticipant",value:function(o,u){return this._participants.local&&this._participants.local.session_id===o&&(o="local"),o&&u&&(this.validateParticipantProperties(o,u),this.sendMessageToCallMachine({action:"update-participant",id:o,properties:u})),this}},{key:"updateParticipants",value:function(o){var u=this._participants.local&&this._participants.local.session_id;for(var c in o)c===u&&(c="local"),c&&o[c]&&this.validateParticipantProperties(c,o[c]);return this.sendMessageToCallMachine({action:"update-participants",participants:o}),this}},{key:"updateWaitingParticipant",value:(ua=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(be(this._callObjectMode,"updateWaitingParticipant()"),Y(this._callState,"updateWaitingParticipant()"),typeof u!="string"||J(c)!=="object")throw new Error("updateWaitingParticipant() must take an id string and a updates object");return new Promise(function(p,m){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participant",id:u,updates:c},function(k){k.error&&m(k.error),k.id||m(new Error("unknown error in updateWaitingParticipant()")),p({id:k.id})})})}),function(){return ua.apply(this,arguments)})},{key:"updateWaitingParticipants",value:(la=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(be(this._callObjectMode,"updateWaitingParticipants()"),Y(this._callState,"updateWaitingParticipants()"),J(u)!=="object")throw new Error("updateWaitingParticipants() must take a mapping between ids and update objects");return new Promise(function(c,p){o.sendMessageToCallMachine({action:"daily-method-update-waiting-participants",updatesById:u},function(m){m.error&&p(m.error),m.ids||p(new Error("unknown error in updateWaitingParticipants()")),c({ids:m.ids})})})}),function(){return la.apply(this,arguments)})},{key:"requestAccess",value:(ca=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},c=u.access,p=c===void 0?{level:Ki}:c,m=u.name,k=m===void 0?"":m;return be(this._callObjectMode,"requestAccess()"),Y(this._callState,"requestAccess()"),new Promise(function(M,P){o.sendMessageToCallMachine({action:"daily-method-request-access",access:p,name:k},function(D){D.error&&P(D.error),D.access||P(new Error("unknown error in requestAccess()")),M({access:D.access,granted:D.granted})})})}),function(){return ca.apply(this,arguments)})},{key:"localAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.audio.state):null}},{key:"localVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.video.state):null}},{key:"setLocalAudio",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"forceDiscardTrack"in u&&(B()?(console.warn("forceDiscardTrack option not supported in React Native; ignoring"),u={}):o&&(console.warn("forceDiscardTrack option only supported when calling setLocalAudio(false); ignoring"),u={})),this.sendMessageToCallMachine({action:"local-audio",state:o,options:u}),this}},{key:"localScreenAudio",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenAudio.state):null}},{key:"localScreenVideo",value:function(){return this._participants.local?!["blocked","off"].includes(this._participants.local.tracks.screenVideo.state):null}},{key:"updateScreenShare",value:function(o){if(this._isScreenSharing)return this.sendMessageToCallMachine({action:"local-screen-update",options:o}),this;console.warn("There is no screen share in progress. Try calling startScreenShare first.")}},{key:"setLocalVideo",value:function(o){return this.sendMessageToCallMachine({action:"local-video",state:o}),this}},{key:"_setAllowLocalAudio",value:function(o){if(this._preloadCache.allowLocalAudio=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-audio",state:o}),this}},{key:"_setAllowLocalVideo",value:function(o){if(this._preloadCache.allowLocalVideo=o,this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-allow-local-video",state:o}),this}},{key:"getReceiveSettings",value:(aa=R(function*(o){var u=this,c=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).showInheritedValues,p=c!==void 0&&c;if(be(this._callObjectMode,"getReceiveSettings()"),!this._callMachineInitialized)return this._receiveSettings;switch(J(o)){case"string":return new Promise(function(m){u.sendMessageToCallMachine({action:"get-single-participant-receive-settings",id:o,showInheritedValues:p},function(k){m(k.receiveSettings)})});case"undefined":return this._receiveSettings;default:throw new Error('first argument to getReceiveSettings() must be a participant id (or "base"), or there should be no arguments')}}),function(o){return aa.apply(this,arguments)})},{key:"updateReceiveSettings",value:(oa=R(function*(o){var u=this;if(be(this._callObjectMode,"updateReceiveSettings()"),!Bo(o,{allowAllParticipantsKey:!0}))throw new Error(Wo({allowAllParticipantsKey:!0}));return Y(this._callState,"updateReceiveSettings()","To specify receive settings earlier, use the receiveSettings config property."),new Promise(function(c){u.sendMessageToCallMachine({action:"update-receive-settings",receiveSettings:o},function(p){c({receiveSettings:p.receiveSettings})})})}),function(o){return oa.apply(this,arguments)})},{key:"_prepInputSettingsForSharing",value:function(o,u){if(o){var c={};if(o.audio){var p,m,k;o.audio.settings&&(!Object.keys(o.audio.settings).length&&u||(c.audio={settings:N({},o.audio.settings)})),u&&(p=c.audio)!==null&&p!==void 0&&(p=p.settings)!==null&&p!==void 0&&p.customTrack&&(c.audio.settings={customTrack:this._sharedTracks.audioTrack});var M=((m=o.audio.processor)===null||m===void 0?void 0:m.type)==="none"&&((k=o.audio.processor)===null||k===void 0?void 0:k._isDefaultWhenNone);if(o.audio.processor&&!M){var P=N({},o.audio.processor);delete P._isDefaultWhenNone,c.audio=N(N({},c.audio),{},{processor:P})}}if(o.video){var D,z,$;o.video.settings&&(!Object.keys(o.video.settings).length&&u||(c.video={settings:N({},o.video.settings)})),u&&(D=c.video)!==null&&D!==void 0&&(D=D.settings)!==null&&D!==void 0&&D.customTrack&&(c.video.settings={customTrack:this._sharedTracks.videoTrack});var Ee=((z=o.video.processor)===null||z===void 0?void 0:z.type)==="none"&&(($=o.video.processor)===null||$===void 0?void 0:$._isDefaultWhenNone);if(o.video.processor&&!Ee){var Ze=N({},o.video.processor);delete Ze._isDefaultWhenNone,c.video=N(N({},c.video),{},{processor:Ze})}}return c}}},{key:"getInputSettings",value:function(){var o=this;return U(),new Promise(function(u){u(o._getInputSettings())})}},{key:"_getInputSettings",value:function(){var o,u,c,p,m,k,M={processor:{type:"none",_isDefaultWhenNone:!0}};this._inputSettings?(o=((c=this._inputSettings)===null||c===void 0?void 0:c.video)||M,u=((p=this._inputSettings)===null||p===void 0?void 0:p.audio)||M):(o=((m=this._preloadCache)===null||m===void 0||(m=m.inputSettings)===null||m===void 0?void 0:m.video)||M,u=((k=this._preloadCache)===null||k===void 0||(k=k.inputSettings)===null||k===void 0?void 0:k.audio)||M);var P={audio:u,video:o};return this._prepInputSettingsForSharing(P,!0)}},{key:"_updatePreloadCacheInputSettings",value:function(o,u){var c=this._inputSettings||{},p={};if(o.video){var m,k,M;p.video={},o.video.settings?(p.video.settings={},u||o.video.settings.customTrack||(M=c.video)===null||M===void 0||!M.settings?p.video.settings=o.video.settings:p.video.settings=N(N({},c.video.settings),o.video.settings),Object.keys(p.video.settings).length||delete p.video.settings):(m=c.video)!==null&&m!==void 0&&m.settings&&(p.video.settings=c.video.settings),o.video.processor?p.video.processor=o.video.processor:(k=c.video)!==null&&k!==void 0&&k.processor&&(p.video.processor=c.video.processor)}else c.video&&(p.video=c.video);if(o.audio){var P,D,z;p.audio={},o.audio.settings?(p.audio.settings={},u||o.audio.settings.customTrack||(z=c.audio)===null||z===void 0||!z.settings?p.audio.settings=o.audio.settings:p.audio.settings=N(N({},c.audio.settings),o.audio.settings),Object.keys(p.audio.settings).length||delete p.audio.settings):(P=c.audio)!==null&&P!==void 0&&P.settings&&(p.audio.settings=c.audio.settings),o.audio.processor?p.audio.processor=o.audio.processor:(D=c.audio)!==null&&D!==void 0&&D.processor&&(p.audio.processor=c.audio.processor)}else c.audio&&(p.audio=c.audio);this._maybeUpdateInputSettings(p)}},{key:"_devicesFromInputSettings",value:function(o){var u,c,p=(o==null||(u=o.video)===null||u===void 0||(u=u.settings)===null||u===void 0?void 0:u.deviceId)||null,m=(o==null||(c=o.audio)===null||c===void 0||(c=c.settings)===null||c===void 0?void 0:c.deviceId)||null,k=this._preloadCache.outputDeviceId||null;return{camera:p?{deviceId:p}:{},mic:m?{deviceId:m}:{},speaker:k?{deviceId:k}:{}}}},{key:"updateInputSettings",value:(sa=R(function*(o){var u=this;return U(),$o(o)?o.video||o.audio?(Jo(o,this.properties.dailyConfig,this._sharedTracks),this._callObjectMode&&!this._callMachineInitialized?(this._updatePreloadCacheInputSettings(o,!0),this._getInputSettings()):new Promise(function(c,p){u.sendMessageToCallMachine({action:"update-input-settings",inputSettings:o},function(m){if(m.error)p(m.error);else{if(m.returnPreloadCache)return u._updatePreloadCacheInputSettings(o,!0),void c(u._getInputSettings());u._maybeUpdateInputSettings(m.inputSettings),c(u._prepInputSettingsForSharing(m.inputSettings,!0))}})})):this._getInputSettings():(console.error(Sn()),Promise.reject(Sn()))}),function(o){return sa.apply(this,arguments)})},{key:"setBandwidth",value:function(o){var u=o.kbs,c=o.trackConstraints;if(U(),this._callMachineInitialized)return this.sendMessageToCallMachine({action:"set-bandwidth",kbs:u,trackConstraints:c}),this}},{key:"getDailyLang",value:function(){var o=this;if(U(),this._callMachineInitialized)return new Promise(function(u){o.sendMessageToCallMachine({action:"get-daily-lang"},function(c){delete c.action,delete c.callbackStamp,u(c)})})}},{key:"setDailyLang",value:function(o){return U(),this.sendMessageToCallMachine({action:"set-daily-lang",lang:o}),this}},{key:"setProxyUrl",value:function(o){return this.sendMessageToCallMachine({action:"set-proxy-url",proxyUrl:o}),this}},{key:"setIceConfig",value:function(o){return this.sendMessageToCallMachine({action:"set-ice-config",iceConfig:o}),this}},{key:"meetingSessionSummary",value:function(){return[Re,Oe].includes(this._callState)?this._finalSummaryOfPrevSession:this._meetingSessionSummary}},{key:"getMeetingSession",value:(Xe=R(function*(){var o=this;return console.warn("getMeetingSession() is deprecated: use meetingSessionSummary(), which will return immediately"),Y(this._callState,"getMeetingSession()"),new Promise(function(u){o.sendMessageToCallMachine({action:"get-meeting-session"},function(c){delete c.action,delete c.callbackStamp,u(c)})})}),function(){return Xe.apply(this,arguments)})},{key:"meetingSessionState",value:function(){return Y(this._callState,"meetingSessionState"),this._meetingSessionState}},{key:"setMeetingSessionData",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"replace";be(this._callObjectMode,"setMeetingSessionData()"),Y(this._callState,"setMeetingSessionData");try{(function(c,p){new pl({data:c,mergeStrategy:p})})(o,u)}catch(c){throw console.error(c),c}try{this.sendMessageToCallMachine({action:"set-session-data",data:o,mergeStrategy:u})}catch(c){throw new Error("Error setting meeting session data: ".concat(c))}}},{key:"setUserName",value:function(o,u){var c=this;return this.properties.userName=o,new Promise(function(p){c.sendMessageToCallMachine({action:"set-user-name",name:o??"",thisMeetingOnly:B()||!!u&&!!u.thisMeetingOnly},function(m){delete m.action,delete m.callbackStamp,p(m)})})}},{key:"setUserData",value:(Ie=R(function*(o){var u=this;try{Uo(o)}catch(c){throw console.error(c),c}if(this.properties.userData=o,this._callMachineInitialized)return new Promise(function(c){try{u.sendMessageToCallMachine({action:"set-user-data",userData:o},function(p){delete p.action,delete p.callbackStamp,c(p)})}catch(p){throw new Error("Error setting user data: ".concat(p))}})}),function(o){return Ie.apply(this,arguments)})},{key:"validateAudioLevelInterval",value:function(o){if(o&&(o<100||typeof o!="number"))throw new Error("The interval must be a number greater than or equal to 100 milliseconds.")}},{key:"startLocalAudioLevelObserver",value:function(o){var u=this;if(typeof AudioWorkletNode>"u"&&!B())throw new Error("startLocalAudioLevelObserver() is not supported on this browser");if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isLocalAudioLevelObserverRunning=!0,new Promise(function(c,p){u.sendMessageToCallMachine({action:"start-local-audio-level-observer",interval:o},function(m){u._isLocalAudioLevelObserverRunning=!m.error,m.error?p({error:m.error}):c()})});this._preloadCache.localAudioLevelObserver={enabled:!0,interval:o}}},{key:"isLocalAudioLevelObserverRunning",value:function(){return this._isLocalAudioLevelObserverRunning}},{key:"stopLocalAudioLevelObserver",value:function(){this._preloadCache.localAudioLevelObserver=null,this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-local-audio-level-observer"})}},{key:"startRemoteParticipantsAudioLevelObserver",value:function(o){var u=this;if(this.validateAudioLevelInterval(o),this._callMachineInitialized)return this._isRemoteParticipantsAudioLevelObserverRunning=!0,new Promise(function(c,p){u.sendMessageToCallMachine({action:"start-remote-participants-audio-level-observer",interval:o},function(m){u._isRemoteParticipantsAudioLevelObserverRunning=!m.error,m.error?p({error:m.error}):c()})});this._preloadCache.remoteParticipantsAudioLevelObserver={enabled:!0,interval:o}}},{key:"isRemoteParticipantsAudioLevelObserverRunning",value:function(){return this._isRemoteParticipantsAudioLevelObserverRunning}},{key:"stopRemoteParticipantsAudioLevelObserver",value:function(){this._preloadCache.remoteParticipantsAudioLevelObserver=null,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this.sendMessageToCallMachine({action:"stop-remote-participants-audio-level-observer"})}},{key:"startCamera",value:(X=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(be(this._callObjectMode,"startCamera()"),_n(this._callState,this._isPreparingToJoin,"startCamera()","Did you mean to use setLocalAudio() and/or setLocalVideo() instead?"),this.needsLoad())try{yield this.load(u)}catch(c){return Promise.reject(c)}else{if(this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in startCamera() is different than the one used in preAuth()"),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in startCamera() is different than the one used in preAuth()"),Promise.reject()}this.validateProperties(u),this.properties=N(N({},this.properties),u)}return new Promise(function(c){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"start-camera",properties:dt(o.properties,o.callClientId),preloadCache:dt(o._preloadCache,o.callClientId)},function(p){c({camera:p.camera,mic:p.mic,speaker:p.speaker})})})}),function(){return X.apply(this,arguments)})},{key:"validateCustomTrack",value:function(o,u,c){if(c&&c.length>50)throw new Error("Custom track `trackName` must not be more than 50 characters");if(u&&u!=="music"&&u!=="speech"&&!(u instanceof Object))throw new Error("Custom track `mode` must be either `music` | `speech` | `DailyMicAudioModeSettings` or `undefined`");if(c&&["cam-audio","cam-video","screen-video","screen-audio","rmpAudio","rmpVideo","customVideoDefaults"].includes(c))throw new Error("Custom track `trackName` must not match a track name already used by daily: cam-audio, cam-video, customVideoDefaults, screen-video, screen-audio, rmpAudio, rmpVideo");if(!(o instanceof MediaStreamTrack))throw new Error("Custom tracks provided must be instances of MediaStreamTrack")}},{key:"startCustomTrack",value:function(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{track,mode,trackName};return U(),Y(this._callState,"startCustomTrack()"),this.validateCustomTrack(u.track,u.mode,u.trackName),new Promise(function(c,p){o._sharedTracks.customTrack=u.track,u.track=Me,o.sendMessageToCallMachine({action:"start-custom-track",properties:u},function(m){m.error?p({error:m.error}):c(m.mediaTag)})})}},{key:"stopCustomTrack",value:function(o){var u=this;return U(),Y(this._callState,"stopCustomTrack()"),new Promise(function(c){u.sendMessageToCallMachine({action:"stop-custom-track",mediaTag:o},function(p){c(p.mediaTag)})})}},{key:"setCamera",value:function(o){var u=this;return kt(),dr(this._callMachineInitialized,"setCamera()"),new Promise(function(c){u.sendMessageToCallMachine({action:"set-camera",cameraDeviceId:o},function(p){c({device:p.device})})})}},{key:"setAudioDevice",value:(j=R(function*(o){return kt(),this.nativeUtils().setAudioDevice(o),{deviceId:yield this.nativeUtils().getAudioDevice()}}),function(o){return j.apply(this,arguments)})},{key:"cycleCamera",value:function(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return new Promise(function(c){o.sendMessageToCallMachine({action:"cycle-camera",properties:u},function(p){c({device:p.device})})})}},{key:"cycleMic",value:function(){var o=this;return U(),new Promise(function(u){o.sendMessageToCallMachine({action:"cycle-mic"},function(c){u({device:c.device})})})}},{key:"getCameraFacingMode",value:function(){var o=this;return kt(),new Promise(function(u){o.sendMessageToCallMachine({action:"get-camera-facing-mode"},function(c){u(c.facingMode)})})}},{key:"setInputDevicesAsync",value:(K=R(function*(o){var u=this,c=o.audioDeviceId,p=o.videoDeviceId,m=o.audioSource,k=o.videoSource;if(U(),m!==void 0&&(c=m),k!==void 0&&(p=k),typeof c=="boolean"&&(this._setAllowLocalAudio(c),c=void 0),typeof p=="boolean"&&(this._setAllowLocalVideo(p),p=void 0),!c&&!p)return yield this.getInputDevices();var M={};return c&&(c instanceof MediaStreamTrack?(this._sharedTracks.audioTrack=c,c=Me,M.audio={settings:{customTrack:c}}):(delete this._sharedTracks.audioTrack,M.audio={settings:{deviceId:c}})),p&&(p instanceof MediaStreamTrack?(this._sharedTracks.videoTrack=p,p=Me,M.video={settings:{customTrack:p}}):(delete this._sharedTracks.videoTrack,M.video={settings:{deviceId:p}})),this._callObjectMode&&this.needsLoad()?(this._updatePreloadCacheInputSettings(M,!1),this._devicesFromInputSettings(this._inputSettings)):new Promise(function(P){u.sendMessageToCallMachine({action:"set-input-devices",audioDeviceId:c,videoDeviceId:p},function(D){if(delete D.action,delete D.callbackStamp,D.returnPreloadCache)return u._updatePreloadCacheInputSettings(M,!1),void P(u._devicesFromInputSettings(u._inputSettings));P(D)})})}),function(o){return K.apply(this,arguments)})},{key:"setOutputDeviceAsync",value:(F=R(function*(o){var u=this,c=o.outputDeviceId;return U(),c&&(this._preloadCache.outputDeviceId=c),this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(p){u.sendMessageToCallMachine({action:"set-output-device",outputDeviceId:c},function(m){delete m.action,delete m.callbackStamp,m.returnPreloadCache?p(u._devicesFromInputSettings(u._inputSettings)):p(m)})})}),function(o){return F.apply(this,arguments)})},{key:"getInputDevices",value:(q=R(function*(){var o=this;return this._callObjectMode&&this.needsLoad()?this._devicesFromInputSettings(this._inputSettings):new Promise(function(u){o.sendMessageToCallMachine({action:"get-input-devices"},function(c){c.returnPreloadCache?u(o._devicesFromInputSettings(o._inputSettings)):u({camera:c.camera,mic:c.mic,speaker:c.speaker})})})}),function(){return q.apply(this,arguments)})},{key:"nativeInCallAudioMode",value:function(){return kt(),this._nativeInCallAudioMode}},{key:"setNativeInCallAudioMode",value:function(o){if(kt(),[No,jl].includes(o)){if(o!==this._nativeInCallAudioMode)return this._nativeInCallAudioMode=o,!this.disableReactNativeAutoDeviceManagement("audio")&&ur(this._callState,this._isPreparingToJoin)&&this.nativeUtils().setAudioMode(this._nativeInCallAudioMode),this}else console.error("invalid in-call audio mode specified: ",o)}},{key:"preAuth",value:(x=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(be(this._callObjectMode,"preAuth()"),_n(this._callState,this._isPreparingToJoin,"preAuth()"),this.needsLoad()&&(yield this.load(u)),!u.url)throw new Error("preAuth() requires at least a url to be provided");return this.validateProperties(u),this.properties=N(N({},this.properties),u),new Promise(function(c,p){o._preloadCache.inputSettings=o._prepInputSettingsForSharing(o._inputSettings,!1),o.sendMessageToCallMachine({action:"daily-method-preauth",properties:dt(o.properties,o.callClientId),preloadCache:dt(o._preloadCache,o.callClientId)},function(m){return m.error?p(m.error):m.access?(o._didPreAuth=!0,void c({access:m.access})):p(new Error("unknown error in preAuth()"))})})}),function(){return x.apply(this,arguments)})},{key:"load",value:(L=R(function*(o){var u=this;if(this.needsLoad()){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");if(o&&(this.validateProperties(o),this.properties=N(N({},this.properties),o)),!this._callObjectMode&&!this.properties.url)throw new Error("can't load iframe meeting because url property isn't set");return this._updateCallState(Yi),this.emitDailyJSEvent({action:is}),this._callObjectMode?new Promise(function(c,p){u._callObjectLoader.cancel();var m=Date.now();u._callObjectLoader.load(u.properties.dailyConfig,function(k){u._bundleLoadTime=k?"no-op":Date.now()-m,u._updateCallState(Hi),k&&u.emitDailyJSEvent({action:Xr}),c()},function(k,M){if(u.emitDailyJSEvent({action:ss}),!M){u._updateCallState(Oe),u.resetMeetingDependentVars();var P={action:nn,errorMsg:k.msg,error:{type:"connection-error",msg:"Failed to load call object bundle.",details:{on:"load",sourceError:k,bundleUrl:xt(u.properties.dailyConfig)}}};u._maybeSendToSentry(P),u.emitDailyJSEvent(P),p(k.msg)}})}):(this._iframe.src=xn(this.assembleMeetingUrl(),this.properties.dailyConfig),new Promise(function(c,p){u._loadedCallback=function(m){u._callState!==Oe?(u._updateCallState(Hi),(u.properties.cssFile||u.properties.cssText)&&u.loadCss(u.properties),c()):p(m)}}))}}),function(o){return L.apply(this,arguments)})},{key:"join",value:(A=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._testCallInProgress&&this.stopTestCallQuality();var c=!1;if(this.needsLoad()){this.updateIsPreparingToJoin(!0);try{yield this.load(u)}catch(p){return this.updateIsPreparingToJoin(!1),Promise.reject(p)}}else{if(c=!(!this.properties.cssFile&&!this.properties.cssText),this._didPreAuth){if(u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject();if(u.token&&u.token!==this.properties.token)return console.error("token in join() is different than the one used in preAuth()"),this.updateIsPreparingToJoin(!1),Promise.reject()}if(u.url&&!this._callObjectMode&&u.url&&u.url!==this.properties.url)return console.error("url in join() is different than the one used in load() (".concat(this.properties.url," -> ").concat(u.url,")")),this.updateIsPreparingToJoin(!1),Promise.reject();this.validateProperties(u),this.properties=N(N({},this.properties),u)}return u.showLocalVideo!==void 0&&(this._callObjectMode?console.error("showLocalVideo is not available in callObject mode"):this._showLocalVideo=!!u.showLocalVideo),u.showParticipantsBar!==void 0&&(this._callObjectMode?console.error("showParticipantsBar is not available in callObject mode"):this._showParticipantsBar=!!u.showParticipantsBar),this._callState===Ne||this._callState===tr?(console.warn("already joined meeting, call leave() before joining again"),void this.updateIsPreparingToJoin(!1)):(this._updateCallState(tr,!1),this.emitDailyJSEvent({action:cs}),this._preloadCache.inputSettings=this._prepInputSettingsForSharing(this._inputSettings||{},!1),this.sendMessageToCallMachine({action:"join-meeting",properties:dt(this.properties,this.callClientId),preloadCache:dt(this._preloadCache,this.callClientId)}),new Promise(function(p,m){o._joinedCallback=function(k,M){if(o._callState!==Oe){if(o._updateCallState(Ne),k)for(var P in k){if(o._callObjectMode){var D=o._callMachine().store;wo(k[P],D),So(k[P],D),Eo(k[P],o._participants[P],D)}o._participants[P]=N({},k[P]),o.toggleParticipantAudioBasedOnNativeAudioFocus()}c&&o.loadCss(o.properties),p(k)}else m(M)}}))}),function(){return A.apply(this,arguments)})},{key:"leave",value:(b=R(function*(){var o=this;return this._testCallInProgress&&this.stopTestCallQuality(),new Promise(function(u){o._callState===Re||o._callState===Oe?u():o._callObjectLoader&&!o._callObjectLoader.loaded?(o._callObjectLoader.cancel(),o._updateCallState(Re),o.resetMeetingDependentVars(),o.emitDailyJSEvent({action:Re}),u()):(o._resolveLeave=u,o.sendMessageToCallMachine({action:"leave-meeting"}))})}),function(){return b.apply(this,arguments)})},{key:"startScreenShare",value:(y=R(function*(){var o=this,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(dr(this._callMachineInitialized,"startScreenShare()"),u.screenVideoSendSettings&&this._validateVideoSendSettings("screenVideo",u.screenVideoSendSettings),u.mediaStream&&(this._sharedTracks.screenMediaStream=u.mediaStream,u.mediaStream=Me),typeof DailyNativeUtils<"u"&&DailyNativeUtils.isIOS!==void 0&&DailyNativeUtils.isIOS){var c=this.nativeUtils();if(yield c.isScreenBeingCaptured())return void this.emitDailyJSEvent({action:rn,type:"screen-share-error",errorMsg:"Could not start the screen sharing. The screen is already been captured!"});c.setSystemScreenCaptureStartCallback(function(){c.setSystemScreenCaptureStartCallback(null),o.sendMessageToCallMachine({action:Ks,captureOptions:u})}),c.presentSystemScreenCapturePrompt()}else this.sendMessageToCallMachine({action:Ks,captureOptions:u})}),function(){return y.apply(this,arguments)})},{key:"stopScreenShare",value:function(){dr(this._callMachineInitialized,"stopScreenShare()"),this.sendMessageToCallMachine({action:"local-screen-stop"})}},{key:"startRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=o.type;if(u&&u!=="cloud"&&u!=="raw-tracks"&&u!=="local")throw new Error("invalid type: ".concat(u,", allowed values 'cloud', 'raw-tracks', or 'local'"));this.sendMessageToCallMachine(N({action:"local-recording-start"},o))}},{key:"updateRecording",value:function(o){var u=o.layout,c=u===void 0?{preset:"default"}:u,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-recording",layout:c,instanceId:p})}},{key:"stopRecording",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(N({action:"local-recording-stop"},o))}},{key:"startLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(N({action:"daily-method-start-live-streaming"},o))}},{key:"updateLiveStreaming",value:function(o){var u=o.layout,c=u===void 0?{preset:"default"}:u,p=o.instanceId;this.sendMessageToCallMachine({action:"daily-method-update-live-streaming",layout:c,instanceId:p})}},{key:"addLiveStreamingEndpoints",value:function(o){var u=o.endpoints,c=o.instanceId;this.sendMessageToCallMachine({action:Xs,endpointsOp:sl,endpoints:u,instanceId:c})}},{key:"removeLiveStreamingEndpoints",value:function(o){var u=o.endpoints,c=o.instanceId;this.sendMessageToCallMachine({action:Xs,endpointsOp:ol,endpoints:u,instanceId:c})}},{key:"stopLiveStreaming",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.sendMessageToCallMachine(N({action:"daily-method-stop-live-streaming"},o))}},{key:"validateDailyConfig",value:function(o){o.camSimulcastEncodings&&(console.warn("camSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide camera simulcast settings."),this.validateSimulcastEncodings(o.camSimulcastEncodings)),o.screenSimulcastEncodings&&console.warn("screenSimulcastEncodings is deprecated. Use sendSettings, found in DailyCallOptions, to provide screen simulcast settings."),oo()&&o.noAutoDefaultDeviceChange&&console.warn("noAutoDefaultDeviceChange is not supported on Android, and will be ignored.")}},{key:"validateSimulcastEncodings",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(o){if(!(o instanceof Array||Array.isArray(o)))throw new Error("encodings must be an Array");if(!ea(o.length,1,3))throw new Error("encodings must be an Array with between 1 to ".concat(3," layers"));for(var p=0;p<o.length;p++){var m=o[p];for(var k in this._validateEncodingLayerHasValidProperties(m),m)if(yn.includes(k)){if(typeof m[k]!="number")throw new Error("".concat(k," must be a number"));if(u){var M=u[k],P=M.min,D=M.max;if(!ea(m[k],P,D))throw new Error("".concat(k," value not in range. valid range: ").concat(P," to ").concat(D))}}else if(!["active","scalabilityMode"].includes(k))throw new Error("Invalid key ".concat(k,", valid keys are:")+Object.values(yn));if(c&&!m.hasOwnProperty("maxBitrate"))throw new Error("maxBitrate is not specified")}}}},{key:"startRemoteMediaPlayer",value:(I=R(function*(o){var u=this,c=o.url,p=o.settings,m=p===void 0?{state:an.PLAY}:p;try{(function(k){if(typeof k!="string")throw new Error('url parameter must be "string" type')})(c),Zo(m),function(k){for(var M in k)if(!zo.includes(M))throw new Error("Invalid key ".concat(M,", valid keys are: ").concat(zo));k.simulcastEncodings&&this.validateSimulcastEncodings(k.simulcastEncodings,Vo,!0)}(m)}catch(k){throw console.error("invalid argument Error: ".concat(k)),console.error(`startRemoteMediaPlayer arguments must be of the form:
  { url: "playback url",
  settings?:
  {state: "play"|"pause", simulcastEncodings?: [{}] } }`),k}return new Promise(function(k,M){u.sendMessageToCallMachine({action:"daily-method-start-remote-media-player",url:c,settings:m},function(P){P.error?M({error:P.error,errorMsg:P.errorMsg}):k({session_id:P.session_id,remoteMediaPlayerState:{state:P.state,settings:P.settings}})})})}),function(o){return I.apply(this,arguments)})},{key:"stopRemoteMediaPlayer",value:(O=R(function*(o){var u=this;if(typeof o!="string")throw new Error(" remotePlayerID must be of type string");return new Promise(function(c,p){u.sendMessageToCallMachine({action:"daily-method-stop-remote-media-player",session_id:o},function(m){m.error?p({error:m.error,errorMsg:m.errorMsg}):c()})})}),function(o){return O.apply(this,arguments)})},{key:"updateRemoteMediaPlayer",value:(S=R(function*(o){var u=this,c=o.session_id,p=o.settings;try{Zo(p)}catch(m){throw console.error("invalid argument Error: ".concat(m)),console.error(`updateRemoteMediaPlayer arguments must be of the form:
  session_id: "participant session",
  { settings?: {state: "play"|"pause"} }`),m}return new Promise(function(m,k){u.sendMessageToCallMachine({action:"daily-method-update-remote-media-player",session_id:c,settings:p},function(M){M.error?k({error:M.error,errorMsg:M.errorMsg}):m({session_id:M.session_id,remoteMediaPlayerState:{state:M.state,settings:M.settings}})})})}),function(o){return S.apply(this,arguments)})},{key:"startTranscription",value:function(o){Y(this._callState,"startTranscription()"),this.sendMessageToCallMachine(N({action:"daily-method-start-transcription"},o))}},{key:"updateTranscription",value:function(o){if(Y(this._callState,"updateTranscription()"),!o)throw new Error("updateTranscription Error: options is mandatory");if(J(o)!=="object")throw new Error("updateTranscription Error: options must be object type");if(o.participants&&!Array.isArray(o.participants))throw new Error("updateTranscription Error: participants must be an array");this.sendMessageToCallMachine(N({action:"daily-method-update-transcription"},o))}},{key:"stopTranscription",value:function(o){if(Y(this._callState,"stopTranscription()"),o&&J(o)!=="object")throw new Error("stopTranscription Error: options must be object type");if(o&&!o.instanceId)throw new Error('"instanceId" not provided');this.sendMessageToCallMachine(N({action:"daily-method-stop-transcription"},o))}},{key:"startDialOut",value:(E=R(function*(o){var u=this;Y(this._callState,"startDialOut()");var c=function(M){if(M){if(!Array.isArray(M))throw new Error("Error starting dial out: audio codec must be an array");if(M.length<=0)throw new Error("Error starting dial out: audio codec array specified but empty");M.forEach(function(P){if(typeof P!="string")throw new Error("Error starting dial out: audio codec must be a string");if(P!=="OPUS"&&P!=="PCMU"&&P!=="PCMA"&&P!=="G722")throw new Error("Error starting dial out: audio codec must be one of OPUS, PCMU, PCMA, G722")})}};if(!o.sipUri&&!o.phoneNumber)throw new Error("Error starting dial out: either a sip uri or phone number must be provided");if(o.sipUri&&o.phoneNumber)throw new Error("Error starting dial out: only one of sip uri or phone number must be provided");if(o.sipUri){if(typeof o.sipUri!="string")throw new Error("Error starting dial out: sipUri must be a string");if(!o.sipUri.startsWith("sip:"))throw new Error("Error starting dial out: Invalid SIP URI, must start with 'sip:'");if(o.video&&typeof o.video!="boolean")throw new Error("Error starting dial out: video must be a boolean value");(function(M){if(M&&(c(M.audio),M.video)){if(!Array.isArray(M.video))throw new Error("Error starting dial out: video codec must be an array");if(M.video.length<=0)throw new Error("Error starting dial out: video codec array specified but empty");M.video.forEach(function(P){if(typeof P!="string")throw new Error("Error starting dial out: video codec must be a string");if(P!=="H264"&&P!=="VP8")throw new Error("Error starting dial out: video codec must be H264 or VP8")})}})(o.codecs)}if(o.phoneNumber){if(typeof o.phoneNumber!="string")throw new Error("Error starting dial out: phoneNumber must be a string");if(!/^\+\d{1,}$/.test(o.phoneNumber))throw new Error("Error starting dial out: Invalid phone number, must be valid phone number as per E.164");o.codecs&&c(o.codecs.audio)}if(o.callerId){if(typeof o.callerId!="string")throw new Error("Error starting dial out: callerId must be a string");if(o.sipUri)throw new Error("Error starting dial out: callerId not allowed with sipUri")}if(o.displayName){if(typeof o.displayName!="string")throw new Error("Error starting dial out: displayName must be a string");if(o.displayName.length>=200)throw new Error("Error starting dial out: displayName length must be less than 200")}if(o.userId){if(typeof o.userId!="string")throw new Error("Error starting dial out: userId must be a string");if(o.userId.length>36)throw new Error("Error starting dial out: userId length must be less than or equal to 36")}if(o.permissions&&o.permissions.canReceive){var p=re(Io.validateJSONObject(o.permissions.canReceive),2),m=p[0],k=p[1];if(!m)throw new Error(k)}return new Promise(function(M,P){u.sendMessageToCallMachine(N({action:"dialout-start"},o),function(D){D.error?P(D.error):M(D)})})}),function(o){return E.apply(this,arguments)})},{key:"stopDialOut",value:function(o){var u=this;return Y(this._callState,"stopDialOut()"),new Promise(function(c,p){u.sendMessageToCallMachine(N({action:"dialout-stop"},o),function(m){m.error?p(m.error):c(m)})})}},{key:"sipCallTransfer",value:(v=R(function*(o){var u=this;if(Y(this._callState,"sipCallTransfer()"),!o)throw new Error("sipCallTransfer() requires a sessionId and toEndPoint");return o.useSipRefer=!1,Xo(o,"sipCallTransfer"),new Promise(function(c,p){u.sendMessageToCallMachine(N({action:eo},o),function(m){m.error?p(m.error):c(m)})})}),function(o){return v.apply(this,arguments)})},{key:"sipRefer",value:(_=R(function*(o){var u=this;if(Y(this._callState,"sipRefer()"),!o)throw new Error("sessionId and toEndPoint are mandatory parameter");return o.useSipRefer=!0,Xo(o,"sipRefer"),new Promise(function(c,p){u.sendMessageToCallMachine(N({action:eo},o),function(m){m.error?p(m.error):c(m)})})}),function(o){return _.apply(this,arguments)})},{key:"sendDTMF",value:(C=R(function*(o){var u=this;return Y(this._callState,"sendDTMF()"),function(c){var p=c.sessionId,m=c.tones;if(!p||!m)throw new Error("sessionId and tones are mandatory parameter");if(typeof p!="string"||typeof m!="string")throw new Error("sessionId and tones should be of string type");if(m.length>20)throw new Error("tones string must be upto 20 characters");var k=/[^0-9A-D*#]/g,M=m.match(k);if(M&&M[0])throw new Error("".concat(M[0]," is not valid DTMF tone"))}(o),new Promise(function(c,p){u.sendMessageToCallMachine(N({action:"send-dtmf"},o),function(m){m.error?p(m.error):c(m)})})}),function(o){return C.apply(this,arguments)})},{key:"getNetworkStats",value:function(){var o=this;return this._callState!==Ne?Promise.resolve(N({stats:{latest:{}}},this._network)):new Promise(function(u){o.sendMessageToCallMachine({action:"get-calc-stats"},function(c){u(N(N({},o._network),{},{stats:c.stats}))})})}},{key:"testWebsocketConnectivity",value:(w=R(function*(){var o=this;if(wn(this._testCallInProgress,"testWebsocketConnectivity()"),this.needsLoad())try{yield this.load()}catch(u){return Promise.reject(u)}return new Promise(function(u,c){o.sendMessageToCallMachine({action:"test-websocket-connectivity"},function(p){p.error?c(p.error):u(p.results)})})}),function(){return w.apply(this,arguments)})},{key:"abortTestWebsocketConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-websocket-connectivity"})}},{key:"_validateVideoTrackForNetworkTests",value:function(o){return o?o instanceof MediaStreamTrack?!!Ol(o)||(console.error("Video track is not playable. This test needs a live video track."),!1):(console.error("Video track needs to be of type `MediaStreamTrack`."),!1):(console.error("Missing video track. You must provide a video track in order to run this test."),!1)}},{key:"testCallQuality",value:(g=R(function*(){var o=this;U(),be(this._callObjectMode,"testCallQuality()"),dr(this._callMachineInitialized,"testCallQuality()",null,!0),_n(this._callState,this._isPreparingToJoin,"testCallQuality()");var u=this._testCallAlreadyInProgress,c=function(m){u||(o._testCallInProgress=m)};if(c(!0),this.needsLoad())try{var p=this._callState;yield this.load(),this._callState=p}catch(m){return c(!1),Promise.reject(m)}return new Promise(function(m){o.sendMessageToCallMachine({action:"test-call-quality",dailyJsVersion:o.properties.dailyJsVersion},function(k){var M=k.results,P=M.result,D=Cn(M,Il);if(P==="failed"){var z,$=N({},D);(z=D.error)!==null&&z!==void 0&&z.details?(D.error.details=JSON.parse(D.error.details),$.error=N(N({},$.error),{},{details:N({},$.error.details)}),$.error.details.duringTest="testCallQuality"):($.error=$.error?N({},$.error):{},$.error.details={duringTest:"testCallQuality"}),o._maybeSendToSentry($)}c(!1),m(N({result:P},D))})})}),function(){return g.apply(this,arguments)})},{key:"stopTestCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-call-quality"})}},{key:"testConnectionQuality",value:(f=R(function*(o){var u;B()?(console.warn("testConnectionQuality() is deprecated: use testPeerToPeerCallQuality() instead"),u=yield this.testPeerToPeerCallQuality(o)):(console.warn("testConnectionQuality() is deprecated: use testCallQuality() instead"),u=yield this.testCallQuality());var c={result:u.result,secondsElapsed:u.secondsElapsed};return u.data&&(c.data={maxRTT:u.data.maxRoundTripTime,packetLoss:u.data.avgRecvPacketLoss}),c}),function(o){return f.apply(this,arguments)})},{key:"testPeerToPeerCallQuality",value:(h=R(function*(o){var u=this;if(wn(this._testCallInProgress,"testPeerToPeerCallQuality()"),this.needsLoad())try{yield this.load()}catch(m){return Promise.reject(m)}var c=o.videoTrack,p=o.duration;if(!this._validateVideoTrackForNetworkTests(c))throw new Error("Video track error");return this._sharedTracks.videoTrackForConnectionQualityTest=c,new Promise(function(m,k){u.sendMessageToCallMachine({action:"test-p2p-call-quality",duration:p},function(M){M.error?k(M.error):m(M.results)})})}),function(o){return h.apply(this,arguments)})},{key:"stopTestConnectionQuality",value:function(){B()?(console.warn("stopTestConnectionQuality() is deprecated: use testPeerToPeerCallQuality() and stopTestPeerToPeerCallQuality() instead"),this.stopTestPeerToPeerCallQuality()):(console.warn("stopTestConnectionQuality() is deprecated: use testCallQuality() and stopTestCallQuality() instead"),this.stopTestCallQuality())}},{key:"stopTestPeerToPeerCallQuality",value:function(){this.sendMessageToCallMachine({action:"stop-test-p2p-call-quality"})}},{key:"testNetworkConnectivity",value:(d=R(function*(o){var u=this;if(wn(this._testCallInProgress,"testNetworkConnectivity()"),this.needsLoad())try{yield this.load()}catch(c){return Promise.reject(c)}if(!this._validateVideoTrackForNetworkTests(o))throw new Error("Video track error");return this._sharedTracks.videoTrackForNetworkConnectivityTest=o,new Promise(function(c,p){u.sendMessageToCallMachine({action:"test-network-connectivity"},function(m){m.error?p(m.error):c(m.results)})})}),function(o){return d.apply(this,arguments)})},{key:"abortTestNetworkConnectivity",value:function(){this.sendMessageToCallMachine({action:"abort-test-network-connectivity"})}},{key:"getCpuLoadStats",value:function(){var o=this;return new Promise(function(u){o._callState===Ne?o.sendMessageToCallMachine({action:"get-cpu-load-stats"},function(c){u(c.cpuStats)}):u({cpuLoadState:void 0,cpuLoadStateReason:void 0,stats:{}})})}},{key:"_validateEncodingLayerHasValidProperties",value:function(o){var u;if(!(((u=Object.keys(o))===null||u===void 0?void 0:u.length)>0))throw new Error("Empty encoding is not allowed. At least one of these valid keys should be specified:"+Object.values(yn))}},{key:"_validateVideoSendSettings",value:function(o,u){var c=o==="screenVideo"?["default-screen-video","detail-optimized","motion-optimized","motion-and-detail-balanced"]:["default-video","bandwidth-optimized","bandwidth-and-quality-balanced","quality-optimized","adaptive-2-layers","adaptive-3-layers"],p="Video send settings should be either an object or one of the supported presets: ".concat(c.join());if(typeof u=="string"){if(!c.includes(u))throw new Error(p)}else{if(J(u)!=="object")throw new Error(p);if(!u.maxQuality&&!u.encodings&&u.allowAdaptiveLayers===void 0)throw new Error("Video send settings must contain at least maxQuality, allowAdaptiveLayers or encodings attribute");if(u.maxQuality&&["low","medium","high"].indexOf(u.maxQuality)===-1)throw new Error("maxQuality must be either low, medium or high");if(u.encodings){var m=!1;switch(Object.keys(u.encodings).length){case 1:m=!u.encodings.low;break;case 2:m=!u.encodings.low||!u.encodings.medium;break;case 3:m=!u.encodings.low||!u.encodings.medium||!u.encodings.high;break;default:m=!0}if(m)throw new Error("Encodings must be defined as: low, low and medium, or low, medium and high.");u.encodings.low&&this._validateEncodingLayerHasValidProperties(u.encodings.low),u.encodings.medium&&this._validateEncodingLayerHasValidProperties(u.encodings.medium),u.encodings.high&&this._validateEncodingLayerHasValidProperties(u.encodings.high)}}}},{key:"validateUpdateSendSettings",value:function(o){var u=this;if(!o||Object.keys(o).length===0)throw new Error("Send settings must contain at least information for one track!");Object.entries(o).forEach(function(c){var p=re(c,2),m=p[0],k=p[1];u._validateVideoSendSettings(m,k)})}},{key:"updateSendSettings",value:function(o){var u=this;return this.validateUpdateSendSettings(o),this.needsLoad()?(this._preloadCache.sendSettings=o,{sendSettings:this._preloadCache.sendSettings}):new Promise(function(c,p){u.sendMessageToCallMachine({action:"update-send-settings",sendSettings:o},function(m){m.error?p(m.error):c(m.sendSettings)})})}},{key:"getSendSettings",value:function(){return this._sendSettings||this._preloadCache.sendSettings}},{key:"getLocalAudioLevel",value:function(){return this._localAudioLevel}},{key:"getRemoteParticipantsAudioLevel",value:function(){return this._remoteParticipantsAudioLevel}},{key:"getActiveSpeaker",value:function(){return U(),this._activeSpeaker}},{key:"setActiveSpeakerMode",value:function(o){return U(),this.sendMessageToCallMachine({action:"set-active-speaker-mode",enabled:o}),this}},{key:"activeSpeakerMode",value:function(){return U(),this._activeSpeakerMode}},{key:"subscribeToTracksAutomatically",value:function(){return this._preloadCache.subscribeToTracksAutomatically}},{key:"setSubscribeToTracksAutomatically",value:function(o){return Y(this._callState,"setSubscribeToTracksAutomatically()","Use the subscribeToTracksAutomatically configuration property."),this._preloadCache.subscribeToTracksAutomatically=o,this.sendMessageToCallMachine({action:"daily-method-subscribe-to-tracks-automatically",enabled:o}),this}},{key:"enumerateDevices",value:(l=R(function*(){var o=this;if(this._callObjectMode){var u=yield navigator.mediaDevices.enumerateDevices();return He()==="Firefox"&&sr().major>115&&sr().major<123&&(u=u.filter(function(c){return c.kind!=="audiooutput"})),{devices:u.map(function(c){var p=JSON.parse(JSON.stringify(c));if(!B()&&c.kind==="videoinput"&&c.getCapabilities){var m,k=c.getCapabilities();p.facing=(k==null||(m=k.facingMode)===null||m===void 0?void 0:m.length)>=1?k.facingMode[0]:void 0}return p})}}return new Promise(function(c){o.sendMessageToCallMachine({action:"enumerate-devices"},function(p){c({devices:p.devices})})})}),function(){return l.apply(this,arguments)})},{key:"sendAppMessage",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"*";if(Y(this._callState,"sendAppMessage()"),JSON.stringify(o).length>this._maxAppMessageSize)throw new Error("Message data too large. Max size is "+this._maxAppMessageSize);return this.sendMessageToCallMachine({action:"app-msg",data:o,to:u}),this}},{key:"addFakeParticipant",value:function(o){return U(),Y(this._callState,"addFakeParticipant()"),this.sendMessageToCallMachine(N({action:"add-fake-participant"},o)),this}},{key:"setShowNamesMode",value:function(o){return ue(this._callObjectMode,"setShowNamesMode()"),U(),o&&o!=="always"&&o!=="never"?(console.error('setShowNamesMode argument should be "always", "never", or false'),this):(this.sendMessageToCallMachine({action:"set-show-names",mode:o}),this)}},{key:"setShowLocalVideo",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ue(this._callObjectMode,"setShowLocalVideo()"),U(),Y(this._callState,"setShowLocalVideo()"),typeof o!="boolean"?(console.error("setShowLocalVideo only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-local-video",show:o}),this._showLocalVideo=o,this)}},{key:"showLocalVideo",value:function(){return ue(this._callObjectMode,"showLocalVideo()"),U(),this._showLocalVideo}},{key:"setShowParticipantsBar",value:function(){var o=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];return ue(this._callObjectMode,"setShowParticipantsBar()"),U(),Y(this._callState,"setShowParticipantsBar()"),typeof o!="boolean"?(console.error("setShowParticipantsBar only accepts a boolean value"),this):(this.sendMessageToCallMachine({action:"set-show-participants-bar",show:o}),this._showParticipantsBar=o,this)}},{key:"showParticipantsBar",value:function(){return ue(this._callObjectMode,"showParticipantsBar()"),U(),this._showParticipantsBar}},{key:"customIntegrations",value:function(){return U(),ue(this._callObjectMode,"customIntegrations()"),this._customIntegrations}},{key:"setCustomIntegrations",value:function(o){return U(),ue(this._callObjectMode,"setCustomIntegrations()"),Y(this._callState,"setCustomIntegrations()"),Qo(o)?(this.sendMessageToCallMachine({action:"set-custom-integrations",integrations:o}),this._customIntegrations=o,this):this}},{key:"startCustomIntegrations",value:function(o){var u=this;if(U(),ue(this._callObjectMode,"startCustomIntegrations()"),Y(this._callState,"startCustomIntegrations()"),Array.isArray(o)&&o.some(function(m){return typeof m!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("startCustomIntegrations() only accepts string | string[]"),this;var c=typeof o=="string"?[o]:o,p=c.filter(function(m){return!(m in u._customIntegrations)});return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"start-custom-integrations",ids:c}),this)}},{key:"stopCustomIntegrations",value:function(o){var u=this;if(U(),ue(this._callObjectMode,"stopCustomIntegrations()"),Y(this._callState,"stopCustomIntegrations()"),Array.isArray(o)&&o.some(function(m){return typeof m!="string"})||!Array.isArray(o)&&typeof o!="string")return console.error("stopCustomIntegrations() only accepts string | string[]"),this;var c=typeof o=="string"?[o]:o,p=c.filter(function(m){return!(m in u._customIntegrations)});return p.length?(console.error(`Can't find custom integration(s): "`.concat(p.join(", "),'"')),this):(this.sendMessageToCallMachine({action:"stop-custom-integrations",ids:c}),this)}},{key:"customTrayButtons",value:function(){return ue(this._callObjectMode,"customTrayButtons()"),U(),this._customTrayButtons}},{key:"updateCustomTrayButtons",value:function(o){return ue(this._callObjectMode,"updateCustomTrayButtons()"),U(),Y(this._callState,"updateCustomTrayButtons()"),Ho(o)?(this.sendMessageToCallMachine({action:"update-custom-tray-buttons",btns:o}),this._customTrayButtons=o,this):(console.error("updateCustomTrayButtons only accepts a dictionary of the type ".concat(JSON.stringify(cr))),this)}},{key:"theme",value:function(){return ue(this._callObjectMode,"theme()"),this.properties.theme}},{key:"setTheme",value:function(o){var u=this;return ue(this._callObjectMode,"setTheme()"),new Promise(function(c,p){try{u.validateProperties({theme:o}),u.properties.theme=N({},o),u.sendMessageToCallMachine({action:"set-theme",theme:u.properties.theme});try{u.emitDailyJSEvent({action:ns,theme:u.properties.theme})}catch(m){console.log("could not emit 'theme-updated'",m)}c(u.properties.theme)}catch(m){p(m)}})}},{key:"requestFullscreen",value:(a=R(function*(){if(U(),this._iframe&&!document.fullscreenElement&&ro())try{(yield this._iframe.requestFullscreen)?this._iframe.requestFullscreen():this._iframe.webkitRequestFullscreen()}catch(o){console.log("could not make video call fullscreen",o)}}),function(){return a.apply(this,arguments)})},{key:"exitFullscreen",value:function(){U(),document.fullscreenElement?document.exitFullscreen():document.webkitFullscreenElement&&document.webkitExitFullscreen()}},{key:"getSidebarView",value:(s=R(function*(){var o=this;return this._callObjectMode?(console.error("getSidebarView is not available in callObject mode"),Promise.resolve(null)):new Promise(function(u){o.sendMessageToCallMachine({action:"get-sidebar-view"},function(c){u(c.view)})})}),function(){return s.apply(this,arguments)})},{key:"setSidebarView",value:function(o){return this._callObjectMode?(console.error("setSidebarView is not available in callObject mode"),this):(this.sendMessageToCallMachine({action:"set-sidebar-view",view:o}),this)}},{key:"room",value:(n=R(function*(){var o=this,u=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).includeRoomConfigDefaults,c=u===void 0||u;return this._accessState.access===rr||this.needsLoad()?this.properties.url?{roomUrlPendingJoin:this.properties.url}:null:new Promise(function(p){o.sendMessageToCallMachine({action:"lib-room-info",includeRoomConfigDefaults:c},function(m){delete m.action,delete m.callbackStamp,p(m)})})}),function(){return n.apply(this,arguments)})},{key:"geo",value:(i=R(function*(){try{var o=yield fetch("https://gs.daily.co/_ks_/x-swsl/:");return{current:(yield o.json()).geo}}catch(u){return console.error("geo lookup failed",u),{current:""}}}),function(){return i.apply(this,arguments)})},{key:"setNetworkTopology",value:(r=R(function*(o){var u=this;return U(),Y(this._callState,"setNetworkTopology()"),new Promise(function(c,p){u.sendMessageToCallMachine({action:"set-network-topology",opts:o},function(m){m.error?p({error:m.error}):c({workerId:m.workerId})})})}),function(o){return r.apply(this,arguments)})},{key:"getNetworkTopology",value:(e=R(function*(){var o=this;return new Promise(function(u,c){o.needsLoad()&&u({topology:"none"}),o.sendMessageToCallMachine({action:"get-network-topology"},function(p){p.error?c({error:p.error}):u({topology:p.topology})})})}),function(){return e.apply(this,arguments)})},{key:"setPlayNewParticipantSound",value:function(o){if(U(),typeof o!="number"&&o!==!0&&o!==!1)throw new Error("argument to setShouldPlayNewParticipantSound should be true, false, or a number, but is ".concat(o));this.sendMessageToCallMachine({action:"daily-method-set-play-ding",arg:o})}},{key:"on",value:function(o,u){return jt.prototype.on.call(this,o,u)}},{key:"once",value:function(o,u){return jt.prototype.once.call(this,o,u)}},{key:"off",value:function(o,u){return jt.prototype.off.call(this,o,u)}},{key:"validateProperties",value:function(o){var u,c;if(o!=null&&(u=o.dailyConfig)!==null&&u!==void 0&&u.userMediaAudioConstraints){var p,m;B()||console.warn("userMediaAudioConstraints is deprecated. You can override constraints with inputSettings.audio.settings, found in DailyCallOptions.");var k=o.inputSettings||{};k.audio=((p=o.inputSettings)===null||p===void 0?void 0:p.audio)||{},k.audio.settings=((m=o.inputSettings)===null||m===void 0||(m=m.audio)===null||m===void 0?void 0:m.settings)||{},k.audio.settings=N(N({},k.audio.settings),o.dailyConfig.userMediaAudioConstraints),o.inputSettings=k,delete o.dailyConfig.userMediaAudioConstraints}if(o!=null&&(c=o.dailyConfig)!==null&&c!==void 0&&c.userMediaVideoConstraints){var M,P;B()||console.warn("userMediaVideoConstraints is deprecated. You can override constraints with inputSettings.video.settings, found in DailyCallOptions.");var D=o.inputSettings||{};D.video=((M=o.inputSettings)===null||M===void 0?void 0:M.video)||{},D.video.settings=((P=o.inputSettings)===null||P===void 0||(P=P.video)===null||P===void 0?void 0:P.settings)||{},D.video.settings=N(N({},D.video.settings),o.dailyConfig.userMediaVideoConstraints),o.inputSettings=D,delete o.dailyConfig.userMediaVideoConstraints}for(var z in o){if(!Ke[z])throw new Error("unrecognized property '".concat(z,"'"));if(Ke[z].validate&&!Ke[z].validate(o[z],this))throw new Error("property '".concat(z,"': ").concat(Ke[z].help))}}},{key:"assembleMeetingUrl",value:function(){var o,u,c=N(N({},this.properties),{},{emb:this.callClientId,embHref:encodeURIComponent(window.location.href),proxy:(o=this.properties.dailyConfig)!==null&&o!==void 0&&o.proxyUrl?encodeURIComponent((u=this.properties.dailyConfig)===null||u===void 0?void 0:u.proxyUrl):void 0}),p=c.url.match(/\?/)?"&":"?";return c.url+p+Object.keys(Ke).filter(function(m){return Ke[m].queryString&&c[m]!==void 0}).map(function(m){return"".concat(Ke[m].queryString,"=").concat(c[m])}).join("&")}},{key:"needsLoad",value:function(){return[Qr,Yi,Re,Oe].includes(this._callState)}},{key:"sendMessageToCallMachine",value:function(o,u){if(this._destroyed&&(this._logUseAfterDestroy(),this.strictMode))throw new Error("Use after destroy");this._messageChannel.sendMessageToCallMachine(o,u,this.callClientId,this._iframe)}},{key:"forwardPackagedMessageToCallMachine",value:function(o){this._messageChannel.forwardPackagedMessageToCallMachine(o,this._iframe,this.callClientId)}},{key:"addListenerForPackagedMessagesFromCallMachine",value:function(o){return this._messageChannel.addListenerForPackagedMessagesFromCallMachine(o,this.callClientId)}},{key:"removeListenerForPackagedMessagesFromCallMachine",value:function(o){this._messageChannel.removeListenerForPackagedMessagesFromCallMachine(o)}},{key:"handleMessageFromCallMachine",value:function(o){switch(o.action){case ts:this.sendMessageToCallMachine(N({action:rs},this.properties));break;case"call-machine-initialized":this._callMachineInitialized=!0;var u={action:nr,level:"log",code:1011,stats:{event:"bundle load",time:this._bundleLoadTime==="no-op"?0:this._bundleLoadTime,preLoaded:this._bundleLoadTime==="no-op",url:xt(this.properties.dailyConfig)}};this.sendMessageToCallMachine(u),this._delayDuplicateInstanceLog&&this._logDuplicateInstanceAttempt();break;case Xr:this._loadedCallback&&(this._loadedCallback(),this._loadedCallback=null),this.emitDailyJSEvent(o);break;case ls:var c,p=N({},o);delete p.internal,this._maxAppMessageSize=((c=o.internal)===null||c===void 0?void 0:c._maxAppMessageSize)||sn,this._joinedCallback&&(this._joinedCallback(o.participants),this._joinedCallback=null),this.emitDailyJSEvent(p);break;case ds:case hs:if(this._callState===Re)return;if(o.participant&&o.participant.session_id){var m=o.participant.local?"local":o.participant.session_id;if(this._callObjectMode){var k=this._callMachine().store;wo(o.participant,k),So(o.participant,k),Eo(o.participant,this._participants[m],k)}try{this.maybeParticipantTracksStopped(this._participants[m],o.participant),this.maybeParticipantTracksStarted(this._participants[m],o.participant),this.maybeEventRecordingStopped(this._participants[m],o.participant),this.maybeEventRecordingStarted(this._participants[m],o.participant)}catch(Wl){console.error("track events error",Wl)}this.compareEqualForParticipantUpdateEvent(o.participant,this._participants[m])||(this._participants[m]=N({},o.participant),this.toggleParticipantAudioBasedOnNativeAudioFocus(),this.emitDailyJSEvent(o))}break;case ps:if(o.participant&&o.participant.session_id){var M=this._participants[o.participant.session_id];M&&this.maybeParticipantTracksStopped(M,null),delete this._participants[o.participant.session_id],this.emitDailyJSEvent(o)}break;case fs:ie(this._participantCounts,o.participantCounts)||(this._participantCounts=o.participantCounts,this.emitDailyJSEvent(o));break;case ms:var P={access:o.access};o.awaitingAccess&&(P.awaitingAccess=o.awaitingAccess),ie(this._accessState,P)||(this._accessState=P,this.emitDailyJSEvent(o));break;case gs:if(o.meetingSession){this._meetingSessionSummary=o.meetingSession,this.emitDailyJSEvent(o);var D=N(N({},o),{},{action:"meeting-session-updated"});this.emitDailyJSEvent(D)}break;case nn:var z;this._iframe&&!o.preserveIframe&&(this._iframe.src=""),this._updateCallState(Oe),this.resetMeetingDependentVars(),this._loadedCallback&&(this._loadedCallback(o.errorMsg),this._loadedCallback=null),o.preserveIframe;var $=Cn(o,Ll);$!=null&&(z=$.error)!==null&&z!==void 0&&z.details&&($.error.details=JSON.parse($.error.details)),this._maybeSendToSentry(o),this._joinedCallback&&(this._joinedCallback(null,$),this._joinedCallback=null),this.emitDailyJSEvent($);break;case us:this._callState!==Oe&&this._updateCallState(Re),this.resetMeetingDependentVars(),this._resolveLeave&&(this._resolveLeave(),this._resolveLeave=null),this.emitDailyJSEvent(o);break;case"selected-devices-updated":o.devices&&this.emitDailyJSEvent(o);break;case zs:var Ee=o.state,Ze=o.threshold,Tt=o.quality,ee=Ee.state,me=Ee.reasons;ee===this._network.networkState&&ie(me,this._network.networkStateReasons)&&Ze===this._network.threshold&&Tt===this._network.quality||(this._network.networkState=ee,this._network.networkStateReasons=me,this._network.quality=Tt,this._network.threshold=Ze,o.networkState=ee,me.length&&(o.networkStateReasons=me),delete o.state,this.emitDailyJSEvent(o));break;case Us:o&&o.cpuLoadState&&this.emitDailyJSEvent(o);break;case Bs:o&&o.faceCounts!==void 0&&this.emitDailyJSEvent(o);break;case Fs:var et=o.activeSpeaker;this._activeSpeaker.peerId!==et.peerId&&(this._activeSpeaker.peerId=et.peerId,this.emitDailyJSEvent({action:o.action,activeSpeaker:this._activeSpeaker}));break;case"show-local-video-changed":if(this._callObjectMode)return;var At=o.show;this._showLocalVideo=At,this.emitDailyJSEvent({action:o.action,show:At});break;case Vs:var pr=o.enabled;this._activeSpeakerMode!==pr&&(this._activeSpeakerMode=pr,this.emitDailyJSEvent({action:o.action,enabled:this._activeSpeakerMode}));break;case ys:case bs:case _s:this._waitingParticipants=o.allWaitingParticipants,this.emitDailyJSEvent({action:o.action,participant:o.participant});break;case Hs:ie(this._receiveSettings,o.receiveSettings)||(this._receiveSettings=o.receiveSettings,this.emitDailyJSEvent({action:o.action,receiveSettings:o.receiveSettings}));break;case tn:this._maybeUpdateInputSettings(o.inputSettings);break;case"send-settings-updated":ie(this._sendSettings,o.sendSettings)||(this._sendSettings=o.sendSettings,this._preloadCache.sendSettings=null,this.emitDailyJSEvent({action:o.action,sendSettings:o.sendSettings}));break;case"local-audio-level":this._localAudioLevel=o.audioLevel,this._preloadCache.localAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case"remote-participants-audio-level":this._remoteParticipantsAudioLevel=o.participantsAudioLevel,this._preloadCache.remoteParticipantsAudioLevelObserver=null,this.emitDailyJSEvent(o);break;case Ls:var Ot=o.session_id;this._rmpPlayerState[Ot]=o.playerState,this.emitDailyJSEvent(o);break;case Ds:delete this._rmpPlayerState[o.session_id],this.emitDailyJSEvent(o);break;case js:var Mt=o.session_id,ha=this._rmpPlayerState[Mt];ha&&this.compareEqualForRMPUpdateEvent(ha,o.remoteMediaPlayerState)||(this._rmpPlayerState[Mt]=o.remoteMediaPlayerState,this.emitDailyJSEvent(o));break;case"custom-button-click":case"sidebar-view-changed":this.emitDailyJSEvent(o);break;case vs:var Gl=this._meetingSessionState.topology!==(o.meetingSessionState&&o.meetingSessionState.topology);this._meetingSessionState=En(o.meetingSessionState,this._callObjectMode),(this._callObjectMode||Gl)&&this.emitDailyJSEvent(o);break;case xs:this._isScreenSharing=!0,this.emitDailyJSEvent(o);break;case Ns:case Rs:this._isScreenSharing=!1,this.emitDailyJSEvent(o);break;case Zr:case en:case Ts:case As:case Os:case Es:case ks:case Cs:case os:case as:case Ps:case Is:case"test-completed":case qs:case Ms:case $s:case Js:case Gs:case Ws:case rn:case Ys:case"dialin-ready":case"dialin-connected":case"dialin-error":case"dialin-stopped":case"dialin-warning":case"dialout-connected":case"dialout-answered":case"dialout-error":case"dialout-stopped":case"dialout-warning":this.emitDailyJSEvent(o);break;case"request-fullscreen":this.requestFullscreen();break;case"request-exit-fullscreen":this.exitFullscreen()}}},{key:"maybeEventRecordingStopped",value:function(o,u){var c="record";o&&(u.local||u[c]!==!1||o[c]===u[c]||this.emitDailyJSEvent({action:en}))}},{key:"maybeEventRecordingStarted",value:function(o,u){var c="record";o&&(u.local||u[c]!==!0||o[c]===u[c]||this.emitDailyJSEvent({action:Zr}))}},{key:"_trackStatePlayable",value:function(o){return!(!o||o.state!==Qi)}},{key:"_trackChanged",value:function(o,u){return o?.id!==u?.id}},{key:"maybeEventTrackStopped",value:function(o,u,c){var p,m,k=(p=u?.tracks[o])!==null&&p!==void 0?p:null,M=(m=c?.tracks[o])!==null&&m!==void 0?m:null,P=k?.track;if(P){var D=this._trackStatePlayable(k),z=this._trackStatePlayable(M),$=this._trackChanged(P,M?.track);D&&(z&&!$||this.emitDailyJSEvent({action:Ss,track:P,participant:c??u,type:o}))}}},{key:"maybeEventTrackStarted",value:function(o,u,c){var p,m,k=(p=u?.tracks[o])!==null&&p!==void 0?p:null,M=(m=c?.tracks[o])!==null&&m!==void 0?m:null,P=M?.track;if(P){var D=this._trackStatePlayable(k),z=this._trackStatePlayable(M),$=this._trackChanged(k?.track,P);z&&(D&&!$||this.emitDailyJSEvent({action:ws,track:P,participant:c,type:o}))}}},{key:"maybeParticipantTracksStopped",value:function(o,u){if(o)for(var c in o.tracks)this.maybeEventTrackStopped(c,o,u)}},{key:"maybeParticipantTracksStarted",value:function(o,u){if(u)for(var c in u.tracks)this.maybeEventTrackStarted(c,o,u)}},{key:"compareEqualForRMPUpdateEvent",value:function(o,u){var c,p;return o.state===u.state&&((c=o.settings)===null||c===void 0?void 0:c.volume)===((p=u.settings)===null||p===void 0?void 0:p.volume)}},{key:"emitDailyJSEvent",value:function(o){try{o.callClientId=this.callClientId,this.emit(o.action,o)}catch(u){console.log("could not emit",o,u)}}},{key:"compareEqualForParticipantUpdateEvent",value:function(o,u){return!!ie(o,u)&&(!o.videoTrack||!u.videoTrack||o.videoTrack.id===u.videoTrack.id&&o.videoTrack.muted===u.videoTrack.muted&&o.videoTrack.enabled===u.videoTrack.enabled)&&(!o.audioTrack||!u.audioTrack||o.audioTrack.id===u.audioTrack.id&&o.audioTrack.muted===u.audioTrack.muted&&o.audioTrack.enabled===u.audioTrack.enabled)}},{key:"nativeUtils",value:function(){return B()?typeof DailyNativeUtils>"u"?(console.warn("in React Native, DailyNativeUtils is expected to be available"),null):DailyNativeUtils:null}},{key:"updateIsPreparingToJoin",value:function(o){this._updateCallState(this._callState,o)}},{key:"_updateCallState",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._isPreparingToJoin;if(o!==this._callState||u!==this._isPreparingToJoin){var c=this._callState,p=this._isPreparingToJoin;this._callState=o,this._isPreparingToJoin=u;var m=this._callState===Ne;this.updateShowAndroidOngoingMeetingNotification(m);var k=ur(c,p),M=ur(this._callState,this._isPreparingToJoin);k!==M&&(this.updateKeepDeviceAwake(M),this.updateDeviceAudioMode(M),this.updateNoOpRecordingEnsuringBackgroundContinuity(M))}}},{key:"resetMeetingDependentVars",value:function(){this._participants={},this._participantCounts=Fo,this._waitingParticipants={},this._activeSpeaker={},this._activeSpeakerMode=!1,this._didPreAuth=!1,this._accessState={access:rr},this._finalSummaryOfPrevSession=this._meetingSessionSummary,this._meetingSessionSummary={},this._meetingSessionState=En(Ro,this._callObjectMode),this._isScreenSharing=!1,this._receiveSettings={},this._inputSettings=void 0,this._sendSettings={},this._localAudioLevel=0,this._isLocalAudioLevelObserverRunning=!1,this._remoteParticipantsAudioLevel={},this._isRemoteParticipantsAudioLevelObserverRunning=!1,this._maxAppMessageSize=sn,this._callMachineInitialized=!1,this._bundleLoadTime=void 0,this._preloadCache}},{key:"updateKeepDeviceAwake",value:function(o){B()&&this.nativeUtils().setKeepDeviceAwake(o,this.callClientId)}},{key:"updateDeviceAudioMode",value:function(o){if(B()&&!this.disableReactNativeAutoDeviceManagement("audio")){var u=o?this._nativeInCallAudioMode:"idle";this.nativeUtils().setAudioMode(u)}}},{key:"updateShowAndroidOngoingMeetingNotification",value:function(o){if(B()&&this.nativeUtils().setShowOngoingMeetingNotification){var u,c,p,m;if(this.properties.reactNativeConfig&&this.properties.reactNativeConfig.androidInCallNotification){var k=this.properties.reactNativeConfig.androidInCallNotification;u=k.title,c=k.subtitle,p=k.iconName,m=k.disableForCustomOverride}m&&(o=!1),this.nativeUtils().setShowOngoingMeetingNotification(o,u,c,p,this.callClientId)}}},{key:"updateNoOpRecordingEnsuringBackgroundContinuity",value:function(o){B()&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity&&this.nativeUtils().enableNoOpRecordingEnsuringBackgroundContinuity(o)}},{key:"toggleParticipantAudioBasedOnNativeAudioFocus",value:function(){var o;if(B()){var u=(o=this._callMachine())===null||o===void 0||(o=o.store)===null||o===void 0?void 0:o.getState();for(var c in u?.streams){var p=u.streams[c];p&&p.pendingTrack&&p.pendingTrack.kind==="audio"&&(p.pendingTrack.enabled=this._hasNativeAudioFocus)}}}},{key:"disableReactNativeAutoDeviceManagement",value:function(o){return this.properties.reactNativeConfig&&this.properties.reactNativeConfig.disableAutoDeviceManagement&&this.properties.reactNativeConfig.disableAutoDeviceManagement[o]}},{key:"absoluteUrl",value:function(o){if(o!==void 0){var u=document.createElement("a");return u.href=o,u.href}}},{key:"sayHello",value:function(){var o="hello, world.";return console.log(o),o}},{key:"_logUseAfterDestroy",value:function(){var o=Object.values(Qe)[0];if(this.needsLoad())if(o&&!o.needsLoad()){var u={action:nr,level:"error",code:this.strictMode?9995:9997};o.sendMessageToCallMachine(u)}else this.strictMode||console.error("You are are attempting to use a call instance that was previously destroyed, which is unsupported. Please remove `strictMode: false` from your constructor properties to enable strict mode to track down and fix this unsupported usage.");else{var c={action:nr,level:"error",code:this.strictMode?9995:9997};this._messageChannel.sendMessageToCallMachine(c,null,this.callClientId,this._iframe)}}},{key:"_logDuplicateInstanceAttempt",value:function(){for(var o=0,u=Object.values(Qe);o<u.length;o++){var c=u[o];c._callMachineInitialized?(c.sendMessageToCallMachine({action:nr,level:"warn",code:this.allowMultipleCallInstances?9993:9992}),c._delayDuplicateInstanceLog=!1):c._delayDuplicateInstanceLog=!0}}},{key:"_maybeSendToSentry",value:function(o){var u,c,p,m;if(!((u=o.error)!==null&&u!==void 0&&u.type&&(![es,Zi,Kr].includes(o.error.type)||o.error.type===Kr&&o.error.msg.includes("deleted")))){var k=(c=this.properties)!==null&&c!==void 0&&c.url?new URL(this.properties.url):void 0,M="production";k&&k.host.includes(".staging.daily")&&(M="staging");var P,D,z,$,Ee,Ze=function(Ot){const Mt=[tc(),Za(),Ac(),Cc(),Lc(),Dc(),sc(),jc()];return Ot.autoSessionTracking!==!1&&Mt.push(Ic()),Mt}({}).filter(function(Ot){return!["BrowserApiErrors","Breadcrumbs","GlobalHandlers"].includes(Ot.name)}),Tt=new pc({dsn:"https://f10f1c81e5d44a4098416c0867a8b740@o77906.ingest.sentry.io/168844",transport:yc,stackParser:kc,integrations:Ze,environment:M}),ee=new xe;if(ee.setClient(Tt),Tt.init(),this.session_id&&ee.setExtra("sessionId",this.session_id),this.properties){var me=N({},this.properties);me.userName=me.userName?"[Filtered]":void 0,me.userData=me.userData?"[Filtered]":void 0,me.token=me.token?"[Filtered]":void 0,ee.setExtra("properties",me)}if(k){var et=k.searchParams.get("domain");if(!et){var At=k.host.match(/(.*?)\./);et=At&&At[1]||""}et&&ee.setTag("domain",et)}o.error&&(ee.setTag("fatalErrorType",o.error.type),ee.setExtra("errorDetails",o.error.details),!((P=o.error.details)===null||P===void 0)&&P.uri&&ee.setTag("serverAddress",o.error.details.uri),!((D=o.error.details)===null||D===void 0)&&D.workerGroup&&ee.setTag("workerGroup",o.error.details.workerGroup),!((z=o.error.details)===null||z===void 0)&&z.geoGroup&&ee.setTag("geoGroup",o.error.details.geoGroup),!(($=o.error.details)===null||$===void 0)&&$.on&&ee.setTag("connectionAttempt",o.error.details.on),(Ee=o.error.details)!==null&&Ee!==void 0&&Ee.bundleUrl&&(ee.setTag("bundleUrl",o.error.details.bundleUrl),ee.setTag("bundleError",o.error.details.sourceError.type))),ee.setTags({callMode:this._callObjectMode?B()?"reactNative":(p=this.properties)!==null&&p!==void 0&&(p=p.dailyConfig)!==null&&p!==void 0&&(p=p.callMode)!==null&&p!==void 0&&p.includes("prebuilt")?this.properties.dailyConfig.callMode:"custom":"prebuilt-frame",version:t.version()});var pr=((m=o.error)===null||m===void 0?void 0:m.msg)||o.errorMsg;ee.captureException(new Error(pr))}}},{key:"_callMachine",value:function(){var o;return(o=window._daily)===null||o===void 0||(o=o.instances)===null||o===void 0||(o=o[this.callClientId])===null||o===void 0?void 0:o.callMachine}},{key:"_maybeUpdateInputSettings",value:function(o){if(!ie(this._inputSettings,o)){var u=this._getInputSettings();this._inputSettings=o;var c=this._getInputSettings();ie(u,c)||this.emitDailyJSEvent({action:tn,inputSettings:c})}}}],[{key:"supportedBrowser",value:function(){if(B())return{supported:!0,mobile:!0,name:"React Native",version:null,supportsScreenShare:!0,supportsSfu:!0,supportsVideoProcessing:!1,supportsAudioProcessing:!1};var o=wa.getParser(fe());return{supported:!!so(),mobile:o.getPlatformType()==="mobile",name:o.getBrowserName(),version:o.getBrowserVersion(),supportsFullscreen:!!ro(),supportsScreenShare:!!al(),supportsSfu:!!so(),supportsVideoProcessing:no(),supportsAudioProcessing:io()}}},{key:"version",value:function(){return"0.80.0"}},{key:"createCallObject",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.layout="none",new t(null,o)}},{key:"wrap",value:function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(U(),!o||!o.contentWindow||typeof o.src!="string")throw new Error("DailyIframe::Wrap needs an iframe-like first argument");return u.layout||(u.customLayout?u.layout="custom-v1":u.layout="browser"),new t(o,u)}},{key:"createFrame",value:function(o,u){var c,p;U(),o&&u?(c=o,p=u):o&&o.append?(c=o,p={}):(c=document.body,p=o||{});var m=p.iframeStyle;m||(m=c===document.body?{position:"fixed",border:"1px solid black",backgroundColor:"white",width:"375px",height:"450px",right:"1em",bottom:"1em"}:{border:0,width:"100%",height:"100%"});var k=document.createElement("iframe");window.navigator&&window.navigator.userAgent.match(/Chrome\/61\./)?k.allow="microphone, camera":k.allow="microphone; camera; autoplay; display-capture; screen-wake-lock",k.style.visibility="hidden",c.appendChild(k),k.style.visibility=null,Object.keys(m).forEach(function(M){return k.style[M]=m[M]}),p.layout||(p.customLayout?p.layout="custom-v1":p.layout="browser");try{return new t(k,p)}catch(M){throw c.removeChild(k),M}}},{key:"createTransparentFrame",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};U();var u=document.createElement("iframe");return u.allow="microphone; camera; autoplay",u.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
      pointer-events: none;
    `,document.body.appendChild(u),o.layout||(o.layout="custom-v1"),t.wrap(u,o)}},{key:"getCallInstance",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;return o?Qe[o]:Object.values(Qe)[0]}}]);var e,r,i,n,s,a,l,d,h,f,g,w,C,_,v,E,S,O,I,y,b,A,L,x,q,F,K,j,X,Ie,Xe,sa,oa,aa,ca,la,ua,da}();function dt(t,e){var r={};for(var i in t)if(t[i]instanceof MediaStreamTrack)console.warn("MediaStreamTrack found in props or cache.",i),r[i]=Me;else if(i==="dailyConfig"){if(t[i].modifyLocalSdpHook){var n=window._daily.instances[e].customCallbacks||{};n.modifyLocalSdpHook=t[i].modifyLocalSdpHook,window._daily.instances[e].customCallbacks=n,delete t[i].modifyLocalSdpHook}if(t[i].modifyRemoteSdpHook){var s=window._daily.instances[e].customCallbacks||{};s.modifyRemoteSdpHook=t[i].modifyRemoteSdpHook,window._daily.instances[e].customCallbacks=s,delete t[i].modifyRemoteSdpHook}r[i]=t[i]}else r[i]=t[i];return r}function Y(t){var e=arguments.length>2?arguments[2]:void 0;if(t!==Ne){var r="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," only supported after join.");throw e&&(r+=" ".concat(e)),console.error(r),new Error(r)}}function ur(t,e){return[tr,Ne].includes(t)||e}function _n(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"This daily-js method",i=arguments.length>3?arguments[3]:void 0;if(ur(t,e)){var n="".concat(r," not supported after joining a meeting.");throw i&&(n+=" ".concat(i)),console.error(n),new Error(n)}}function dr(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method",r=arguments.length>2?arguments[2]:void 0;if(!t){var i="".concat(e,arguments.length>3&&arguments[3]!==void 0&&arguments[3]?" requires preAuth() or startCamera() to initialize call state.":" requires preAuth(), startCamera(), or join() to initialize call state.");throw r&&(i+=" ".concat(r)),console.error(i),new Error(i)}}function wn(t){if(t){var e="A pre-call quality test is in progress. Please try ".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," again once testing has completed. Use stopTestCallQuality() to end it early.");throw console.error(e),new Error(e)}}function be(t){if(!t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported on custom callObject instances");throw console.error(e),new Error(e)}}function ue(t){if(t){var e="".concat(arguments.length>1&&arguments[1]!==void 0?arguments[1]:"This daily-js method"," is only supported as part of Daily's Prebuilt");throw console.error(e),new Error(e)}}function U(){if(B())throw new Error("This daily-js method is not currently supported in React Native")}function kt(){if(!B())throw new Error("This daily-js method is only supported in React Native")}function Uo(t){if(t===void 0)return!0;var e;if(typeof t=="string")e=t;else try{e=JSON.stringify(t),ie(JSON.parse(e),t)||console.warn("The userData provided will be modified when serialized.")}catch(r){throw Error("userData must be serializable to JSON: ".concat(r))}if(e.length>4096)throw Error("userData is too large (".concat(e.length," characters). Maximum size suppported is ").concat(4096,"."));return!0}function Bo(t,e){for(var r=e.allowAllParticipantsKey,i=function(g){var w=["local"];return r||w.push("*"),g&&!w.includes(g)},n=function(g){return!!(g.layer===void 0||Number.isInteger(g.layer)&&g.layer>=0||g.layer==="inherit")},s=function(g){return!!g&&!(g.video&&!n(g.video))&&!(g.screenVideo&&!n(g.screenVideo))},a=0,l=Object.entries(t);a<l.length;a++){var d=re(l[a],2),h=d[0],f=d[1];if(!i(h)||!s(f))return!1}return!0}function $o(t){if(J(t)!=="object")return!1;for(var e=0,r=Object.entries(t);e<r.length;e++){var i=re(r[e],2),n=i[0],s=i[1];switch(n){case"video":if(J(s)!=="object")return!1;for(var a=0,l=Object.entries(s);a<l.length;a++){var d=re(l[a],2),h=d[0],f=d[1];switch(h){case"processor":if(!Nl(f))return!1;break;case"settings":if(!Go(f))return!1;break;default:return!1}}break;case"audio":if(J(s)!=="object")return!1;for(var g=0,w=Object.entries(s);g<w.length;g++){var C=re(w[g],2),_=C[0],v=C[1];switch(_){case"processor":if(!xl(v))return!1;break;case"settings":if(!Go(v))return!1;break;default:return!1}}break;default:return!1}}return!0}function Jo(t,e,r){var i,n=[];t.video&&t.video.processor&&(no((i=e?.useLegacyVideoProcessor)!==null&&i!==void 0&&i)||(t.video.settings?delete t.video.processor:delete t.video,n.push("video"))),t.audio&&t.audio.processor&&(io()||(t.audio.settings?delete t.audio.processor:delete t.audio,n.push("audio"))),n.length>0&&console.error("Ignoring settings for browser- or platform-unsupported input processor(s): ".concat(n.join(", "))),t.audio&&t.audio.settings&&(t.audio.settings.customTrack?(r.audioTrack=t.audio.settings.customTrack,t.audio.settings={customTrack:Me}):delete r.audioTrack),t.video&&t.video.settings&&(t.video.settings.customTrack?(r.videoTrack=t.video.settings.customTrack,t.video.settings={customTrack:Me}):delete r.videoTrack)}function xl(t){if(B())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type"];return!!t&&J(t)==="object"&&(Object.keys(t).filter(function(r){return!e.includes(r)}).forEach(function(r){console.warn("invalid key inputSettings -> audio -> processor : ".concat(r)),delete t[r]}),!!function(r){return typeof r!="string"?!1:Object.values(Zs).includes(r)?!0:(console.error("inputSettings audio processor type invalid"),!1)}(t.type))}function Nl(t){if(B())return console.warn("Video processing is not yet supported in React Native"),!1;var e=["type","config"];return!t||J(t)!=="object"||!function(r){return typeof r!="string"?!1:Object.values(ir).includes(r)?!0:(console.error("inputSettings video processor type invalid"),!1)}(t.type)||t.config&&(J(t.config)!=="object"||!function(r,i){var n=Object.keys(i);if(n.length===0)return!0;var s="invalid object in inputSettings -> video -> processor -> config";switch(r){case ir.BGBLUR:return n.length>1||n[0]!=="strength"?(console.error(s),!1):!(typeof i.strength!="number"||i.strength<=0||i.strength>1||isNaN(i.strength))||(console.error("".concat(s,"; expected: {0 < strength <= 1}, got: ").concat(i.strength)),!1);case ir.BGIMAGE:return!(i.source!==void 0&&!function(a){if(a.source==="default")return a.type="default",!0;if(a.source instanceof ArrayBuffer)return!0;if(Nt(a.source))return a.type="url",!!function(h){var f=new URL(h),g=f.pathname;if(f.protocol==="data:")try{var w=g.substring(g.indexOf(":")+1,g.indexOf(";")).split("/")[1];return cn.includes(w)}catch(_){return console.error("failed to deduce blob content type",_),!1}var C=g.split(".").at(-1).toLowerCase().trim();return cn.includes(C)}(a.source)||(console.error("invalid image type; supported types: [".concat(cn.join(", "),"]")),!1);return l=a.source,d=Number(l),isNaN(d)||!Number.isInteger(d)||d<=0||d>10?(console.error("invalid image selection; must be an int, > 0, <= ".concat(10)),!1):(a.type="daily-preselect",!0);var l,d}(i));default:return!0}}(t.type,t.config))?!1:(Object.keys(t).filter(function(r){return!e.includes(r)}).forEach(function(r){console.warn("invalid key inputSettings -> video -> processor : ".concat(r)),delete t[r]}),!0)}function Go(t){return J(t)==="object"&&(!t.customTrack||t.customTrack instanceof MediaStreamTrack)}function Sn(){var t=Object.values(ir).join(" | "),e=Object.values(Zs).join(" | ");return"inputSettings must be of the form: { video?: { processor?: { type: [ ".concat(t," ], config?: {} } }, audio?: { processor: {type: [ ").concat(e," ] } } }")}function Wo(t){var e=t.allowAllParticipantsKey;return"receiveSettings must be of the form { [<remote participant id> | ".concat(Xi).concat(e?' | "'.concat("*",'"'):"","]: ")+'{ [video: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]], [screenVideo: [{ layer: [<non-negative integer> | "inherit"] } | "inherit"]] }}}'}function Yo(){return"customIntegrations should be an object of type ".concat(JSON.stringify(bn),".")}function Ho(t){if(t&&J(t)!=="object"||Array.isArray(t))return console.error("customTrayButtons should be an Object of the type ".concat(JSON.stringify(cr),".")),!1;if(t)for(var e=0,r=Object.entries(t);e<r.length;e++)for(var i=re(r[e],1)[0],n=0,s=Object.entries(t[i]);n<s.length;n++){var a=re(s[n],2),l=a[0],d=a[1],h=cr.id[l];if(!h)return console.error("customTrayButton does not support key ".concat(l)),!1;switch(l){case"iconPath":case"iconPathDarkMode":if(!Nt(d))return console.error("customTrayButton ".concat(l," should be a url.")),!1;break;case"visualState":if(!["default","sidebar-open","active"].includes(d))return console.error("customTrayButton ".concat(l," should be ").concat(h,". Got: ").concat(d)),!1;break;default:if(J(d)!==h)return console.error("customTrayButton ".concat(l," should be a ").concat(h,".")),!1}}return!0}function Qo(t){if(!t||t&&J(t)!=="object"||Array.isArray(t))return console.error(Yo()),!1;for(var e=function(g){return"".concat(g," should be ").concat(bn.id[g])},r=function(g,w){return console.error("customIntegration ".concat(g,": ").concat(w))},i=0,n=Object.entries(t);i<n.length;i++){var s=re(n[i],1)[0];if(!("label"in t[s]))return r(s,"label is required"),!1;if(!("location"in t[s]))return r(s,"location is required"),!1;if(!("src"in t[s])&&!("srcdoc"in t[s]))return r(s,"src or srcdoc is required"),!1;for(var a=0,l=Object.entries(t[s]);a<l.length;a++){var d=re(l[a],2),h=d[0],f=d[1];switch(h){case"allow":case"csp":case"name":case"referrerPolicy":case"sandbox":if(typeof f!="string")return r(s,e(h)),!1;break;case"iconURL":if(!Nt(f))return r(s,"".concat(h," should be a url")),!1;break;case"src":if("srcdoc"in t[s])return r(s,"cannot have both src and srcdoc"),!1;if(!Nt(f))return r(s,'src "'.concat(f,'" is not a valid URL')),!1;break;case"srcdoc":if("src"in t[s])return r(s,"cannot have both src and srcdoc"),!1;if(typeof f!="string")return r(s,e(h)),!1;break;case"location":if(!["main","sidebar"].includes(f))return r(s,e(h)),!1;break;case"controlledBy":if(f!=="*"&&f!=="owners"&&(!Array.isArray(f)||f.some(function(g){return typeof g!="string"})))return r(s,e(h)),!1;break;case"shared":if((!Array.isArray(f)||f.some(function(g){return typeof g!="string"}))&&f!=="owners"&&typeof f!="boolean")return r(s,e(h)),!1;break;default:if(!bn.id[h])return console.error("customIntegration does not support key ".concat(h)),!1}}}return!0}function Ko(t,e){if(e===void 0)return!1;switch(J(e)){case"string":return J(t)===e;case"object":if(J(t)!=="object")return!1;for(var r in t)if(!Ko(t[r],e[r]))return!1;return!0;default:return!1}}function Xo(t,e){var r=t.sessionId,i=t.toEndPoint,n=t.callerId,s=t.useSipRefer;if(!r||!i)throw new Error("".concat(e,"() requires a sessionId and toEndPoint"));if(typeof r!="string"||typeof i!="string")throw new Error("Invalid paramater: sessionId and toEndPoint must be of type string");if(s&&!i.startsWith("sip:"))throw new Error('"toEndPoint" must be a "sip" address');if(!i.startsWith("sip:")&&!i.startsWith("+"))throw new Error("toEndPoint: ".concat(i,' must starts with either "sip:" or "+"'));if(n&&typeof n!="string")throw new Error("callerId must be of type string");if(n&&!i.startsWith("+"))throw new Error("callerId is only valid when transferring to a PSTN number")}function Zo(t){if(J(t)!=="object")throw new Error('RemoteMediaPlayerSettings: must be "object" type');if(t.state&&!Object.values(an).includes(t.state))throw new Error("Invalid value for RemoteMediaPlayerSettings.state, valid values are: "+JSON.stringify(an));if(t.volume){if(typeof t.volume!="number")throw new Error('RemoteMediaPlayerSettings.volume: must be "number" type');if(t.volume<0||t.volume>2)throw new Error("RemoteMediaPlayerSettings.volume: must be between 0.0 - 2.0")}}function ea(t,e,r){return!(typeof t!="number"||t<e||t>r)}function En(t,e){return t&&!e&&delete t.data,t}const Rl=fa(Object.freeze(Object.defineProperty({__proto__:null,DAILY_ACCESS_LEVEL_FULL:Ki,DAILY_ACCESS_LEVEL_LOBBY:zc,DAILY_ACCESS_LEVEL_NONE:qc,DAILY_ACCESS_UNKNOWN:rr,DAILY_CAMERA_ERROR_CAM_AND_MIC_IN_USE:Xc,DAILY_CAMERA_ERROR_CAM_IN_USE:Qc,DAILY_CAMERA_ERROR_CONSTRAINTS:rl,DAILY_CAMERA_ERROR_MIC_IN_USE:Kc,DAILY_CAMERA_ERROR_NOT_FOUND:tl,DAILY_CAMERA_ERROR_PERMISSIONS:Zc,DAILY_CAMERA_ERROR_UNDEF_MEDIADEVICES:el,DAILY_CAMERA_ERROR_UNKNOWN:nl,DAILY_EVENT_ACCESS_STATE_UPDATED:ms,DAILY_EVENT_ACTIVE_SPEAKER_CHANGE:Fs,DAILY_EVENT_ACTIVE_SPEAKER_MODE_CHANGE:Vs,DAILY_EVENT_APP_MSG:Ps,DAILY_EVENT_CAMERA_ERROR:as,DAILY_EVENT_CPU_LOAD_CHANGE:Us,DAILY_EVENT_ERROR:nn,DAILY_EVENT_EXIT_FULLSCREEN:_t,DAILY_EVENT_FACE_COUNTS_UPDATED:Bs,DAILY_EVENT_FULLSCREEN:bt,DAILY_EVENT_IFRAME_LAUNCH_CONFIG:rs,DAILY_EVENT_IFRAME_READY_FOR_LAUNCH_CONFIG:ts,DAILY_EVENT_INPUT_SETTINGS_UPDATED:tn,DAILY_EVENT_JOINED_MEETING:ls,DAILY_EVENT_JOINING_MEETING:cs,DAILY_EVENT_LANG_UPDATED:Ys,DAILY_EVENT_LEFT_MEETING:us,DAILY_EVENT_LIVE_STREAMING_ERROR:Ws,DAILY_EVENT_LIVE_STREAMING_STARTED:$s,DAILY_EVENT_LIVE_STREAMING_STOPPED:Gs,DAILY_EVENT_LIVE_STREAMING_UPDATED:Js,DAILY_EVENT_LOADED:Xr,DAILY_EVENT_LOADING:is,DAILY_EVENT_LOAD_ATTEMPT_FAILED:ss,DAILY_EVENT_LOCAL_SCREEN_SHARE_CANCELED:Rs,DAILY_EVENT_LOCAL_SCREEN_SHARE_STARTED:xs,DAILY_EVENT_LOCAL_SCREEN_SHARE_STOPPED:Ns,DAILY_EVENT_MEETING_SESSION_DATA_ERROR:il,DAILY_EVENT_MEETING_SESSION_STATE_UPDATED:vs,DAILY_EVENT_MEETING_SESSION_SUMMARY_UPDATED:gs,DAILY_EVENT_NETWORK_CONNECTION:qs,DAILY_EVENT_NETWORK_QUALITY_CHANGE:zs,DAILY_EVENT_NONFATAL_ERROR:rn,DAILY_EVENT_PARTICIPANT_COUNTS_UPDATED:fs,DAILY_EVENT_PARTICIPANT_JOINED:ds,DAILY_EVENT_PARTICIPANT_LEFT:ps,DAILY_EVENT_PARTICIPANT_UPDATED:hs,DAILY_EVENT_RECEIVE_SETTINGS_UPDATED:Hs,DAILY_EVENT_RECORDING_DATA:Ms,DAILY_EVENT_RECORDING_ERROR:As,DAILY_EVENT_RECORDING_STARTED:Zr,DAILY_EVENT_RECORDING_STATS:Ts,DAILY_EVENT_RECORDING_STOPPED:en,DAILY_EVENT_RECORDING_UPLOAD_COMPLETED:Os,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STARTED:Ls,DAILY_EVENT_REMOTE_MEDIA_PLAYER_STOPPED:Ds,DAILY_EVENT_REMOTE_MEDIA_PLAYER_UPDATED:js,DAILY_EVENT_STARTED_CAMERA:os,DAILY_EVENT_THEME_UPDATED:ns,DAILY_EVENT_TRACK_STARTED:ws,DAILY_EVENT_TRACK_STOPPED:Ss,DAILY_EVENT_TRANSCRIPTION_ERROR:Cs,DAILY_EVENT_TRANSCRIPTION_MSG:Is,DAILY_EVENT_TRANSCRIPTION_STARTED:Es,DAILY_EVENT_TRANSCRIPTION_STOPPED:ks,DAILY_EVENT_WAITING_PARTICIPANT_ADDED:ys,DAILY_EVENT_WAITING_PARTICIPANT_REMOVED:_s,DAILY_EVENT_WAITING_PARTICIPANT_UPDATED:bs,DAILY_FATAL_ERROR_CONNECTION:es,DAILY_FATAL_ERROR_EJECTED:Bc,DAILY_FATAL_ERROR_EOL:Zi,DAILY_FATAL_ERROR_EXP_ROOM:Gc,DAILY_FATAL_ERROR_EXP_TOKEN:Wc,DAILY_FATAL_ERROR_MEETING_FULL:Yc,DAILY_FATAL_ERROR_NBF_ROOM:$c,DAILY_FATAL_ERROR_NBF_TOKEN:Jc,DAILY_FATAL_ERROR_NOT_ALLOWED:Hc,DAILY_FATAL_ERROR_NO_ROOM:Kr,DAILY_RECEIVE_SETTINGS_ALL_PARTICIPANTS_KEY:Uc,DAILY_RECEIVE_SETTINGS_BASE_KEY:Xi,DAILY_STATE_ERROR:Oe,DAILY_STATE_JOINED:Ne,DAILY_STATE_JOINING:tr,DAILY_STATE_LEFT:Re,DAILY_STATE_NEW:Qr,DAILY_TRACK_STATE_BLOCKED:xc,DAILY_TRACK_STATE_INTERRUPTED:Vc,DAILY_TRACK_STATE_LOADING:Fc,DAILY_TRACK_STATE_OFF:Nc,DAILY_TRACK_STATE_PLAYABLE:Qi,DAILY_TRACK_STATE_SENDABLE:Rc,default:Dl},Symbol.toStringTag,{value:"Module"})));var hr={exports:{}},ta;function Fl(){if(ta)return hr.exports;ta=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(b,A,L){return Function.prototype.apply.call(b,A,L)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))}:r=function(b){return Object.getOwnPropertyNames(b)};function i(y){console&&console.warn&&console.warn(y)}var n=Number.isNaN||function(b){return b!==b};function s(){s.init.call(this)}hr.exports=s,hr.exports.once=S,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function l(y){if(typeof y!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof y)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(y){if(typeof y!="number"||y<0||n(y))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+y+".");a=y}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(b){if(typeof b!="number"||b<0||n(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this};function d(y){return y._maxListeners===void 0?s.defaultMaxListeners:y._maxListeners}s.prototype.getMaxListeners=function(){return d(this)},s.prototype.emit=function(b){for(var A=[],L=1;L<arguments.length;L++)A.push(arguments[L]);var x=b==="error",q=this._events;if(q!==void 0)x=x&&q.error===void 0;else if(!x)return!1;if(x){var F;if(A.length>0&&(F=A[0]),F instanceof Error)throw F;var K=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw K.context=F,K}var j=q[b];if(j===void 0)return!1;if(typeof j=="function")e(j,this,A);else for(var X=j.length,Ie=_(j,X),L=0;L<X;++L)e(Ie[L],this,A);return!0};function h(y,b,A,L){var x,q,F;if(l(A),q=y._events,q===void 0?(q=y._events=Object.create(null),y._eventsCount=0):(q.newListener!==void 0&&(y.emit("newListener",b,A.listener?A.listener:A),q=y._events),F=q[b]),F===void 0)F=q[b]=A,++y._eventsCount;else if(typeof F=="function"?F=q[b]=L?[A,F]:[F,A]:L?F.unshift(A):F.push(A),x=d(y),x>0&&F.length>x&&!F.warned){F.warned=!0;var K=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(b)+" listeners added. Use emitter.setMaxListeners() to increase limit");K.name="MaxListenersExceededWarning",K.emitter=y,K.type=b,K.count=F.length,i(K)}return y}s.prototype.addListener=function(b,A){return h(this,b,A,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(b,A){return h(this,b,A,!0)};function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(y,b,A){var L={fired:!1,wrapFn:void 0,target:y,type:b,listener:A},x=f.bind(L);return x.listener=A,L.wrapFn=x,x}s.prototype.once=function(b,A){return l(A),this.on(b,g(this,b,A)),this},s.prototype.prependOnceListener=function(b,A){return l(A),this.prependListener(b,g(this,b,A)),this},s.prototype.removeListener=function(b,A){var L,x,q,F,K;if(l(A),x=this._events,x===void 0)return this;if(L=x[b],L===void 0)return this;if(L===A||L.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete x[b],x.removeListener&&this.emit("removeListener",b,L.listener||A));else if(typeof L!="function"){for(q=-1,F=L.length-1;F>=0;F--)if(L[F]===A||L[F].listener===A){K=L[F].listener,q=F;break}if(q<0)return this;q===0?L.shift():v(L,q),L.length===1&&(x[b]=L[0]),x.removeListener!==void 0&&this.emit("removeListener",b,K||A)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(b){var A,L,x;if(L=this._events,L===void 0)return this;if(L.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):L[b]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete L[b]),this;if(arguments.length===0){var q=Object.keys(L),F;for(x=0;x<q.length;++x)F=q[x],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=L[b],typeof A=="function")this.removeListener(b,A);else if(A!==void 0)for(x=A.length-1;x>=0;x--)this.removeListener(b,A[x]);return this};function w(y,b,A){var L=y._events;if(L===void 0)return[];var x=L[b];return x===void 0?[]:typeof x=="function"?A?[x.listener||x]:[x]:A?E(x):_(x,x.length)}s.prototype.listeners=function(b){return w(this,b,!0)},s.prototype.rawListeners=function(b){return w(this,b,!1)},s.listenerCount=function(y,b){return typeof y.listenerCount=="function"?y.listenerCount(b):C.call(y,b)},s.prototype.listenerCount=C;function C(y){var b=this._events;if(b!==void 0){var A=b[y];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function _(y,b){for(var A=new Array(b),L=0;L<b;++L)A[L]=y[L];return A}function v(y,b){for(;b+1<y.length;b++)y[b]=y[b+1];y.pop()}function E(y){for(var b=new Array(y.length),A=0;A<b.length;++A)b[A]=y[A].listener||y[A];return b}function S(y,b){return new Promise(function(A,L){function x(F){y.removeListener(b,q),L(F)}function q(){typeof y.removeListener=="function"&&y.removeListener("error",x),A([].slice.call(arguments))}I(y,b,q,{once:!0}),b!=="error"&&O(y,x,{once:!0})})}function O(y,b,A){typeof y.on=="function"&&I(y,"error",b,A)}function I(y,b,A,L){if(typeof y.on=="function")L.once?y.once(b,A):y.on(b,A);else if(typeof y.addEventListener=="function")y.addEventListener(b,function x(q){L.once&&y.removeEventListener(b,x),A(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof y)}return hr.exports}var Ct={},Pe={},ra;function Vl(){if(ra)return Pe;ra=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.Api=Pe.HttpClient=Pe.ContentType=void 0;var t;(function(i){i.Json="application/json",i.JsonApi="application/vnd.api+json",i.FormData="multipart/form-data",i.UrlEncoded="application/x-www-form-urlencoded",i.Text="text/plain"})(t||(Pe.ContentType=t={}));class e{baseUrl="https://api.vapi.ai";securityData=null;securityWorker;abortControllers=new Map;customFetch=(...n)=>fetch(...n);baseApiParams={credentials:"same-origin",headers:{},redirect:"follow",referrerPolicy:"no-referrer"};constructor(n={}){Object.assign(this,n)}setSecurityData=n=>{this.securityData=n};encodeQueryParam(n,s){return`${encodeURIComponent(n)}=${encodeURIComponent(typeof s=="number"?s:`${s}`)}`}addQueryParam(n,s){return this.encodeQueryParam(s,n[s])}addArrayQueryParam(n,s){return n[s].map(l=>this.encodeQueryParam(s,l)).join("&")}toQueryString(n){const s=n||{};return Object.keys(s).filter(l=>typeof s[l]<"u").map(l=>Array.isArray(s[l])?this.addArrayQueryParam(s,l):this.addQueryParam(s,l)).join("&")}addQueryParams(n){const s=this.toQueryString(n);return s?`?${s}`:""}contentFormatters={[t.Json]:n=>n!==null&&(typeof n=="object"||typeof n=="string")?JSON.stringify(n):n,[t.JsonApi]:n=>n!==null&&(typeof n=="object"||typeof n=="string")?JSON.stringify(n):n,[t.Text]:n=>n!==null&&typeof n!="string"?JSON.stringify(n):n,[t.FormData]:n=>Object.keys(n||{}).reduce((s,a)=>{const l=n[a];return s.append(a,l instanceof Blob?l:typeof l=="object"&&l!==null?JSON.stringify(l):`${l}`),s},new FormData),[t.UrlEncoded]:n=>this.toQueryString(n)};mergeRequestParams(n,s){return{...this.baseApiParams,...n,...s||{},headers:{...this.baseApiParams.headers||{},...n.headers||{},...s&&s.headers||{}}}}createAbortSignal=n=>{if(this.abortControllers.has(n)){const a=this.abortControllers.get(n);return a?a.signal:void 0}const s=new AbortController;return this.abortControllers.set(n,s),s.signal};abortRequest=n=>{const s=this.abortControllers.get(n);s&&(s.abort(),this.abortControllers.delete(n))};request=async({body:n,secure:s,path:a,type:l,query:d,format:h,baseUrl:f,cancelToken:g,...w})=>{const C=(typeof s=="boolean"?s:this.baseApiParams.secure)&&this.securityWorker&&await this.securityWorker(this.securityData)||{},_=this.mergeRequestParams(w,C),v=d&&this.toQueryString(d),E=this.contentFormatters[l||t.Json],S=h||_.format;return this.customFetch(`${f||this.baseUrl||""}${a}${v?`?${v}`:""}`,{..._,headers:{..._.headers||{},...l&&l!==t.FormData?{"Content-Type":l}:{}},signal:(g?this.createAbortSignal(g):_.signal)||null,body:typeof n>"u"||n===null?null:E(n)}).then(async O=>{const I=O.clone();I.data=null,I.error=null;const y=S?await O[S]().then(b=>(I.ok?I.data=b:I.error=b,I)).catch(b=>(I.error=b,I)):I;if(g&&this.abortControllers.delete(g),!O.ok)throw y;return y})}}Pe.HttpClient=e;class r extends e{call={callControllerCreate:(n,s={})=>this.request({path:"/call",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),callControllerFindAll:(n,s={})=>this.request({path:"/call",method:"GET",query:n,secure:!0,format:"json",...s}),callControllerFindOne:(n,s={})=>this.request({path:`/call/${n}`,method:"GET",secure:!0,format:"json",...s}),callControllerUpdate:(n,s,a={})=>this.request({path:`/call/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),callControllerDeleteCallData:(n,s={})=>this.request({path:`/call/${n}`,method:"DELETE",secure:!0,format:"json",...s}),callControllerCreatePhoneCall:(n,s={})=>this.request({path:"/call/phone",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),callControllerCreateWebCall:(n,s={})=>this.request({path:"/call/web",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s})};v2={callControllerExportCalls:(n,s={})=>this.request({path:"/v2/call/export",method:"GET",query:n,secure:!0,...s}),callControllerFindAllPaginated:(n,s={})=>this.request({path:"/v2/call",method:"GET",query:n,secure:!0,format:"json",...s}),callControllerFindAllMetadataPaginated:(n,s={})=>this.request({path:"/v2/call/metadata",method:"GET",query:n,secure:!0,format:"json",...s}),assistantControllerFindAllPaginated:(n,s={})=>this.request({path:"/v2/assistant",method:"GET",query:n,secure:!0,format:"json",...s}),phoneNumberControllerFindAllPaginated:(n,s={})=>this.request({path:"/v2/phone-number",method:"GET",query:n,secure:!0,format:"json",...s})};chat={chatControllerListChats:(n,s={})=>this.request({path:"/chat",method:"GET",query:n,secure:!0,format:"json",...s}),chatControllerCreateChat:(n,s={})=>this.request({path:"/chat",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),chatControllerGetChat:(n,s={})=>this.request({path:`/chat/${n}`,method:"GET",secure:!0,format:"json",...s}),chatControllerDeleteChat:(n,s={})=>this.request({path:`/chat/${n}`,method:"DELETE",secure:!0,format:"json",...s}),chatControllerCreateOpenAiChat:(n,s={})=>this.request({path:"/chat/responses",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),chatControllerCreateWebChat:(n,s={})=>this.request({path:"/chat/web",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),chatControllerCreateOpenAiWebChat:(n,s={})=>this.request({path:"/chat/web/responses",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s})};campaign={campaignControllerCreate:(n,s={})=>this.request({path:"/campaign",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),campaignControllerFindAll:(n,s={})=>this.request({path:"/campaign",method:"GET",query:n,secure:!0,format:"json",...s}),campaignControllerFindAllPaginated:(n,s={})=>this.request({path:"/campaign/paginated",method:"GET",query:n,secure:!0,format:"json",...s}),campaignControllerFindOne:(n,s={})=>this.request({path:`/campaign/${n}`,method:"GET",secure:!0,format:"json",...s}),campaignControllerUpdate:(n,s,a={})=>this.request({path:`/campaign/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),campaignControllerRemove:(n,s={})=>this.request({path:`/campaign/${n}`,method:"DELETE",secure:!0,format:"json",...s})};session={sessionControllerCreate:(n,s={})=>this.request({path:"/session",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),sessionControllerFindAllPaginated:(n,s={})=>this.request({path:"/session",method:"GET",query:n,secure:!0,format:"json",...s}),sessionControllerFindOne:(n,s={})=>this.request({path:`/session/${n}`,method:"GET",secure:!0,format:"json",...s}),sessionControllerUpdate:(n,s,a={})=>this.request({path:`/session/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),sessionControllerRemove:(n,s={})=>this.request({path:`/session/${n}`,method:"DELETE",secure:!0,format:"json",...s})};support={supportControllerCreateTicket:(n,s={})=>this.request({path:"/support/ticket",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s})};assistant={assistantControllerCreate:(n,s={})=>this.request({path:"/assistant",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),assistantControllerFindAll:(n,s={})=>this.request({path:"/assistant",method:"GET",query:n,secure:!0,format:"json",...s}),assistantControllerFindOne:(n,s={})=>this.request({path:`/assistant/${n}`,method:"GET",secure:!0,format:"json",...s}),assistantControllerUpdate:(n,s,a={})=>this.request({path:`/assistant/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),assistantControllerReplace:(n,s,a={})=>this.request({path:`/assistant/${n}`,method:"PUT",body:s,secure:!0,type:t.Json,format:"json",...a}),assistantControllerRemove:(n,s={})=>this.request({path:`/assistant/${n}`,method:"DELETE",secure:!0,format:"json",...s}),assistantControllerFindVersions:(n,s,a={})=>this.request({path:`/assistant/${n}/version`,method:"GET",query:s,secure:!0,format:"json",...a})};phoneNumber={phoneNumberControllerImportTwilio:(n,s={})=>this.request({path:"/phone-number/import/twilio",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),phoneNumberControllerImportVonage:(n,s={})=>this.request({path:"/phone-number/import/vonage",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),phoneNumberControllerCreate:(n,s={})=>this.request({path:"/phone-number",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),phoneNumberControllerFindAll:(n,s={})=>this.request({path:"/phone-number",method:"GET",query:n,secure:!0,format:"json",...s}),phoneNumberControllerFindOne:(n,s={})=>this.request({path:`/phone-number/${n}`,method:"GET",secure:!0,format:"json",...s}),phoneNumberControllerUpdate:(n,s,a={})=>this.request({path:`/phone-number/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),phoneNumberControllerRemove:(n,s={})=>this.request({path:`/phone-number/${n}`,method:"DELETE",secure:!0,format:"json",...s})};tool={toolControllerCreate:(n,s={})=>this.request({path:"/tool",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),toolControllerFindAll:(n,s={})=>this.request({path:"/tool",method:"GET",query:n,secure:!0,format:"json",...s}),toolControllerFindOne:(n,s={})=>this.request({path:`/tool/${n}`,method:"GET",secure:!0,format:"json",...s}),toolControllerUpdate:(n,s,a={})=>this.request({path:`/tool/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),toolControllerRemove:(n,s={})=>this.request({path:`/tool/${n}`,method:"DELETE",secure:!0,format:"json",...s})};file={fileControllerCreateDeprecated:(n,s={})=>this.request({path:"/file/upload",method:"POST",body:n,secure:!0,type:t.FormData,format:"json",...s}),fileControllerCreate:(n,s={})=>this.request({path:"/file",method:"POST",body:n,secure:!0,type:t.FormData,format:"json",...s}),fileControllerFindAll:(n={})=>this.request({path:"/file",method:"GET",secure:!0,format:"json",...n}),fileControllerFindOne:(n,s={})=>this.request({path:`/file/${n}`,method:"GET",secure:!0,format:"json",...s}),fileControllerUpdate:(n,s,a={})=>this.request({path:`/file/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),fileControllerRemove:(n,s={})=>this.request({path:`/file/${n}`,method:"DELETE",secure:!0,format:"json",...s})};knowledgeBase={knowledgeBaseControllerCreate:(n,s={})=>this.request({path:"/knowledge-base",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),knowledgeBaseControllerFindAll:(n,s={})=>this.request({path:"/knowledge-base",method:"GET",query:n,secure:!0,format:"json",...s}),knowledgeBaseControllerFindOne:(n,s={})=>this.request({path:`/knowledge-base/${n}`,method:"GET",secure:!0,format:"json",...s}),knowledgeBaseControllerUpdate:(n,s,a={})=>this.request({path:`/knowledge-base/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),knowledgeBaseControllerRemove:(n,s={})=>this.request({path:`/knowledge-base/${n}`,method:"DELETE",secure:!0,format:"json",...s})};workflow={workflowControllerFindAll:(n={})=>this.request({path:"/workflow",method:"GET",secure:!0,format:"json",...n}),workflowControllerCreate:(n,s={})=>this.request({path:"/workflow",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),workflowControllerFindOne:(n,s={})=>this.request({path:`/workflow/${n}`,method:"GET",secure:!0,format:"json",...s}),workflowControllerDelete:(n,s={})=>this.request({path:`/workflow/${n}`,method:"DELETE",secure:!0,format:"json",...s}),workflowControllerUpdate:(n,s,a={})=>this.request({path:`/workflow/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),workflowControllerGenerateFromTranscripts:(n,s={})=>this.request({path:"/workflow/generate",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s})};squad={squadControllerCreate:(n,s={})=>this.request({path:"/squad",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),squadControllerFindAll:(n,s={})=>this.request({path:"/squad",method:"GET",query:n,secure:!0,format:"json",...s}),squadControllerFindOne:(n,s={})=>this.request({path:`/squad/${n}`,method:"GET",secure:!0,format:"json",...s}),squadControllerUpdate:(n,s,a={})=>this.request({path:`/squad/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),squadControllerRemove:(n,s={})=>this.request({path:`/squad/${n}`,method:"DELETE",secure:!0,format:"json",...s})};testSuite={testSuiteControllerFindAllPaginated:(n,s={})=>this.request({path:"/test-suite",method:"GET",query:n,secure:!0,format:"json",...s}),testSuiteControllerCreate:(n,s={})=>this.request({path:"/test-suite",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),testSuiteControllerFindOne:(n,s={})=>this.request({path:`/test-suite/${n}`,method:"GET",secure:!0,format:"json",...s}),testSuiteControllerUpdate:(n,s,a={})=>this.request({path:`/test-suite/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),testSuiteControllerRemove:(n,s={})=>this.request({path:`/test-suite/${n}`,method:"DELETE",secure:!0,format:"json",...s}),testSuiteTestControllerFindAllPaginated:(n,s,a={})=>this.request({path:`/test-suite/${n}/test`,method:"GET",query:s,secure:!0,format:"json",...a}),testSuiteTestControllerCreate:(n,s,a={})=>this.request({path:`/test-suite/${n}/test`,method:"POST",body:s,secure:!0,type:t.Json,format:"json",...a}),testSuiteTestControllerFindOne:(n,s,a={})=>this.request({path:`/test-suite/${n}/test/${s}`,method:"GET",secure:!0,format:"json",...a}),testSuiteTestControllerUpdate:(n,s,a,l={})=>this.request({path:`/test-suite/${n}/test/${s}`,method:"PATCH",body:a,secure:!0,type:t.Json,format:"json",...l}),testSuiteTestControllerRemove:(n,s,a={})=>this.request({path:`/test-suite/${n}/test/${s}`,method:"DELETE",secure:!0,format:"json",...a}),testSuiteRunControllerFindAllPaginated:(n,s,a={})=>this.request({path:`/test-suite/${n}/run`,method:"GET",query:s,secure:!0,format:"json",...a}),testSuiteRunControllerCreate:(n,s,a={})=>this.request({path:`/test-suite/${n}/run`,method:"POST",body:s,secure:!0,type:t.Json,format:"json",...a}),testSuiteRunControllerFindOne:(n,s,a={})=>this.request({path:`/test-suite/${n}/run/${s}`,method:"GET",secure:!0,format:"json",...a}),testSuiteRunControllerUpdate:(n,s,a,l={})=>this.request({path:`/test-suite/${n}/run/${s}`,method:"PATCH",body:a,secure:!0,type:t.Json,format:"json",...l}),testSuiteRunControllerRemove:(n,s,a={})=>this.request({path:`/test-suite/${n}/run/${s}`,method:"DELETE",secure:!0,format:"json",...a})};analytics={analyticsControllerQuery:(n,s={})=>this.request({path:"/analytics",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s})};log={loggingControllerCallLogsQuery:(n,s={})=>this.request({path:"/log",method:"GET",query:n,secure:!0,format:"json",...s}),loggingControllerCallLogsDeleteQuery:(n,s={})=>this.request({path:"/log",method:"DELETE",query:n,secure:!0,...s})};logs={loggingControllerLogsQuery:(n,s={})=>this.request({path:"/logs",method:"GET",query:n,secure:!0,format:"json",...s}),loggingControllerLogsDeleteQuery:(n,s={})=>this.request({path:"/logs",method:"DELETE",query:n,secure:!0,...s})};org={orgControllerCreate:(n,s={})=>this.request({path:"/org",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),orgControllerFindAll:(n={})=>this.request({path:"/org",method:"GET",secure:!0,format:"json",...n}),orgControllerFindOne:(n,s={})=>this.request({path:`/org/${n}`,method:"GET",secure:!0,format:"json",...s}),orgControllerUpdate:(n,s,a={})=>this.request({path:`/org/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),orgControllerDeleteOrg:(n,s={})=>this.request({path:`/org/${n}`,method:"DELETE",secure:!0,...s}),orgControllerFindAllUsers:(n,s={})=>this.request({path:`/org/${n}/user`,method:"GET",secure:!0,format:"json",...s}),orgControllerOrgLeave:(n,s={})=>this.request({path:`/org/${n}/leave`,method:"DELETE",secure:!0,...s}),orgControllerOrgRemoveUser:(n,s,a={})=>this.request({path:`/org/${n}/member/${s}/leave`,method:"DELETE",secure:!0,...a}),orgControllerUsersInvite:(n,s,a={})=>this.request({path:`/org/${n}/invite`,method:"POST",body:s,secure:!0,type:t.Json,...a}),orgControllerUserUpdate:(n,s,a={})=>this.request({path:`/org/${n}/role`,method:"PATCH",body:s,secure:!0,type:t.Json,...a}),orgControllerOrgToken:(n,s={})=>this.request({path:`/org/${n}/auth`,method:"GET",secure:!0,format:"json",...s})};token={tokenControllerCreate:(n,s={})=>this.request({path:"/token",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),tokenControllerFindAll:(n,s={})=>this.request({path:"/token",method:"GET",query:n,secure:!0,format:"json",...s}),tokenControllerFindOne:(n,s={})=>this.request({path:`/token/${n}`,method:"GET",secure:!0,format:"json",...s}),tokenControllerUpdate:(n,s,a={})=>this.request({path:`/token/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),tokenControllerRemove:(n,s={})=>this.request({path:`/token/${n}`,method:"DELETE",secure:!0,format:"json",...s})};credential={credentialControllerCreate:(n,s={})=>this.request({path:"/credential",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),credentialControllerFindAll:(n,s={})=>this.request({path:"/credential",method:"GET",query:n,secure:!0,format:"json",...s}),credentialControllerFindOne:(n,s={})=>this.request({path:`/credential/${n}`,method:"GET",secure:!0,format:"json",...s}),credentialControllerUpdate:(n,s,a={})=>this.request({path:`/credential/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),credentialControllerRemove:(n,s={})=>this.request({path:`/credential/${n}`,method:"DELETE",secure:!0,format:"json",...s}),credentialControllerGenerateSession:(n,s={})=>this.request({path:"/credential/session",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),credentialControllerHandleWebhook:(n,s={})=>this.request({path:"/credential/webhook",method:"POST",body:n,type:t.Json,...s}),credentialControllerCredentialActionTrigger:(n,s={})=>this.request({path:"/credential/trigger",method:"POST",body:n,secure:!0,type:t.Json,...s})};template={templateControllerCreate:(n,s={})=>this.request({path:"/template",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),templateControllerFindAll:(n,s={})=>this.request({path:"/template",method:"GET",query:n,secure:!0,format:"json",...s}),templateControllerFindAllPinned:(n={})=>this.request({path:"/template/pinned",method:"GET",secure:!0,format:"json",...n}),templateControllerFindOne:(n,s={})=>this.request({path:`/template/${n}`,method:"GET",secure:!0,format:"json",...s}),templateControllerUpdate:(n,s,a={})=>this.request({path:`/template/${n}`,method:"PATCH",body:s,secure:!0,type:t.Json,format:"json",...a}),templateControllerRemove:(n,s={})=>this.request({path:`/template/${n}`,method:"DELETE",secure:!0,format:"json",...s})};voiceLibrary={voiceLibraryControllerVoiceGetByProvider:(n,s,a={})=>this.request({path:`/voice-library/${n}`,method:"GET",query:s,secure:!0,format:"json",...a}),voiceLibraryControllerVoiceGetAccentsByProvider:(n,s={})=>this.request({path:`/voice-library/${n}/accents`,method:"GET",secure:!0,format:"json",...s}),voiceLibraryControllerVoiceLibrarySyncByProvider:(n,s={})=>this.request({path:`/voice-library/sync/${n}`,method:"POST",secure:!0,format:"json",...s}),voiceLibraryControllerVoiceLibrarySyncDefaultVoices:(n,s={})=>this.request({path:"/voice-library/sync",method:"POST",body:n,secure:!0,type:t.Json,format:"json",...s}),voiceLibraryControllerVoiceLibraryCreateSesameVoice:(n,s={})=>this.request({path:"/voice-library/create-sesame-voice",method:"POST",body:n,secure:!0,type:t.Json,...s})};provider={providerControllerGetWorkflows:(n,s,a={})=>this.request({path:`/${n}/workflows`,method:"GET",query:s,secure:!0,format:"json",...a}),providerControllerGetWorkflowTriggerHook:(n,s,a={})=>this.request({path:`/${n}/workflows/${s}/hooks`,method:"GET",secure:!0,format:"json",...a}),providerControllerGetLocations:(n,s={})=>this.request({path:`/${n}/locations`,method:"GET",secure:!0,format:"json",...s}),voiceProviderControllerSearchVoices:(n,s,a={})=>this.request({path:`/${n}/voices/search`,method:"GET",query:s,secure:!0,format:"json",...a}),voiceProviderControllerSearchVoice:(n,s,a={})=>this.request({path:`/${n}/voice/search`,method:"GET",query:s,secure:!0,format:"json",...a}),voiceProviderControllerAddVoices:(n,s,a={})=>this.request({path:`/${n}/voices/add`,method:"POST",body:s,secure:!0,type:t.Json,format:"json",...a}),voiceProviderControllerAddVoice:(n,s,a={})=>this.request({path:`/${n}/voice/add`,method:"POST",body:s,secure:!0,type:t.Json,format:"json",...a})};v11Labs={voiceProviderControllerCloneVoices:(n,s={})=>this.request({path:"/11labs/voice/clone",method:"POST",body:n,secure:!0,type:t.FormData,...s})}}return Pe.Api=r,Pe}var na;function zl(){if(na)return Ct;na=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.client=void 0;const t=Vl(),e=new t.Api({baseUrl:"https://api.vapi.ai",baseApiParams:{secure:!0},securityWorker:async r=>{if(r)return{headers:{Authorization:`Bearer ${r}`}}}});return Ct.client=e,Ct}var ia;function ql(){if(ia)return tt;ia=1;var t=tt&&tt.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(tt,"__esModule",{value:!0});const e=t(Rl),r=t(Fl()),i=zl();async function n(f,g){f.muted=!1,f.autoplay=!0,g!=null&&(f.srcObject=new MediaStream([g]),await f.play())}async function s(f,g){const w=document.createElement("audio");return w.dataset.participantId=g,document.body.appendChild(w),await n(w,f),w}function a(f){document.querySelector(`audio[data-participant-id="${f}"]`)?.remove()}function l(f,g,w,C){f.participant.local||g.updateParticipant(f.participant.session_id,{setSubscribedTracks:{audio:!0,video:w||C}})}class d extends r.default{on(g,w){return super.on(g,w),this}once(g,w){return super.once(g,w),this}emit(g,...w){return super.emit(g,...w)}removeListener(g,w){return super.removeListener(g,w),this}removeAllListeners(g){return super.removeAllListeners(g),this}}class h extends d{started=!1;call=null;speakingTimeout=null;dailyCallConfig={};dailyCallObject={};hasEmittedCallEndedStatus=!1;constructor(g,w,C,_){super(),i.client.baseUrl=w??"https://api.vapi.ai",i.client.setSecurityData(g),this.dailyCallConfig=C??{},this.dailyCallObject=_??{}}cleanup(){this.started=!1,this.hasEmittedCallEndedStatus=!1,this.call?.destroy(),this.call=null,this.speakingTimeout=null}isMobileDevice(){if(typeof navigator>"u")return!1;const g=navigator.userAgent;return/android|iphone|ipad|ipod|iemobile|blackberry|bada/i.test(g.toLowerCase())}async sleep(g){return new Promise(w=>setTimeout(w,g))}async start(g,w,C,_,v){const E=Date.now();if(!g&&!C&&!_){const S=new Error("Assistant or Squad or Workflow must be provided.");throw this.emit("error",{type:"validation-error",stage:"input-validation",message:S.message,timestamp:new Date().toISOString()}),S}if(this.started)return this.emit("call-start-progress",{stage:"validation",status:"failed",timestamp:new Date().toISOString(),metadata:{reason:"already-started"}}),null;this.emit("call-start-progress",{stage:"initialization",status:"started",timestamp:new Date().toISOString(),metadata:{hasAssistant:!!g,hasSquad:!!C,hasWorkflow:!!_}}),this.started=!0;try{this.emit("call-start-progress",{stage:"web-call-creation",status:"started",timestamp:new Date().toISOString()});const S=Date.now(),O=(await i.client.call.callControllerCreateWebCall({assistant:typeof g=="string"?void 0:g,assistantId:typeof g=="string"?g:void 0,assistantOverrides:w,squad:typeof C=="string"?void 0:C,squadId:typeof C=="string"?C:void 0,workflow:typeof _=="string"?void 0:_,workflowId:typeof _=="string"?_:void 0,workflowOverrides:v})).data,I=Date.now()-S;this.emit("call-start-progress",{stage:"web-call-creation",status:"completed",duration:I,timestamp:new Date().toISOString(),metadata:{callId:O?.id||"unknown",videoRecordingEnabled:O?.artifactPlan?.videoRecordingEnabled??!1,voiceProvider:O?.assistant?.voice?.provider||"unknown"}}),this.call&&(this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{action:"cleanup-existing"}}),this.cleanup());const y=O?.artifactPlan?.videoRecordingEnabled??!1,b=O?.assistant?.voice?.provider==="tavus";this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"started",timestamp:new Date().toISOString(),metadata:{audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??y,isVideoRecordingEnabled:y,isVideoEnabled:b}});const A=Date.now();try{this.call=e.default.createCallObject({audioSource:this.dailyCallObject.audioSource??!0,videoSource:this.dailyCallObject.videoSource??y,dailyConfig:this.dailyCallConfig});const j=Date.now()-A;this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"completed",duration:j,timestamp:new Date().toISOString()})}catch(j){const X=Date.now()-A;throw this.emit("call-start-progress",{stage:"daily-call-object-creation",status:"failed",duration:X,timestamp:new Date().toISOString(),metadata:{error:j?.toString()}}),this.emit("error",{type:"daily-call-object-creation-error",stage:"daily-call-object-creation",error:j,timestamp:new Date().toISOString()}),j}this.call.iframe()?.style.setProperty("display","none"),this.call.on("left-meeting",()=>{this.emit("call-end"),this.hasEmittedCallEndedStatus||(this.emit("message",{type:"status-update",status:"ended",endedReason:"customer-ended-call"}),this.hasEmittedCallEndedStatus=!0),y&&this.call?.stopRecording(),this.cleanup()}),this.call.on("error",j=>{this.emit("error",j),y&&this.call?.stopRecording()}),this.call.on("camera-error",j=>{this.emit("camera-error",j)}),this.call.on("network-quality-change",j=>{this.emit("network-quality-change",j)}),this.call.on("network-connection",j=>{this.emit("network-connection",j)}),this.call.on("track-started",async j=>{!j||!j.participant||j.participant?.local||j.participant?.user_name==="Vapi Speaker"&&(j.track.kind==="video"&&this.emit("video",j.track),j.track.kind==="audio"&&await s(j.track,j.participant.session_id),this.call?.sendAppMessage("playable"))}),this.call.on("participant-joined",j=>{!j||!this.call||l(j,this.call,y,b)}),this.call.on("participant-updated",j=>{j&&this.emit("daily-participant-updated",j.participant)}),this.call.on("participant-left",j=>{j&&a(j.participant.session_id)});const L=this.isMobileDevice();if(this.emit("call-start-progress",{stage:"mobile-permissions",status:"started",timestamp:new Date().toISOString(),metadata:{isMobile:L}}),L){const j=Date.now();await this.sleep(1e3);const X=Date.now()-j;this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",duration:X,timestamp:new Date().toISOString(),metadata:{action:"permissions-wait"}})}else this.emit("call-start-progress",{stage:"mobile-permissions",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-mobile"}});this.emit("call-start-progress",{stage:"daily-call-join",status:"started",timestamp:new Date().toISOString()});const x=Date.now();try{await this.call.join({url:O.webCallUrl,subscribeToTracksAutomatically:!1});const j=Date.now()-x;this.emit("call-start-progress",{stage:"daily-call-join",status:"completed",duration:j,timestamp:new Date().toISOString()})}catch(j){const X=Date.now()-x;throw this.emit("call-start-progress",{stage:"daily-call-join",status:"failed",duration:X,timestamp:new Date().toISOString(),metadata:{error:j?.toString()}}),this.emit("error",{type:"daily-call-join-error",stage:"daily-call-join",error:j,duration:X,timestamp:new Date().toISOString()}),j}if(y){this.emit("call-start-progress",{stage:"video-recording-setup",status:"started",timestamp:new Date().toISOString()});const j=new Date().getTime(),X=Date.now();try{this.call.startRecording({width:1280,height:720,backgroundColor:"#FF1F2D3D",layout:{preset:"default"}});const Ie=Date.now()-X;this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",duration:Ie,timestamp:new Date().toISOString()}),this.call.on("recording-started",()=>{const Xe=(new Date().getTime()-j)/1e3;this.emit("call-start-progress",{stage:"video-recording-started",status:"completed",timestamp:new Date().toISOString(),metadata:{delaySeconds:Xe}}),this.send({type:"control",control:"say-first-message",videoRecordingStartDelaySeconds:Xe})})}catch(Ie){const Xe=Date.now()-X;this.emit("call-start-progress",{stage:"video-recording-setup",status:"failed",duration:Xe,timestamp:new Date().toISOString(),metadata:{error:Ie?.toString()}}),this.emit("error",{type:"video-recording-setup-error",stage:"video-recording-setup",error:Ie,timestamp:new Date().toISOString()})}}else this.emit("call-start-progress",{stage:"video-recording-setup",status:"completed",timestamp:new Date().toISOString(),metadata:{action:"skipped-not-enabled"}});this.emit("call-start-progress",{stage:"audio-observer-setup",status:"started",timestamp:new Date().toISOString()});const q=Date.now();try{this.call.startRemoteParticipantsAudioLevelObserver(100);const j=Date.now()-q;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"completed",duration:j,timestamp:new Date().toISOString()})}catch(j){const X=Date.now()-q;this.emit("call-start-progress",{stage:"audio-observer-setup",status:"failed",duration:X,timestamp:new Date().toISOString(),metadata:{error:j?.toString()}}),this.emit("error",{type:"audio-observer-setup-error",stage:"audio-observer-setup",error:j,timestamp:new Date().toISOString()})}this.call.on("remote-participants-audio-level",j=>{j&&this.handleRemoteParticipantsAudioLevel(j)}),this.call.on("app-message",j=>this.onAppMessage(j)),this.call.on("nonfatal-error",j=>{j?.type==="audio-processor-error"&&this.call?.updateInputSettings({audio:{processor:{type:"none"}}}).then(()=>{this.call?.setLocalAudio(!0)})}),this.emit("call-start-progress",{stage:"audio-processing-setup",status:"started",timestamp:new Date().toISOString()});const F=Date.now();try{this.call.updateInputSettings({audio:{processor:{type:"noise-cancellation"}}});const j=Date.now()-F;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"completed",duration:j,timestamp:new Date().toISOString()})}catch(j){const X=Date.now()-F;this.emit("call-start-progress",{stage:"audio-processing-setup",status:"failed",duration:X,timestamp:new Date().toISOString(),metadata:{error:j?.toString()}}),this.emit("error",{type:"audio-processing-setup-error",stage:"audio-processing-setup",error:j,timestamp:new Date().toISOString()})}const K=Date.now()-E;return this.emit("call-start-success",{totalDuration:K,callId:O?.id||"unknown",timestamp:new Date().toISOString()}),O}catch(S){const O=Date.now()-E;return this.emit("call-start-failed",{stage:"unknown",totalDuration:O,error:S?.toString()||"Unknown error occurred",errorStack:S instanceof Error?S.stack:"No stack trace available",timestamp:new Date().toISOString(),context:{hasAssistant:!!g,hasSquad:!!C,hasWorkflow:!!_,isMobile:this.isMobileDevice()}}),this.emit("error",{type:"start-method-error",stage:"unknown",error:S,totalDuration:O,timestamp:new Date().toISOString(),context:{hasAssistant:!!g,hasSquad:!!C,hasWorkflow:!!_,isMobile:this.isMobileDevice()}}),this.cleanup(),null}}onAppMessage(g){if(g)try{if(g.data==="listening")return this.emit("call-start");try{const w=JSON.parse(g.data);this.emit("message",w),w&&"type"in w&&"status"in w&&w.type==="status-update"&&w.status==="ended"&&(this.hasEmittedCallEndedStatus=!0)}catch(w){console.log("Error parsing message data: ",w)}}catch(w){console.error(w)}}handleRemoteParticipantsAudioLevel(g){const w=Object.values(g.participantsAudioLevel).reduce((_,v)=>_+v,0);this.emit("volume-level",Math.min(1,w/.15)),w>.01&&(this.speakingTimeout?(clearTimeout(this.speakingTimeout),this.speakingTimeout=null):this.emit("speech-start"),this.speakingTimeout=setTimeout(()=>{this.emit("speech-end"),this.speakingTimeout=null},1e3))}stop(){this.started=!1,this.call?.destroy(),this.call=null}send(g){this.call?.sendAppMessage(JSON.stringify(g))}setMuted(g){if(!this.call)throw new Error("Call object is not available.");this.call.setLocalAudio(!g)}isMuted(){return this.call?this.call.localAudio()===!1:!1}say(g,w,C,_){this.send({type:"say",message:g,endCallAfterSpoken:w,interruptionsEnabled:C??!1,interruptAssistantEnabled:_??!1})}setInputDevicesAsync(g){this.call?.setInputDevicesAsync(g)}async increaseMicLevel(g){if(!this.call)throw new Error("Call object is not available.");try{const w=await navigator.mediaDevices.getUserMedia({audio:!0}),C=new AudioContext,_=C.createMediaStreamSource(w),v=C.createGain();v.gain.value=g,_.connect(v);const E=C.createMediaStreamDestination();v.connect(E);const[S]=E.stream.getAudioTracks();await this.call.setInputDevicesAsync({audioSource:S})}catch(w){console.error("Error adjusting microphone level:",w)}}setOutputDeviceAsync(g){this.call?.setOutputDeviceAsync(g)}getDailyCallObject(){return this.call}startScreenSharing(g,w){this.call?.startScreenShare({displayMediaOptions:g,screenVideoSendSettings:w})}stopScreenSharing(){this.call?.stopScreenShare()}}return tt.default=h,tt}var Ul=ql();const Bl=pa(Ul);class kn{constructor(e){this.config=e,this.vapi=null,this.isCallActive=!1,this.eventListeners=new Map,this.initVapi()}initVapi(){this.vapi=new Bl(this.config.token),this.setupEventListeners()}setupEventListeners(){this.vapi&&(this.vapi.on("call-start",()=>{this.isCallActive=!0,this.emit("call-start")}),this.vapi.on("speech-start",()=>{this.emit("speech-start")}),this.vapi.on("speech-end",()=>{this.emit("speech-end")}),this.vapi.on("call-end",()=>{this.isCallActive=!1,this.emit("call-end")}),this.vapi.on("error",e=>{console.error("Vapi error:",e),this.isCallActive=!1,this.emit("error",e)}),this.vapi.on("volume-level",e=>{this.emit("volume-level",e)}),this.vapi.on("message",e=>{this.emit("message",e)}))}async start(){if(!this.vapi)throw new Error("Vapi client not initialized");if(this.isCallActive){console.warn("Call is already active");return}try{await this.vapi.start(this.config.id)}catch(e){throw console.error("Failed to start Vapi call:",e),e}}stop(){if(!(!this.vapi||!this.isCallActive))try{this.vapi.stop()}catch(e){console.error("Failed to stop Vapi call:",e)}}on(e,r){this.eventListeners.has(e)||this.eventListeners.set(e,[]),this.eventListeners.get(e).push(r)}off(e,r){if(!this.eventListeners.has(e))return;const i=this.eventListeners.get(e),n=i.indexOf(r);n>-1&&i.splice(n,1)}emit(e,r){this.eventListeners.has(e)&&this.eventListeners.get(e).forEach(i=>{try{i(r)}catch(n){console.error(`Error in event listener for ${e}:`,n)}})}destroy(){this.vapi&&(this.stop(),this.vapi=null),this.eventListeners.clear()}}const $l="https://api.buzzwald.com/api/auth/jwt";class Jl{constructor(e={}){this.config={id:"",token:"",phoneNumber:"",position:"bottom-right",backgroundColor:"#FFFF00",iconColor:"#000000",size:"medium",customSize:null,...e},this.vapi=null,this.widgetElement=null,this.buttonElement=null,this.isInitialized=!1,this.currentCallState="idle",this.retryCount=0,this.maxRetries=3,this.usageLimitRetryTimer=null,this.usageLimitRetryAttempts=0,this.maxUsageLimitRetries=10,this.init()}async init(){if(this.isInitialized){console.warn("Buzzwald widget is already initialized");return}try{await this.ensureToken(),this.validateConfig(),this.checkBrowserSupport(),this.injectStyles(),this.createWidget(),this.initializeVapi(),this.isInitialized=!0}catch(e){console.error("Buzzwald: Failed to initialize widget",e),this.handleInitializationError(e)}}async ensureToken(){if(!this.config.token){if(!this.config.id)throw new Error("ID is required to fetch JWT token");try{this.config.token=await this.fetchJwt(this.config.id)}catch(e){throw e.isUsageLimit?e:new Error("Failed to fetch authentication token: "+(e.message||e))}}}async fetchJwt(e){try{const r=await fetch($l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assistant_id:e}),credentials:"include"}),i=await r.json().catch(()=>({}));if(r.status===402||i.error){const n=new Error(i.error||`Usage limit exceeded (${r.status})`);throw n.isUsageLimit=!0,n}if(!r.ok)throw new Error(i.message||`Failed to fetch JWT: ${r.status}`);return i.token}catch(r){throw console.error("JWT fetch error:",r),r}}validateConfig(){if(!this.config.token)throw new Error("Token is required");if(!this.config.id)throw new Error("ID is required");if(typeof this.config.token!="string")throw new Error("Token must be a string");if(typeof this.config.id!="string")throw new Error("ID must be a string");["bottom-right","bottom-left","top-right","top-left","center"].includes(this.config.position)||(console.warn(`Buzzwald: Invalid position "${this.config.position}". Using default "bottom-right"`),this.config.position="bottom-right"),["small","medium","large","custom"].includes(this.config.size)||(console.warn(`Buzzwald: Invalid size "${this.config.size}". Using default "medium"`),this.config.size="medium"),this.config.size==="custom"&&(!this.config.customSize||typeof this.config.customSize!="number"||this.config.customSize<40||this.config.customSize>120)&&(console.warn(`Buzzwald: Invalid custom size "${this.config.customSize}". Using default "medium"`),this.config.size="medium",this.config.customSize=null),this.config.backgroundColor&&!this.isValidColor(this.config.backgroundColor)&&(console.warn(`Buzzwald: Invalid background color "${this.config.backgroundColor}". Using default`),this.config.backgroundColor="#FFFF00"),this.config.iconColor&&!this.isValidColor(this.config.iconColor)&&(console.warn(`Buzzwald: Invalid icon color "${this.config.iconColor}". Using default`),this.config.iconColor="#000000")}isValidColor(e){const r=document.createElement("div");return r.style.color=e,r.style.color!==""}getButtonDimensions(){let e,r,i;switch(this.config.size){case"small":e=50,r=20,i=20;break;case"large":e=80,r=32,i=32;break;case"custom":e=this.config.customSize,r=Math.round(this.config.customSize*.4),i=Math.round(this.config.customSize*.4);break;case"medium":default:e=60,r=24,i=24;break}return{buttonSize:e,fontSize:r,iconSize:i}}checkBrowserSupport(){if(!window.fetch)throw new Error("Browser does not support fetch API");if(!window.Promise)throw new Error("Browser does not support Promises");if(!window.addEventListener)throw new Error("Browser does not support addEventListener")}handleInitializationError(e){e.isUsageLimit||e.message&&e.message.includes("Usage limit exceeded")?this.createUsageLimitWidget(e):this.createGenericErrorWidget(e)}createUsageLimitWidget(e){try{this.injectStyles(),this.widgetElement=document.createElement("div"),this.widgetElement.className=`buzzwald-widget ${this.config.position}`,this.buttonElement=document.createElement("button"),this.buttonElement.className="buzzwald-button buzzwald-button-disabled",this.buttonElement.setAttribute("aria-label","Voice calls unavailable - limit reached"),this.buttonElement.innerHTML=this.getPhoneIcon(),this.buttonElement.disabled=!0,this.buttonElement.addEventListener("click",r=>{r.preventDefault(),this.showUsageLimitMessage(e)}),this.widgetElement.appendChild(this.buttonElement),document.body.appendChild(this.widgetElement),setTimeout(()=>this.showUsageLimitMessage(e),500),this.startUsageLimitRetry()}catch(r){console.error("Error creating usage limit widget:",r),this.createGenericErrorWidget(e)}}startUsageLimitRetry(){this.usageLimitRetryTimer&&clearInterval(this.usageLimitRetryTimer),this.usageLimitRetryTimer=setInterval(async()=>{this.usageLimitRetryAttempts++;try{const e=await this.fetchJwt(this.config.id);clearInterval(this.usageLimitRetryTimer),this.usageLimitRetryTimer=null,this.config.token=e,this.restoreWidget()}catch(e){e.isUsageLimit?this.usageLimitRetryAttempts>=this.maxUsageLimitRetries&&(clearInterval(this.usageLimitRetryTimer),this.usageLimitRetryTimer=null):(console.error("Auto-recovery failed with different error:",e),clearInterval(this.usageLimitRetryTimer),this.usageLimitRetryTimer=null)}},3e4)}restoreWidget(){try{this.widgetElement&&(this.widgetElement.remove(),this.widgetElement=null),this.validateConfig(),this.checkBrowserSupport(),this.injectStyles(),this.createWidget(),this.initializeVapi(),this.isInitialized=!0,this.showRestoreSuccessMessage()}catch(e){console.error("Failed to restore widget:",e),this.createGenericErrorWidget(e)}}showRestoreSuccessMessage(){const e=document.createElement("div");e.className="buzzwald-restore-success-message";let r="";switch(this.config.position){case"bottom-right":r="bottom: 90px; right: 20px;";break;case"bottom-left":r="bottom: 90px; left: 20px;";break;case"top-right":r="top: 90px; right: 20px;";break;case"top-left":r="top: 90px; left: 20px;";break;case"center":r="top: calc(50% + 60px); left: 50%; transform: translateX(-50%);";break;default:r="bottom: 90px; right: 20px;"}e.style.cssText=`
      position: fixed;
      ${r}
      background: #28a745;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      z-index: 2147483647;
      max-width: 250px;
      word-wrap: break-word;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    `,e.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 4px;"> Voice Calls Restored!</div>
      <div>You can now use voice calls again.</div>
    `,document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},4e3)}createGenericErrorWidget(e){const r=document.createElement("div");r.className="buzzwald-widget-error",r.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: #ff4444;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      z-index: 2147483647;
      cursor: pointer;
      title: "Widget failed to initialize: ${e.message}";
    `,r.innerHTML="!",r.title=`Widget failed to initialize: ${e.message}`,r.addEventListener("click",()=>{alert(`Buzzwald Widget Error:
${e.message}

Please check the console for more details.`)}),document.body.appendChild(r),this.errorWidget=r}showUsageLimitMessage(e){const r=document.createElement("div");r.className="buzzwald-usage-limit-message";let i="";switch(this.config.position){case"bottom-right":i="bottom: 90px; right: 20px;";break;case"bottom-left":i="bottom: 90px; left: 20px;";break;case"top-right":i="top: 90px; right: 20px;";break;case"top-left":i="top: 90px; left: 20px;";break;case"center":i="top: calc(50% + 60px); left: 50%; transform: translateX(-50%);";break;default:i="bottom: 90px; right: 20px;"}r.style.cssText=`
      position: fixed;
      ${i}
      background: #ff6b35;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-size: 14px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      z-index: 2147483647;
      max-width: 250px;
      word-wrap: break-word;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      cursor: pointer;
    `;const n=e?.message||"Please upgrade your plan to continue using voice calls.";r.innerHTML=`
      <div style="font-weight: bold; margin-bottom: 4px;">Voice Call Limit Reached</div>
      <div>${n}</div>
      <div style="font-size: 12px; margin-top: 8px; opacity: 0.9;">Click to dismiss</div>
    `,r.addEventListener("click",()=>{r.parentNode&&r.parentNode.removeChild(r)}),document.body.appendChild(r),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r)},8e3)}injectStyles(){const e="buzzwald-widget-styles";if(document.getElementById(e))return;const{buttonSize:r,fontSize:i,iconSize:n}=this.getButtonDimensions(),s=document.createElement("style");s.id=e,s.textContent=`
      /* Buzzwald Widget Styles */
      .buzzwald-widget {
        position: fixed;
        z-index: 2147483647;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        box-sizing: border-box;
      }

      .buzzwald-widget *,
      .buzzwald-widget *::before,
      .buzzwald-widget *::after {
        box-sizing: inherit;
      }

      .buzzwald-button {
        width: ${r}px;
        height: ${r}px;
        border-radius: 50%;
        border: none;
        background-color: ${this.config.backgroundColor};
        color: ${this.config.iconColor};
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        outline: none;
        font-size: ${i}px;
        line-height: 1;
      }

      .buzzwald-button:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
      }

      .buzzwald-button:active {
        transform: scale(0.95);
      }

      .buzzwald-button:focus {
        outline: 2px solid #0066CC;
        outline-offset: 2px;
      }

      .buzzwald-widget.bottom-right {
        bottom: 20px;
        right: 20px;
      }

      .buzzwald-widget.bottom-left {
        bottom: 20px;
        left: 20px;
      }

      .buzzwald-widget.top-right {
        top: 20px;
        right: 20px;
      }

      .buzzwald-widget.top-left {
        top: 20px;
        left: 20px;
      }

      .buzzwald-widget.center {
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      .buzzwald-button.connecting {
        animation: buzzwald-pulse 1.5s infinite;
      }

      .buzzwald-button.connected {
        background-color: #00AA00;
        color: #FFFFFF;
      }

      .buzzwald-button.ended {
        background-color: #FF0000;
        color: #FFFFFF;
      }

      .buzzwald-button-disabled {
        background-color: #cccccc !important;
        color: #666666 !important;
        cursor: not-allowed !important;
        opacity: 0.8 !important;
        display: flex !important;
        visibility: visible !important;
      }

      .buzzwald-button-disabled:hover {
        transform: none !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
        background-color: #cccccc !important;
      }

      .buzzwald-button-disabled:active {
        transform: none !important;
      }

      @keyframes buzzwald-pulse {
        0% {
          transform: scale(1);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
      }

      .buzzwald-phone-icon {
        width: ${n}px;
        height: ${n}px;
        fill: currentColor;
      }

      @media (max-width: 768px) {
        .buzzwald-widget.bottom-right,
        .buzzwald-widget.bottom-left {
          bottom: 15px;
        }
        
        .buzzwald-widget.bottom-right {
          right: 15px;
        }
        
        .buzzwald-widget.bottom-left {
          left: 15px;
        }
        
        .buzzwald-widget.top-right {
          right: 15px;
        }
        
        .buzzwald-widget.top-left {
          left: 15px;
        }

        .buzzwald-widget.center {
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
      }

      /* Hide Vapi's default button */
      .vapi-support-btn,
      #vapi-support-btn,
      [id*="vapi"],
      [class*="vapi"] {
        display: none !important;
      }
    `,document.head.appendChild(s)}createWidget(){this.widgetElement=document.createElement("div"),this.widgetElement.className=`buzzwald-widget ${this.config.position}`,this.buttonElement=document.createElement("button"),this.buttonElement.className="buzzwald-button",this.buttonElement.setAttribute("aria-label","Start phone call"),this.buttonElement.innerHTML=this.getPhoneIcon(),this.buttonElement.addEventListener("click",()=>this.handleButtonClick()),this.widgetElement.appendChild(this.buttonElement),document.body.appendChild(this.widgetElement),this.hideVapiButtons()}hideVapiButtons(){const e=()=>{document.querySelectorAll('.vapi-support-btn, #vapi-support-btn, [id*="vapi"], [class*="vapi"]:not([class*="buzzwald"])').forEach(n=>{n&&!n.closest(".buzzwald-widget")&&(n.style.display="none")})};e();const r=new MutationObserver(()=>{e()});r.observe(document.body,{childList:!0,subtree:!0}),this.vapiButtonObserver=r}getPhoneIcon(){return`
      <svg class="buzzwald-phone-icon" viewBox="0 0 24 24" fill="currentColor">
        <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
      </svg>
    `}async handleButtonClick(){if(!this.vapi){console.error("Buzzwald: Vapi client not initialized"),this.showErrorMessage("Voice client not available");return}if(this.currentCallState==="connecting"||this.currentCallState==="connected"){this.vapi.stop();return}try{await this.vapi.start(),this.retryCount=0}catch(e){console.error("Buzzwald: Failed to start call",e),this.handleCallError(e)}}handleCallError(e){this.updateCallState("ended"),this.showErrorMessage(this.getUserFriendlyError(e)),this.isNetworkError(e)&&this.retryCount<this.maxRetries?(this.retryCount++,console.log(`Buzzwald: Retrying call (${this.retryCount}/${this.maxRetries})`),setTimeout(()=>{this.updateCallState("idle"),this.retryCount<this.maxRetries&&setTimeout(()=>this.handleButtonClick(),1e3)},2e3)):(this.retryCount=0,setTimeout(()=>this.updateCallState("idle"),3e3))}getUserFriendlyError(e){const r=e.message||e.toString();return e.isUsageLimit||r.includes("Usage limit exceeded")?r:r.includes("permission")||r.includes("denied")?"Please allow microphone access":r.includes("network")||r.includes("connection")?"Network error, retrying...":r.includes("api")||r.includes("key")?"Configuration error":"Call failed, please try again"}isNetworkError(e){const r=e.message||e.toString();return r.includes("network")||r.includes("connection")||r.includes("timeout")||r.includes("fetch")}showErrorMessage(e){const r=document.createElement("div");let i="";switch(this.config.position){case"bottom-right":i="bottom: 90px; right: 20px;";break;case"bottom-left":i="bottom: 90px; left: 20px;";break;case"top-right":i="top: 90px; right: 20px;";break;case"top-left":i="top: 90px; left: 20px;";break;case"center":i="top: calc(50% + 60px); left: 50%; transform: translateX(-50%);";break;default:i="bottom: 90px; right: 20px;"}r.style.cssText=`
      position: fixed;
      ${i}
      background: #ff4444;
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 2147483647;
      max-width: 200px;
      word-wrap: break-word;
    `,r.textContent=e,document.body.appendChild(r),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r)},3e3)}initializeVapi(){this.vapi=new kn({id:this.config.id,token:this.config.token,phoneNumber:this.config.phoneNumber}),this.attachVapiListeners()}attachVapiListeners(){this.vapi.on("call-start",()=>this.updateCallState("connecting")),this.vapi.on("speech-start",()=>this.updateCallState("connected")),this.vapi.on("call-end",()=>{this.updateCallState("ended"),setTimeout(()=>this.updateCallState("idle"),2e3)}),this.vapi.on("error",async e=>{if(console.error("Buzzwald: Vapi error",e),e&&e.type==="start-method-error"&&e.error&&typeof e.error.message=="string"&&e.error.message.includes("JWT has expired"))try{console.log("JWT expired, fetching new token"),this.config.token=await this.fetchJwt(this.config.id),this.vapi&&this.vapi.destroy(),this.vapi=new kn({id:this.config.id,token:this.config.token,phoneNumber:this.config.phoneNumber}),this.attachVapiListeners()}catch(r){r.isUsageLimit?this.showErrorMessage("Voice call limit reached. Please upgrade your plan."):this.showErrorMessage("Session expired. Please refresh.")}this.updateCallState("ended"),setTimeout(()=>this.updateCallState("idle"),2e3)}),typeof this.vapi.on=="function"&&this.vapi.on("authError",async e=>{if(e&&e.code==="jwt_expired")try{this.config.token=await this.fetchJwt(this.config.id),this.vapi&&this.vapi.destroy(),this.vapi=new kn({id:this.config.id,token:this.config.token,phoneNumber:this.config.phoneNumber}),this.attachVapiListeners()}catch(r){r.isUsageLimit?this.showErrorMessage("Voice call limit reached. Please upgrade your plan."):this.showErrorMessage("Session expired. Please refresh.")}})}updateCallState(e){switch(this.currentCallState=e,this.buttonElement.classList.remove("connecting","connected","ended"),e!=="idle"&&this.buttonElement.classList.add(e),e){case"connecting":this.buttonElement.setAttribute("aria-label","Connecting...");break;case"connected":this.buttonElement.setAttribute("aria-label","End call");break;case"ended":this.buttonElement.setAttribute("aria-label","Call ended");break;default:this.buttonElement.setAttribute("aria-label","Start phone call")}}destroy(){try{this.vapi&&(this.vapi.destroy(),this.vapi=null),this.widgetElement&&(this.widgetElement.remove(),this.widgetElement=null),this.errorWidget&&(this.errorWidget.remove(),this.errorWidget=null);const e=document.getElementById("buzzwald-widget-styles");e&&e.remove(),this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.usageLimitRetryTimer&&(clearInterval(this.usageLimitRetryTimer),this.usageLimitRetryTimer=null),this.vapiButtonObserver&&(this.vapiButtonObserver.disconnect(),this.vapiButtonObserver=null),this.isInitialized=!1}catch(e){console.error("Buzzwald: Error during widget destruction",e)}}}(function(){if(window.buzzwaldWidget){console.warn("Buzzwald widget is already initialized");return}function t(){try{const e=window.BuzzwaldConfig||{};if(!e.mockMode&&!e.id){console.error("Buzzwald: id is required in window.BuzzwaldConfig");return}window.buzzwaldWidget=new Jl(e),window.buzzwaldDestroy=function(){window.buzzwaldWidget&&(window.buzzwaldWidget.destroy(),window.buzzwaldWidget=null,window.buzzwaldDestroy=null)},console.log("Buzzwald widget initialized successfully")}catch(e){console.error("Failed to initialize Buzzwald widget:",e)}}if(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t(),!window.BuzzwaldConfig){let e=setInterval(()=>{window.BuzzwaldConfig&&!window.buzzwaldWidget&&(clearInterval(e),t())},100);setTimeout(()=>{clearInterval(e)},1e4)}})()})();
